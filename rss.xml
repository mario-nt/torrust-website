
<rss version="2.0"
	xmlns:content="http://purl.org/rss/1.0/modules/content/"
	xmlns:wfw="http://wellformedweb.org/CommentAPI/"
	xmlns:dc="http://purl.org/dc/elements/1.1/"
	xmlns:atom="http://www.w3.org/2005/Atom"
	xmlns:sy="http://purl.org/rss/1.0/modules/syndication/"
	xmlns:slash="http://purl.org/rss/1.0/modules/slash/"
	xmlns:georss="http://www.georss.org/georss"
	xmlns:geo="http://www.w3.org/2003/01/geo/wgs84_pos#"
>
  <channel>
    <atom:link href="https://v2.torrust.com/rss.xml" rel="self" type="application/rss+xml" />
    <title>Torrust</title>
    <link>https://v2.torrust.com</link>
    <description>Torrust is an open source project that aims to provide you with the tools you need to host your own torrent indexes with ease.</description>
    <image>
      <url>https://v2.torrust.com/favicons/favicon-32x32.png</url>
      <title>Torrust</title>
      <link>https://v2.torrust.com</link>
      <width>32</width>
      <height>32</height>
    </image>
    
        <item>
          <guid>https://v2.torrust.com/hash2torrent-retrieve-torrent-files-effortlessly</guid>
          <title>Hash2Torrent - Retrieve Torrent Files Effortlessly!</title>
          <description>Discover Hash2Torrent, a new tool to fetch torrent files (metainfo files) directly from their infohash! Simplify your torrent management and integrations with our easy-to-use service.</description>
          <link>https://v2.torrust.com/hash2torrent-retrieve-torrent-files-effortlessly</link>
          <pubDate>05/09/2024 10:00:00</pubDate>
          <category>Service</category><category>Demo</category><category>Metainfo</category><category>Metadata</category><category>Sample</category>
          <content:encoded><![CDATA[
            <div style="margin: 50px 0; font-style: italic;">
              If anything looks wrong, 
              <strong>
                <a href="https://v2.torrust.com/hash2torrent-retrieve-torrent-files-effortlessly">
                  read on the site!
                </a>
              </strong>
            </div>

             <div class="flex svelte-19d8qsr"> <div class=" svelte-13ebny9" style="position: relative;"><div class="svelte-13ebny9"><h2 id="table-of-contents" data-svelte-h="svelte-outevg"><a class="heading-link" title="Permalink" aria-hidden="true" href="#table-of-contents"><span>#</span></a>Table of contents</h2> <ul data-svelte-h="svelte-nkp85p"><li><a href="#why-this-tool">Why this tool</a></li> <li><a href="#implementation">Implementation</a></li> <li><a href="#alternative-methods">Alternative Methods</a></li> <li><a href="#benefits-of-using-hash2torrent">Benefits of Using Hash2Torrent</a></li> <li><a href="#conclusion">Conclusion</a></li> <li><a href="#links">Links</a></li> <li><a href="#acknowledgments">Acknowledgments</a></li></ul></div></div> <div class="svelte-4jsat1"><p data-svelte-h="svelte-ubtbd9">Hello, Torrust community!</p> <p data-svelte-h="svelte-uyap3o">We are thrilled to introduce our newest project: <a href="https://hash2torrent.com/" rel="nofollow">Hash2Torrent</a>, a web service that allows you to easily retrieve torrent files using only their infohash (version 1).</p> <p data-svelte-h="svelte-12jvpoc">Hash2Torrent is designed to make torrent management more accessible and user-friendly, without the need to install a BitTorrent client.</p> <div class="callout-block success svelte-sxx0n0"><div class="icon-wrapper svelte-sxx0n0"><svg width="100%" height="100%" stroke-width="1.5" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M7 12.5L10 15.5L17 8.5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path d="M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path></svg></div> <p data-svelte-h="svelte-7o6rhp"><a href="https://hash2torrent.com" rel="nofollow">https://hash2torrent.com</a></p></div> <h2 id="why-this-tool" data-svelte-h="svelte-zwumqj"><a class="heading-link" title="Permalink" aria-hidden="true" href="#why-this-tool"><span>#</span></a>Why this tool</h2> <p data-svelte-h="svelte-up3155">In our quest to find a straightforward tool that allows users to download torrent files directly from an infohash, we discovered that there wasn’t a simple, reliable service available. We set out to change that by creating Hash2Torrent — a service that fills this gap. With Hash2Torrent, you can now quickly download torrent files by simply entering the infohash on our website (<a href="https://hash2torrent.com/" rel="nofollow">hash2torrent.com</a>) or using a direct URL format:</p> <div class="callout-block info svelte-sxx0n0"><div class="icon-wrapper svelte-sxx0n0"><svg width="100%" height="100%" stroke-width="1.5" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 11.5V16.5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path d="M12 7.51L12.01 7.49889" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path d="M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path></svg></div> <pre class="language-text"><!-- HTML_TAG_START --><code class="language-text">https://hash2torrent.com/&#123;info-hash&#125;</code><!-- HTML_TAG_END --></pre></div> <p data-svelte-h="svelte-9lfeag">For example: <a href="https://hash2torrent.com/443c7602b4fde83d1154d6d9da48808418b181b6" rel="nofollow">https://hash2torrent.com/443c7602b4fde83d1154d6d9da48808418b181b6</a>.</p> <div class="callout-block warning svelte-sxx0n0"><div class="icon-wrapper svelte-sxx0n0"><svg width="100%" height="100%" stroke-width="1.5" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 7L12 13" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path d="M12 17.01L12.01 16.9989" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path d="M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path></svg></div> <p data-svelte-h="svelte-3s2m8o">The service does NOT download the contents described in the torrent file. It only ask other peers for the torrent file, also called metainfo file. Besides, the file (called metadata in BEP 9) includes only the info dictionary because is the only part covered by the info-hash. See <a href="https://www.bittorrent.org/beps/bep_0009.html" rel="nofollow">BEP 9</a> for more information.</p></div> <h2 id="implementation" data-svelte-h="svelte-2yffi3"><a class="heading-link" title="Permalink" aria-hidden="true" href="#implementation"><span>#</span></a>Implementation</h2> <p data-svelte-h="svelte-1id2b5t">The project is a thin API wrapper that uses the Rust BitTorrent client <a href="https://github.com/ikatson/rqbit" rel="nofollow">rqbit</a>. rqbit has an option to add a torrent to the client in <code>list-only</code> mode, meaning the torrent is not downloaded, but only listed in the client. When you add a new torrent from a magnet-link, the client automatically gets the torrent file from other peers if it’s available.</p> <p data-svelte-h="svelte-eu5zqp">The API generates a magnet-link for the info-hash and adds that magnet-link to the client in <code>list-only</code> mode. The clients returns the torrent file.</p> <div class="callout-block warning svelte-sxx0n0"><div class="icon-wrapper svelte-sxx0n0"><svg width="100%" height="100%" stroke-width="1.5" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 7L12 13" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path d="M12 17.01L12.01 16.9989" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path d="M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path></svg></div> <p data-svelte-h="svelte-kd9eef">For the time being, the service API only returns a direct (not user-friendly) timeout (408) if the client behind the service can’t find any peer having that torrent.</p></div> <h2 id="alternative-methods" data-svelte-h="svelte-1rprgya"><a class="heading-link" title="Permalink" aria-hidden="true" href="#alternative-methods"><span>#</span></a>Alternative Methods</h2> <p data-svelte-h="svelte-wmzqmi">Traditionally, if you wanted to retrieve a torrent file using its infohash, you would have to:</p> <ul data-svelte-h="svelte-fsofnl"><li>Open a BitTorrent client that supports DHT (Distributed Hash Table).</li> <li>Add the infohash as a magnet link.</li> <li>Wait for the client to find peers that have the torrent file.</li></ul> <p data-svelte-h="svelte-y1sn1a">While this method works, it can be cumbersome and is not ideal if you’re looking for a lightweight solution or need to automate the process for integration into other services.</p> <div class="callout-block info svelte-sxx0n0"><div class="icon-wrapper svelte-sxx0n0"><svg width="100%" height="100%" stroke-width="1.5" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 11.5V16.5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path d="M12 7.51L12.01 7.49889" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path d="M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path></svg></div> <p data-svelte-h="svelte-1uwzmsq"><strong>NOTICE:</strong> You need the DHT to find other peers having the torrent. In the future we could also also user to introduce a magnet-link that may contain a list of trackers. In that case, the client could use those tracker to find peers.</p></div> <h2 id="benefits-of-using-hash2torrent" data-svelte-h="svelte-1gjvvqk"><a class="heading-link" title="Permalink" aria-hidden="true" href="#benefits-of-using-hash2torrent"><span>#</span></a>Benefits of Using Hash2Torrent</h2> <p data-svelte-h="svelte-1077nrr">Hash2Torrent is all about simplicity and ease of integration:</p> <ul data-svelte-h="svelte-np9emh"><li><strong>User-Friendly Interface:</strong> Just like a Google search, simply type the infohash into our form, click download, and if peers are available, the torrent file will be downloaded within seconds.</li> <li><strong>Direct URL Access:</strong> Use our direct URL format to fetch torrent files programmatically, making it ideal for integration with other tools and services.</li> <li><strong>Efficiency:</strong> No need to deal with BitTorrent clients or complex setups. Hash2Torrent is the simplest way to get a torrent file from an infohash. We have also added a torrents cache so it will be even faster if the torrent is already cached.</li> <li><strong>Contribution to the Ecosystem:</strong> By providing this service, we aim to empower the community with more tools that enhance the overall BitTorrent experience.</li></ul> <div class="callout-block info svelte-sxx0n0"><div class="icon-wrapper svelte-sxx0n0"><svg width="100%" height="100%" stroke-width="1.5" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 11.5V16.5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path d="M12 7.51L12.01 7.49889" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path d="M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path></svg></div> <p data-svelte-h="svelte-12tu4dn">Try it out! Visit Hash2Torrent (<a href="https://hash2torrent.com/" rel="nofollow">hash2torrent.com</a>) and give it a try with your favorite torrents’ infohashes. We are eager to hear your feedback and suggestions.</p></div> <h2 id="conclusion" data-svelte-h="svelte-br5ox0"><a class="heading-link" title="Permalink" aria-hidden="true" href="#conclusion"><span>#</span></a>Conclusion</h2> <p data-svelte-h="svelte-riz87j">We built Hash2Torrent to make torrent retrieval from infohashes as easy as possible. Whether you’re a casual user who needs the occasional torrent file or a developer looking to integrate torrent retrieval into your application, Hash2Torrent is here to help.</p> <p data-svelte-h="svelte-rnssrq">This project is just one of the many ways we plan to contribute to the BitTorrent ecosystem by providing practical, user-friendly tools. We believe in building a more accessible torrenting experience for everyone, and Hash2Torrent is a significant step in that direction. We are excited to continue innovating and supporting the community with more tools like this!</p> <p data-svelte-h="svelte-3l3aev">Happy torrenting!</p> <h2 id="links" data-svelte-h="svelte-32dd6s"><a class="heading-link" title="Permalink" aria-hidden="true" href="#links"><span>#</span></a>Links</h2> <ul data-svelte-h="svelte-c92ij0"><li><a href="https://hash2torrent.com/" rel="nofollow">The live demo</a>.</li> <li><a href="https://github.com/torrust/torrust-hash2torrent" rel="nofollow">Github repo</a>.</li></ul> <h2 id="acknowledgments" data-svelte-h="svelte-1e4fcph"><a class="heading-link" title="Permalink" aria-hidden="true" href="#acknowledgments"><span>#</span></a>Acknowledgments</h2> <p data-svelte-h="svelte-gziuqu">A massive thank you to all contributors who made this project possible, especially those involved in developing the Rust-based BitTorrent client that powers Hash2Torrent, specially to <a href="https://github.com/ikatson" rel="nofollow">Igor Katson</a> whose work underpins Hash2Torrent. Their dedication and contributions have been instrumental in bringing this service to life.</p> <p data-svelte-h="svelte-mcy6nd">If you have any questions or issues regarding this post, please <a href="https://github.com/torrust/torrust-website/issues/new" rel="nofollow">open an issue</a>.</p> <p data-svelte-h="svelte-19k8tej">For any other questions or issues related to Torrust repositories, please open an issue on the corresponding repository:</p> <ul data-svelte-h="svelte-1elgqc0"><li>Torrust Hash2Torrent: <a href="https://github.com/torrust/torrust-hash2torrent/issues" rel="nofollow">https://github.com/torrust/torrust-hash2torrent/issues</a></li> <li>Torrust Tracker: <a href="https://github.com/torrust/torrust-tracker/issues" rel="nofollow">https://github.com/torrust/torrust-tracker/issues</a></li> <li>Torrust Index Backend: <a href="https://github.com/torrust/torrust-index/issues" rel="nofollow">https://github.com/torrust/torrust-index/issues</a></li> <li>Torrust Index Frontend: <a href="https://github.com/torrust/torrust-index-gui/issues" rel="nofollow">https://github.com/torrust/torrust-index-gui/issues</a></li></ul> <p data-svelte-h="svelte-v20sdj">We very welcome any contributions to the project!</p></div></div>
          ]]></content:encoded>
          <media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://v2.torrust.com//images/posts/hash2torrent-retrieve-torrent-files-effortlessly/hash2torrent-screenshot.png"/>
          <media:content xmlns:media="http://search.yahoo.com/mrss/" medium="image" url="https://v2.torrust.com//images/posts/hash2torrent-retrieve-torrent-files-effortlessly/hash2torrent-screenshot.png"/>          
        </item>
      
        <item>
          <guid>https://v2.torrust.com/released-v3-0-0-beta</guid>
          <title>Released version v3.0.0-beta</title>
          <description>We're excited to announce the release of v3.0.0-beta, marking a significant step towards our upcoming major release, v3.0.0. This release solidifies the features and prepares us for the beta phase.</description>
          <link>https://v2.torrust.com/released-v3-0-0-beta</link>
          <pubDate>03/09/2024 14:30:38</pubDate>
          <category>Announcement</category><category>Release</category>
          <content:encoded><![CDATA[
            <div style="margin: 50px 0; font-style: italic;">
              If anything looks wrong, 
              <strong>
                <a href="https://v2.torrust.com/released-v3-0-0-beta">
                  read on the site!
                </a>
              </strong>
            </div>

             <div class="flex svelte-19d8qsr"> <div class=" svelte-13ebny9" style="position: relative;"><div class="svelte-13ebny9"><h2 id="table-of-contents" data-svelte-h="svelte-outevg"><a class="heading-link" title="Permalink" aria-hidden="true" href="#table-of-contents"><span>#</span></a>Table of contents</h2> <ul data-svelte-h="svelte-1vwra7g"><li><a href="#greetings-torrust-fans">Greetings, Torrust Fans!</a></li> <li><a href="#release-schedule">Release Schedule</a></li> <li><a href="#how-to-participate">How to Participate</a></li> <li><a href="#your-input-helps-us-improve">Your Input Helps Us Improve</a></li> <li><a href="#important-notice-demo-availability">Important Notice: Demo Availability</a></li> <li><a href="#special-thanks">Special Thanks</a></li></ul></div></div> <div class="svelte-4jsat1"><h2 id="greetings-torrust-fans" data-svelte-h="svelte-81guo2"><a class="heading-link" title="Permalink" aria-hidden="true" href="#greetings-torrust-fans"><span>#</span></a><strong>Greetings, Torrust Fans!</strong></h2> <p data-svelte-h="svelte-19yyzhb">As we move forward according to our release plan, we’re excited to be nearing the final release of version 3.0.0.</p> <p data-svelte-h="svelte-zqgc4z">On August 13th, we made <code>v3.0.0-alpha.12</code> available, and now we’re pleased to present v3.0.0-beta. This release is a critical step as we refine the software in preparation for the official launch.</p> <h2 id="release-schedule" data-svelte-h="svelte-fbktfz"><a class="heading-link" title="Permalink" aria-hidden="true" href="#release-schedule"><span>#</span></a>Release Schedule</h2> <p data-svelte-h="svelte-2jnc2v">The journey to our major release continues, and here’s our roadmap:</p> <table data-svelte-h="svelte-g6bxxo"><thead><tr><th>Milestone</th> <th>Target Date</th> <th>Version</th></tr></thead> <tbody><tr><td>Feature Freeze</td> <td>13/08/2024</td> <td>3.0.0-alpha.12</td></tr> <tr><td>Code Freeze</td> <td>13/08/2024</td> <td>3.0.0-alpha.12</td></tr> <tr><td>Beta Release</td> <td>03/09/2024</td> <td>3.0.0-beta</td></tr> <tr><td>Release Candidate</td> <td>15/09/2024</td> <td>3.0.0-rc.1</td></tr> <tr><td>Final Release</td> <td>30/09/2024</td> <td>3.0.0</td></tr></tbody></table> <h2 id="how-to-participate" data-svelte-h="svelte-ja03fc"><a class="heading-link" title="Permalink" aria-hidden="true" href="#how-to-participate"><span>#</span></a>How to Participate</h2> <p data-svelte-h="svelte-rto9x1">Your feedback is invaluable to us. As we move towards the beta phase, we invite you to download this beta release, test it extensively, and report any issues or suggestions you may have. Here’s how you can contribute:</p> <ul data-svelte-h="svelte-1knhi4o"><li>Testing: Download the alpha release and run it in your environment.</li> <li>Reporting Bugs: If you encounter any issues, please report them through our issue tracker.</li></ul> <h2 id="your-input-helps-us-improve" data-svelte-h="svelte-rynfgo"><a class="heading-link" title="Permalink" aria-hidden="true" href="#your-input-helps-us-improve"><span>#</span></a>Your Input Helps Us Improve</h2> <p data-svelte-h="svelte-1081bcg">Your feedback is crucial in helping us refine this release. We want the community’s active involvement as we move forward.</p> <p data-svelte-h="svelte-bcbvzs">After the final version 3.0.0 is released, we plan to open discussions about our future roadmap. We encourage you to propose features and improvements to help us continue building superior tools and enhance the BitTorrent ecosystem.</p> <p data-svelte-h="svelte-3lnjb8">Have ideas or suggestions? Join the <a href="https://github.com/torrust/torrust-index-gui/discussions" rel="nofollow">discussion</a> on our GitHub repository. Your contributions are key to our collaborative development approach. Let’s work together to make Torrust even better!</p> <h2 id="important-notice-demo-availability" data-svelte-h="svelte-1b7v9jv"><a class="heading-link" title="Permalink" aria-hidden="true" href="#important-notice-demo-availability"><span>#</span></a>Important Notice: Demo Availability</h2> <div class="callout-block warning svelte-sxx0n0"><div class="icon-wrapper svelte-sxx0n0"><svg width="100%" height="100%" stroke-width="1.5" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 7L12 13" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path d="M12 17.01L12.01 16.9989" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path d="M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path></svg></div> <p data-svelte-h="svelte-f4ma2">Please note that the <a href="https://index.torrust-demo.com/" rel="nofollow">demo</a> environment may experience downtime or resets as part of our ongoing testing. As this is a beta version, data may be lost during these phases. We appreciate your patience and understanding as we fine-tune the system.</p></div> <h2 id="special-thanks" data-svelte-h="svelte-1klzy15"><a class="heading-link" title="Permalink" aria-hidden="true" href="#special-thanks"><span>#</span></a>Special Thanks</h2> <p data-svelte-h="svelte-1agj1iq">We want to extend our deepest thanks to all the contributors who have tirelessly tested and provided feedback on this release. Your insights have been crucial in getting us this far, and we look forward to continuing this journey together.</p></div></div>
          ]]></content:encoded>
          <media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://v2.torrust.com//images/posts/released-v3-0-0-beta/team.png"/>
          <media:content xmlns:media="http://search.yahoo.com/mrss/" medium="image" url="https://v2.torrust.com//images/posts/released-v3-0-0-beta/team.png"/>          
        </item>
      
        <item>
          <guid>https://v2.torrust.com/review-and-setup-guide-for-unit3d</guid>
          <title>Review and Setup Guide for UNIT3D</title>
          <description>UNIT3D is one of the fully featured BitTorrent Indexes that promises a robust, customizable, and community-driven experience. In this first post of our review series at Torrust, we’ll dive into UNIT3D, evaluating its features, installation process, and overall usability. Whether you're an open-source advocate or a BitTorrent expert, this guide will help you understand the ins and outs of UNIT3D, including a step-by-step tutorial to set it up on a Digital Ocean droplet.</description>
          <link>https://v2.torrust.com/review-and-setup-guide-for-unit3d</link>
          <pubDate>16/08/2024 09:36:17</pubDate>
          <category>Tutorial</category><category>Review</category><category>Index</category><category>Third-party</category>
          <content:encoded><![CDATA[
            <div style="margin: 50px 0; font-style: italic;">
              If anything looks wrong, 
              <strong>
                <a href="https://v2.torrust.com/review-and-setup-guide-for-unit3d">
                  read on the site!
                </a>
              </strong>
            </div>

             <div class="flex svelte-19d8qsr"> <div class=" svelte-13ebny9" style="position: relative;"><div class="svelte-13ebny9"><h2 id="table-of-contents" data-svelte-h="svelte-outevg"><a class="heading-link" title="Permalink" aria-hidden="true" href="#table-of-contents"><span>#</span></a>Table of contents</h2> <ul data-svelte-h="svelte-19g00rb"><li><a href="#introduction-to-unit3d">Introduction to UNIT3D</a><ul><li><a href="#overview">Overview</a></li> <li><a href="#key-features">Key features</a></li></ul></li> <li><a href="#unit3d-review">UNIT3D Review</a></li> <li><a href="#tutorial-setting-up-unit3d-on-a-digital-ocean-droplet">Tutorial: Setting Up UNIT3D on a Digital Ocean Droplet</a><ul><li><a href="#requirements">Requirements</a></li> <li><a href="#step-1-create-the-droplet-in-digital-ocean">Step 1. Create the Droplet in Digital Ocean</a></li> <li><a href="#step-2-update-the-server">Step 2. Update the Server</a></li> <li><a href="#step-3-run-the-unit3d-installer">Step 3. Run the UNIT3D Installer</a></li> <li><a href="#step-4-login-page">Step 4. Login Page</a></li> <li><a href="#troubleshooting">Troubleshooting</a></li></ul></li> <li><a href="#user-interface">User Interface</a></li> <li><a href="#conclusion">Conclusion</a></li></ul></div></div> <div class="svelte-4jsat1"><h2 id="introduction-to-unit3d" data-svelte-h="svelte-1megvfz"><a class="heading-link" title="Permalink" aria-hidden="true" href="#introduction-to-unit3d"><span>#</span></a>Introduction to UNIT3D</h2> <p data-svelte-h="svelte-1r1se51">This blog post serves as an introduction to our review series at Torrust, where we’ll continue to explore and evaluate other projects within the BitTorrent ecosystem.</p> <p data-svelte-h="svelte-o6j4j8">UNIT3D is a private torrent tracker software, crafted meticulously in <a href="https://www.php.net/" rel="nofollow">PHP</a> using the <a href="https://laravel.com/" rel="nofollow">Laravel</a> framework. Whether you’re a developer looking to deploy a robust BitTorrent index or an enthusiast exploring the depths of the BitTorrent ecosystem, this guide will walk you through UNIT3D’s features and provide a detailed, step-by-step setup tutorial.</p> <p data-svelte-h="svelte-167hh4r">UNIT3D was created from scratch. The first commit was on December 2017.</p> <ul data-svelte-h="svelte-1b7xkeb"><li><strong>Repo:</strong> <a href="https://github.com/HDInnovations/UNIT3D-Community-Edition" rel="nofollow">https://github.com/HDInnovations/UNIT3D-Community-Edition</a></li> <li><strong>Contributors:</strong> <a href="https://github.com/HDInnovations/UNIT3D-Community-Edition/graphs/contributors" rel="nofollow">116</a></li> <li><strong>Starts:</strong> 1.9k.</li> <li><strong>Production Stats</strong>:<ul><li>Installations: 26</li> <li>Users: 235,041</li> <li>Torrents: 1,570,340</li> <li>Peers: 5,881,717</li></ul></li> <li><strong>Official Demo Site:</strong> <a href="https://unit3d.dev/" rel="nofollow">https://unit3d.dev/</a> (currently not working).</li></ul> <p data-svelte-h="svelte-x4yzfh">Stats from <a href="https://hdvinnie.github.io/Private-Trackers-Spreadsheet/" rel="nofollow">Private-Trackers-Spreadsheet</a>.</p> <div class="callout-block info svelte-sxx0n0"><div class="icon-wrapper svelte-sxx0n0"><svg width="100%" height="100%" stroke-width="1.5" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 11.5V16.5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path d="M12 7.51L12.01 7.49889" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path d="M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path></svg></div> <p data-svelte-h="svelte-gbf7ow">To write this post we have setup a new demo site on: <a href="https://www.unit3d-demo.com/" rel="nofollow">https://www.unit3d-demo.com/</a>. Following the tutorial section you can also easily deploy your UNIT3D Index. The demo site could be shutdown at any time.</p></div> <h3 id="overview" data-svelte-h="svelte-cnawga"><a class="heading-link" title="Permalink" aria-hidden="true" href="#overview"><span>#</span></a>Overview</h3> <p data-svelte-h="svelte-ozk3hp">It’s not our intention to list and evaluate all the features because that would be a really hard task. However we want to give you an idea about how many features this software includes:</p> <h3 id="key-features" data-svelte-h="svelte-1lkc5br"><a class="heading-link" title="Permalink" aria-hidden="true" href="#key-features"><span>#</span></a>Key features</h3> <h4 id="torrents" data-svelte-h="svelte-2sh6eo"><a class="heading-link" title="Permalink" aria-hidden="true" href="#torrents"><span>#</span></a>Torrents</h4> <ul data-svelte-h="svelte-1rjippc"><li>Index, Search, Upload</li> <li>Requests</li> <li>RSS</li></ul> <h4 id="community" data-svelte-h="svelte-1l6xbcw"><a class="heading-link" title="Permalink" aria-hidden="true" href="#community"><span>#</span></a>Community</h4> <ul data-svelte-h="svelte-bpoh5e"><li>Forums</li> <li>Chatrooms with chatbot</li> <li>Playlists</li> <li>Polls</li> <li>News</li> <li>Bonus Points</li> <li>User profiles</li> <li>Achievements</li></ul> <h4 id="support" data-svelte-h="svelte-1o7u1oa"><a class="heading-link" title="Permalink" aria-hidden="true" href="#support"><span>#</span></a>Support</h4> <ul data-svelte-h="svelte-s60zfu"><li>Custom pages: rules, FAQ, Wikis</li> <li>Helpdesk</li> <li>Staff</li></ul> <h4 id="platform-management" data-svelte-h="svelte-1yqepmv"><a class="heading-link" title="Permalink" aria-hidden="true" href="#platform-management"><span>#</span></a>Platform Management</h4> <ul data-svelte-h="svelte-12x0nbi"><li>Logs</li> <li>Access Restrictions<ul><li>Client Blacklist</li> <li>Whitelisted Image URLs</li> <li>Blocked IPs</li></ul></li> <li>Torrents<ul><li>Moderation</li> <li>Classification: categories, resolutions, regions, distributions</li></ul></li> <li>Peers</li> <li>Users<ul><li>Search</li> <li>Applications, Invitations</li> <li>Keys: API, passkeys, RSS keys, 2FA, …</li> <li>Groups (roles)</li> <li>Notifications (alerts)</li> <li>Messages</li></ul></li></ul> <h4 id="integrations" data-svelte-h="svelte-c4dffs"><a class="heading-link" title="Permalink" aria-hidden="true" href="#integrations"><span>#</span></a>Integrations</h4> <ul data-svelte-h="svelte-1fymr3y"><li>Torrent API: <a href="https://github.com/HDInnovations/UNIT3D-Community-Edition/wiki/Torrent-API-(UNIT3D-v8.x.x)" rel="nofollow">https://github.com/HDInnovations/UNIT3D-Community-Edition/wiki/Torrent-API-(UNIT3D-v8.x.x)</a></li> <li>Other metadata API like <a href="https://www.themoviedb.org/" rel="nofollow">https://www.themoviedb.org/</a></li></ul> <h2 id="unit3d-review" data-svelte-h="svelte-gnutj4"><a class="heading-link" title="Permalink" aria-hidden="true" href="#unit3d-review"><span>#</span></a>UNIT3D Review</h2> <h3 id="code-quality-and-structure" data-svelte-h="svelte-u6d479"><a class="heading-link" title="Permalink" aria-hidden="true" href="#code-quality-and-structure"><span>#</span></a>Code Quality and Structure</h3> <p data-svelte-h="svelte-f7l6zy">UNIT3D boasts a well-organized codebase, adhering to modern PHP development standards. The use of Laravel as the underlying framework ensures a modular structure, making it easier for developers to extend and customize the platform. Code readability is generally high, with well-commented sections that clarify complex logic.</p> <h3 id="documentation-and-user-guides" data-svelte-h="svelte-l6xr16"><a class="heading-link" title="Permalink" aria-hidden="true" href="#documentation-and-user-guides"><span>#</span></a>Documentation and User Guides</h3> <p data-svelte-h="svelte-mrzit0">The <a href="https://github.com/HDInnovations/UNIT3D-Community-Edition/wiki" rel="nofollow">documentation</a> for UNIT3D system dependencies is comprehensive, covering local development and basic server management. However, there is room for improvement in terms of end user guides, tutorials, examples, installation for production and troubleshooting guides.</p> <h3 id="community-support-and-activity" data-svelte-h="svelte-17pa4sd"><a class="heading-link" title="Permalink" aria-hidden="true" href="#community-support-and-activity"><span>#</span></a>Community Support and Activity</h3> <p data-svelte-h="svelte-2q3ir0">UNIT3D has an active and growing community. The project’s GitHub repository shows regular commits, indicating ongoing development. There are also Discord channels for sponsors where they and developers discuss issues, share tips, and contribute to the project’s roadmap. You can also support UNIT3D development via <a href="https://polar.sh/HDInnovations" rel="nofollow">https://polar.sh/HDInnovations</a>.</p> <h3 id="contribution-guidelines-and-license" data-svelte-h="svelte-50kvt6"><a class="heading-link" title="Permalink" aria-hidden="true" href="#contribution-guidelines-and-license"><span>#</span></a>Contribution Guidelines and License</h3> <p data-svelte-h="svelte-1hqvwwq">UNIT3D is licensed under the AGPL-3.0 license license. The <a href="https://github.com/HDInnovations/UNIT3D-Community-Edition/blob/master/CONTRIBUTING.md" rel="nofollow">contribution guidelines</a> are well-documented, with clear instructions on how to fork the repository, submit pull requests, and report issues.</p> <h3 id="installation-process-overview" data-svelte-h="svelte-zt6ocl"><a class="heading-link" title="Permalink" aria-hidden="true" href="#installation-process-overview"><span>#</span></a>Installation Process Overview</h3> <p data-svelte-h="svelte-1rpop1i">UNIT3D offers an <a href="https://github.com/HDInnovations/UNIT3D-Installer" rel="nofollow">installer</a>. At the time of this writing it supports:</p> <ul data-svelte-h="svelte-1t5v1st"><li>Ubuntu 22.04 LTS (Jammy Jellyfish).</li> <li>Ubuntu 20.04 LTS (Focal Fossa)</li></ul> <p data-svelte-h="svelte-hdegu3">We followed the instructions and the process was easy and fast. We will describe the process in detail in the installation tutorial. Hopefully, that will make the process even easier for other users.</p> <h2 id="tutorial-setting-up-unit3d-on-a-digital-ocean-droplet" data-svelte-h="svelte-1lm4unn"><a class="heading-link" title="Permalink" aria-hidden="true" href="#tutorial-setting-up-unit3d-on-a-digital-ocean-droplet"><span>#</span></a>Tutorial: Setting Up UNIT3D on a Digital Ocean Droplet</h2> <p data-svelte-h="svelte-10o3ga8">To install the software we have followed the steps described in the official installer:</p> <p data-svelte-h="svelte-1jofot3"><a href="https://github.com/HDInnovations/UNIT3D-Installer" rel="nofollow">https://github.com/HDInnovations/UNIT3D-Installer</a>.</p> <h3 id="requirements" data-svelte-h="svelte-1igrg2h"><a class="heading-link" title="Permalink" aria-hidden="true" href="#requirements"><span>#</span></a>Requirements</h3> <p data-svelte-h="svelte-2b7r4d">Although you can just execute the installer directly you will need to create some services during the installation. We would recommend to fulfill all the requirements before executing the installer, that would make the process faster and you can avoid some mistakes we made.</p> <p data-svelte-h="svelte-1ig73ca">Let’s review what you will need:</p> <ul data-svelte-h="svelte-1ogoxxg"><li>Server (virtual machine)</li> <li>External Services</li> <li>System requirements (software installed on the server)</li></ul> <h4 id="hardware-requirements-server" data-svelte-h="svelte-pgiu57"><a class="heading-link" title="Permalink" aria-hidden="true" href="#hardware-requirements-server"><span>#</span></a>Hardware Requirements (server)</h4> <p data-svelte-h="svelte-am23js">We opted for using a Digital Ocean droplet just because we are used to their interface and it’s straightforward. Feel free to use your favorite provider.</p> <p data-svelte-h="svelte-14q3zex">In our first attempt we used the minimum size image. However it was too small. The server had problems building the frontend and that’s one of the last steps in the installation. Finally we used a VM (Digital Ocean call them droplets) with these characteristics:</p> <ul data-svelte-h="svelte-1r9cm0c"><li>Image: <strong>Ubuntu 22.04 (LTS) x64</strong></li> <li>Size: <strong>1 vCPU; 2GB / 50GB Disk; ($12/month)</strong></li></ul> <h4 id="external-services" data-svelte-h="svelte-1fspz0e"><a class="heading-link" title="Permalink" aria-hidden="true" href="#external-services"><span>#</span></a>External Services</h4> <ul data-svelte-h="svelte-qgx1j3"><li>Domain: We registered a new one only for this purpose: <a href="https://unit3d-demo.com/" rel="nofollow">https://unit3d-demo.com/</a>.</li> <li>DNS: Since We are using Digital Ocean, we only needed to assign the the Digital Ocean’s name servers to the domain.</li> <li>Email delivery service: We just picked up one from the list of supported services by UNIT3D. We selected <a href="https://postmarkapp.com/" rel="nofollow">https://postmarkapp.com/</a>.</li></ul> <p data-svelte-h="svelte-12cga0t">How to register the domain, setup the DNS and the email service is out of the scope of this article. Anyway it depends on your providers.</p> <h4 id="system-requirements" data-svelte-h="svelte-3171kw"><a class="heading-link" title="Permalink" aria-hidden="true" href="#system-requirements"><span>#</span></a>System Requirements</h4> <p data-svelte-h="svelte-19w1vh9">The installer installs all the system dependencies that you need, like MySQL, Redis, etcetera. You only need a fresh Ubuntu server using one of these versions:</p> <ul data-svelte-h="svelte-1t5v1st"><li>Ubuntu 22.04 LTS (Jammy Jellyfish).</li> <li>Ubuntu 20.04 LTS (Focal Fossa)</li></ul> <h4 id="information-needed" data-svelte-h="svelte-1f8m14g"><a class="heading-link" title="Permalink" aria-hidden="true" href="#information-needed"><span>#</span></a>Information needed</h4> <p data-svelte-h="svelte-42kb83">During the installation process you will need to respond to some questions. The following are the main values you will have to provide:</p> <p data-svelte-h="svelte-d4ztcc">Droplet:</p> <ul data-svelte-h="svelte-ngkobo"><li>Root password.</li> <li>Hostname: <code>unit3d-demo</code>.</li></ul> <p data-svelte-h="svelte-isjbbc">Postmark (sign up):</p> <ul data-svelte-h="svelte-ff4q3w"><li>Username.</li> <li>Email.</li> <li>Password.</li></ul> <p data-svelte-h="svelte-mczh9l">UNIT3D Platform Owner:</p> <ul data-svelte-h="svelte-187yq1r"><li>Username: We used <code>unit3d-owner</code>.</li> <li>Email.</li> <li>Password.</li></ul> <p data-svelte-h="svelte-ep22g">MySQL:</p> <ul data-svelte-h="svelte-4e0vgm"><li>Root password.</li> <li>UNIT3D user: username (<code>unit3d</code>) and password.</li></ul> <p data-svelte-h="svelte-1m0izm8">SMTP Configuration:</p> <ul data-svelte-h="svelte-19nz10z"><li>Driver: smtp.</li> <li>Server: <code>smtp.postmarkapp.com</code>.</li> <li>Port: <code>587</code>.</li> <li>Username: A token provided by postmarkapp.</li> <li>Password: Same as username.</li></ul> <p data-svelte-h="svelte-1g443ni">TMDB (<a href="https://www.themoviedb.org/" rel="nofollow">themoviedb.org</a>, a service to get metadata about movies):</p> <ul data-svelte-h="svelte-1mat26a"><li>API key.</li></ul> <p data-svelte-h="svelte-voi7bs">Used Versions:</p> <ul data-svelte-h="svelte-m2eret"><li>OS: Ubuntu 22.04 LTS (Jammy Jellyfish)</li> <li>PHP: 8.3.10</li> <li>Database: 8.0.39-0ubuntu0.22.04.1</li> <li>Laravel: 11.5.0</li> <li>UNIT3D Community Edition: v8.1.3</li> <li>Installation dir: <code>/var/www/html</code></li></ul> <p data-svelte-h="svelte-1kmvvj">Let’s install the software step by step.</p> <h3 id="step-1-create-the-droplet-in-digital-ocean" data-svelte-h="svelte-1ww2fuo"><a class="heading-link" title="Permalink" aria-hidden="true" href="#step-1-create-the-droplet-in-digital-ocean"><span>#</span></a>Step 1. Create the Droplet in Digital Ocean</h3> <p data-svelte-h="svelte-1558emt">We decided to create a new project so we can assign resources to this project:</p> <img srcset="/images/posts/review-and-setup-guide-for-unit3d/01-new-project-in-do.png, /images/posts/review-and-setup-guide-for-unit3d/01-new-project-in-do.png, /images/posts/review-and-setup-guide-for-unit3d/01-new-project-in-do.png" src="/images/posts/review-and-setup-guide-for-unit3d/01-new-project-in-do.png" alt="Create a new project in Digital Ocean" loading="lazy" decoding="async" class="svelte-1ykl0dj"> <p data-svelte-h="svelte-d46xoo">And this is the droplet configuration.</p> <img srcset="/images/posts/review-and-setup-guide-for-unit3d/02-create-droplet-12-dollars.png, /images/posts/review-and-setup-guide-for-unit3d/02-create-droplet-12-dollars.png, /images/posts/review-and-setup-guide-for-unit3d/02-create-droplet-12-dollars.png" src="/images/posts/review-and-setup-guide-for-unit3d/02-create-droplet-12-dollars.png" alt="Create a new 12-dollar droplet in Digital Ocean" loading="lazy" decoding="async" class="svelte-1ykl0dj"> <p data-svelte-h="svelte-lhdl8g">Before continuing with the tutorial make sure your root domain and <code>www</code> subdomain are pointing to the droplet’s IP.</p> <div class="code-block svelte-11qxx87"> <div class="lang svelte-11qxx87">console</div> <button class="copy-button copy-button-gray svelte-11qxx87"></button> <div class="code-content"><pre class="language-console"><!-- HTML_TAG_START --><code class="language-console">ping unit3d-demo.com
PING unit3d-demo.com (134.122.65.71) 56(84) bytes of data.

ping &lt;www.unit3d-demo.com&gt;
PING unit3d-demo.com (134.122.65.71) 56(84) bytes of data.</code><!-- HTML_TAG_END --></pre></div></div> <p data-svelte-h="svelte-j3ieou">Also, check that you can login using SSH:</p> <div class="code-block svelte-11qxx87"> <div class="lang svelte-11qxx87">console</div> <button class="copy-button copy-button-gray svelte-11qxx87"></button> <div class="code-content"><pre class="language-console"><!-- HTML_TAG_START --><code class="language-console">ssh root@134.122.65.71</code><!-- HTML_TAG_END --></pre></div></div> <h3 id="step-2-update-the-server" data-svelte-h="svelte-1tvc6v4"><a class="heading-link" title="Permalink" aria-hidden="true" href="#step-2-update-the-server"><span>#</span></a>Step 2. Update the Server</h3> <p data-svelte-h="svelte-1uel1v7">This is only a recommendation before running the installer.</p> <div class="code-block svelte-11qxx87"> <div class="lang svelte-11qxx87">console</div> <button class="copy-button copy-button-gray svelte-11qxx87"></button> <div class="code-content"><pre class="language-console"><!-- HTML_TAG_START --><code class="language-console">sudo apt-get update
Hit:1 http://mirrors.digitalocean.com/ubuntu jammy InRelease
Hit:2 https://repos.insights.digitalocean.com/apt/do-agent main InRelease
Hit:3 http://mirrors.digitalocean.com/ubuntu jammy-updates InRelease
Hit:4 https://repos-droplet.digitalocean.com/apt/droplet-agent main InRelease
Hit:5 http://mirrors.digitalocean.com/ubuntu jammy-backports InRelease
Hit:6 http://security.ubuntu.com/ubuntu jammy-security InRelease
Reading package lists... Done</code><!-- HTML_TAG_END --></pre></div></div> <h3 id="step-3-run-the-unit3d-installer" data-svelte-h="svelte-lq6m1r"><a class="heading-link" title="Permalink" aria-hidden="true" href="#step-3-run-the-unit3d-installer"><span>#</span></a>Step 3. Run the UNIT3D Installer</h3> <div class="code-block svelte-11qxx87"> <div class="lang svelte-11qxx87">console</div> <button class="copy-button copy-button-gray svelte-11qxx87"></button> <div class="code-content"><pre class="language-console"><!-- HTML_TAG_START --><code class="language-console">sudo apt -y install git
git clone https://github.com/HDInnovations/UNIT3D-Installer.git installer
cd installer
sudo ./install.sh</code><!-- HTML_TAG_END --></pre></div></div> <p data-svelte-h="svelte-ev6kxw">The installer has some steps:</p> <ul data-svelte-h="svelte-1gccjx5"><li>Validate Installer Policies</li> <li>Server Setup</li> <li>Prerequisites</li> <li>Database Setup</li> <li>Php Setup (PHP &amp; PHP-FPM Configuration)</li> <li>Nginx Setup (Nginx Setup &amp; Configurations)</li> <li>Unit3d Setup (UNIT3D-Community-Edition Settings and Configuration)</li></ul> <p data-svelte-h="svelte-qijvl3">First, an assistant will run some checks and it will ask your preferences:</p> <img srcset="/images/posts/review-and-setup-guide-for-unit3d/03-installer.png, /images/posts/review-and-setup-guide-for-unit3d/03-installer.png, /images/posts/review-and-setup-guide-for-unit3d/03-installer.png" src="/images/posts/review-and-setup-guide-for-unit3d/03-installer.png" alt="UNIT3D Installer" loading="lazy" decoding="async" class="svelte-1ykl0dj"> <p data-svelte-h="svelte-nhxdxt">All settings are really easy, specially if you already have all the tokes and password for integrations with external services. When you finish the initial questionnaire you will reach the following confirmation point:</p> <img srcset="/images/posts/review-and-setup-guide-for-unit3d/04-last-step-installer.png, /images/posts/review-and-setup-guide-for-unit3d/04-last-step-installer.png, /images/posts/review-and-setup-guide-for-unit3d/04-last-step-installer.png" src="/images/posts/review-and-setup-guide-for-unit3d/04-last-step-installer.png" alt="UNIT3D Installer" loading="lazy" decoding="async" class="svelte-1ykl0dj"> <h3 id="step-4-login-page" data-svelte-h="svelte-13oymvp"><a class="heading-link" title="Permalink" aria-hidden="true" href="#step-4-login-page"><span>#</span></a>Step 4. Login Page</h3> <p data-svelte-h="svelte-1si8nz2">That’s it. If all went fine during the installation you can load the login page:</p> <img srcset="/images/posts/review-and-setup-guide-for-unit3d/unit3d-login-page.png, /images/posts/review-and-setup-guide-for-unit3d/unit3d-login-page.png, /images/posts/review-and-setup-guide-for-unit3d/unit3d-login-page.png" src="/images/posts/review-and-setup-guide-for-unit3d/unit3d-login-page.png" alt="UNIT3D Login Page" loading="lazy" decoding="async" class="svelte-1ykl0dj"> <p data-svelte-h="svelte-1vods3x">You can use the owner account credentials you provided during the installation.</p> <div class="callout-block info svelte-sxx0n0"><div class="icon-wrapper svelte-sxx0n0"><svg width="100%" height="100%" stroke-width="1.5" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 11.5V16.5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path d="M12 7.51L12.01 7.49889" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path d="M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path></svg></div> <p data-svelte-h="svelte-shjskw">If the official demo is down you can apply for signing up in our demo on: <a href="https://www.unit3d-demo.com/application" rel="nofollow">https://www.unit3d-demo.com/application</a>. You don’t need to provide real data, just a valid email so we can confirm it manually. We want to highlight, however, that we may shut down this demo at any time.</p></div> <h3 id="troubleshooting" data-svelte-h="svelte-msbux3"><a class="heading-link" title="Permalink" aria-hidden="true" href="#troubleshooting"><span>#</span></a>Troubleshooting</h3> <p data-svelte-h="svelte-1nj3imx">During the installation we had a couple of issues.</p> <p data-svelte-h="svelte-8diijs"><strong>First</strong>, we chose to use HTTPs but the domain was not pointing the droplet’s IP. The generation of the Let’s Encrypt certificates with certbot failed because it was not able to reach the server to check the challenge. Once we fixed the DNS we could not continue on that point because other steps like inserting some values in the database failed. <strong>The installation process does not allow to go back or reset to the initial state</strong>. We needed to create a new droplet.</p> <p data-svelte-h="svelte-k5po1m"><strong>Second</strong>, the initial server was too small and it stuck at building the frontend app. We got this error:</p> <div class="code-block svelte-11qxx87"> <div class="lang svelte-11qxx87">console</div> <button class="copy-button copy-button-gray svelte-11qxx87"></button> <div class="code-content"><pre class="language-console"><!-- HTML_TAG_START --><code class="language-console">[Warning] $ vite build
error: script &quot;build&quot; was terminated by signal SIGKILL (Forced Quit)
Killed</code><!-- HTML_TAG_END --></pre></div></div> <p data-svelte-h="svelte-4b5k5p">The problem was solved by increasing the droplet size. Anyway, It was too small to host all the services UNIT3D requires. Currently, with no users, the <strong>CPU Usage</strong> is at almost <strong>30%</strong> using a 1 vCPU; 2GB RAM instance.</p> <p data-svelte-h="svelte-6lrf1i">Finally, we also saw a warning in the Laravel logs.</p> <pre class="language-text"><!-- HTML_TAG_START --><code class="language-text">Base table or view not found: 1146 Table 'unit3d.torrents'</code><!-- HTML_TAG_END --></pre> <p data-svelte-h="svelte-50ztmp">We opened an <a href="https://github.com/HDInnovations/UNIT3D-Community-Edition/issues/4048" rel="nofollow">issue</a>. However, we checked it and the table was there and the application seems to work fine.</p> <h2 id="user-interface" data-svelte-h="svelte-1gcwmll"><a class="heading-link" title="Permalink" aria-hidden="true" href="#user-interface"><span>#</span></a>User Interface</h2> <p data-svelte-h="svelte-1d1o6hr">After installing the application, we were using it for a while. We:</p> <ul data-svelte-h="svelte-1cblm8y"><li>Uploaded a torrent.</li> <li>Tried to send an invitation.</li></ul> <p data-svelte-h="svelte-19g8edd">The application has a lot of features and it can be a little bit overwhelming the first time you use it, specially if you are not used to the BitTorrent index terminology. We could not send an invitation even with the owner account because you need to give some points to the account to enable the user to send invitations. Without a basic knowledge about the common features in indexes it can be tough to understand what some features are or how to customize the index to your needs. Fortunately the maintainers offer install and tuning services.</p> <h2 id="conclusion" data-svelte-h="svelte-br5ox0"><a class="heading-link" title="Permalink" aria-hidden="true" href="#conclusion"><span>#</span></a>Conclusion</h2> <p data-svelte-h="svelte-1fcsocp">UNIT3D stands out as a fully-featured BitTorrent index, offering a wide array of functionalities that cater to both developers and community moderators. Its robust codebase and ease of installation are significant advantages, though newcomers may find the platform’s complexity daunting. The lack of extensive documentation on best practices within the BitTorrent community is a challenge, but with support from active maintainers, users can still achieve a high level of customization and control.</p></div></div>
          ]]></content:encoded>
          <media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://v2.torrust.com//images/posts/review-and-setup-guide-for-unit3d/unit3d-user-profile-screenshot.png"/>
          <media:content xmlns:media="http://search.yahoo.com/mrss/" medium="image" url="https://v2.torrust.com//images/posts/review-and-setup-guide-for-unit3d/unit3d-user-profile-screenshot.png"/>          
        </item>
      
        <item>
          <guid>https://v2.torrust.com/released-v3-0-0-alpha-12</guid>
          <title>Released version v3.0.0-alpha.12</title>
          <description>We're excited to announce the release of v3.0.0-alpha.12, marking a significant step towards our upcoming major release, v3.0.0. This release solidifies the features and prepares us for the beta phase.</description>
          <link>https://v2.torrust.com/released-v3-0-0-alpha-12</link>
          <pubDate>13/08/2024 14:30:38</pubDate>
          <category>Announcement</category><category>Release</category>
          <content:encoded><![CDATA[
            <div style="margin: 50px 0; font-style: italic;">
              If anything looks wrong, 
              <strong>
                <a href="https://v2.torrust.com/released-v3-0-0-alpha-12">
                  read on the site!
                </a>
              </strong>
            </div>

             <div class="flex svelte-19d8qsr"> <div class=" svelte-13ebny9" style="position: relative;"><div class="svelte-13ebny9"><h2 id="table-of-contents" data-svelte-h="svelte-outevg"><a class="heading-link" title="Permalink" aria-hidden="true" href="#table-of-contents"><span>#</span></a>Table of contents</h2> <ul data-svelte-h="svelte-cy4tdl"><li><a href="#hello-torrust-community">Hello, Torrust Community!</a></li> <li><a href="#whats-new-in-v300-alpha12">What’s New in v3.0.0-alpha.12</a></li> <li><a href="#release-schedule">Release Schedule</a></li> <li><a href="#how-to-get-involved">How to Get Involved</a></li> <li><a href="#your-feedback-makes-us-better">Your Feedback Makes Us Better</a></li> <li><a href="#important-notice-demo-availability">Important Notice: Demo Availability</a></li> <li><a href="#acknowledgments">Acknowledgments</a></li></ul></div></div> <div class="svelte-4jsat1"><h2 id="hello-torrust-community" data-svelte-h="svelte-1vh8tpj"><a class="heading-link" title="Permalink" aria-hidden="true" href="#hello-torrust-community"><span>#</span></a><strong>Hello, Torrust Community!</strong></h2> <p data-svelte-h="svelte-1v9vz85">We know you’ve been eagerly anticipating the next major release of Torrust, and we’re thrilled to announce that we’re one step closer. Today, we’re excited to unveil version v3.0.0-alpha.12, a milestone that locks in the features for our upcoming major release. This alpha release is a critical step in our development cycle, and your participation in testing and feedback is more important than ever.</p> <h2 id="whats-new-in-v300-alpha12" data-svelte-h="svelte-11j7qb3"><a class="heading-link" title="Permalink" aria-hidden="true" href="#whats-new-in-v300-alpha12"><span>#</span></a>What’s New in v3.0.0-alpha.12</h2> <p data-svelte-h="svelte-x4lxas">In this release, we’ve focused on stabilizing the new features and refining the performance of Torrust. We’ve made several improvements under the hood that pave the way for a smoother user experience and better scalability. Here’s a quick rundown of what you can expect:</p> <ul data-svelte-h="svelte-2efcfg"><li><strong>New features:</strong> Permanent tracker keys and allow to upload pre-generated keys. That would help users who want to migrate to the Torrust Tracker without affecting their active users.</li> <li><strong>Improved configuration:</strong> Configuration has been changed in both the Tracker and Index to make it clearer. Error messages have also been improved to help administrators to fix configuration errors.</li> <li><strong>Security Updates</strong>.</li> <li><strong>UI/UX Refinements:</strong> Minor tweaks and fixes to the user interface, enhancing usability and user experience.</li></ul> <p data-svelte-h="svelte-171nzu4">The live demo is always updated to the latest version. We encourage you to explore it, try out the new features, and share your thoughts.</p> <div class="callout-block info svelte-sxx0n0"><div class="icon-wrapper svelte-sxx0n0"><svg width="100%" height="100%" stroke-width="1.5" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 11.5V16.5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path d="M12 7.51L12.01 7.49889" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path d="M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path></svg></div> <p data-svelte-h="svelte-aowssa">Live demo: <a href="http://index.torrust-demo.com" rel="nofollow">http://index.torrust-demo.com</a></p></div> <h2 id="release-schedule" data-svelte-h="svelte-fbktfz"><a class="heading-link" title="Permalink" aria-hidden="true" href="#release-schedule"><span>#</span></a>Release Schedule</h2> <p data-svelte-h="svelte-2jnc2v">The journey to our major release continues, and here’s our roadmap:</p> <table data-svelte-h="svelte-1i7spot"><thead><tr><th>Milestone</th> <th>Target Date</th> <th>Version</th></tr></thead> <tbody><tr><td>Feature Freeze</td> <td>15/08/2024</td> <td>3.0.0-alpha.12</td></tr> <tr><td>Code Freeze</td> <td>15/08/2024</td> <td></td></tr> <tr><td>Beta Release</td> <td>31/08/2024</td> <td>3.0.0-beta</td></tr> <tr><td>Release Candidate</td> <td>15/09/2024</td> <td>3.0.0-rc.1</td></tr> <tr><td>Final Release</td> <td>30/09/2024</td> <td>3.0.0</td></tr></tbody></table> <h2 id="how-to-get-involved" data-svelte-h="svelte-1rvh1lv"><a class="heading-link" title="Permalink" aria-hidden="true" href="#how-to-get-involved"><span>#</span></a>How to Get Involved</h2> <p data-svelte-h="svelte-1ihzgpp">Your feedback is invaluable to us. As we move towards the beta phase, we invite you to download this alpha release, test it extensively, and report any issues or suggestions you may have. Here’s how you can contribute:</p> <ul data-svelte-h="svelte-1knhi4o"><li>Testing: Download the alpha release and run it in your environment.</li> <li>Reporting Bugs: If you encounter any issues, please report them through our issue tracker.</li></ul> <h2 id="your-feedback-makes-us-better" data-svelte-h="svelte-1mkcvv2"><a class="heading-link" title="Permalink" aria-hidden="true" href="#your-feedback-makes-us-better"><span>#</span></a>Your Feedback Makes Us Better</h2> <p data-svelte-h="svelte-1hiya5q">We would like the community to participate in testing this release and give us feedback.</p> <p data-svelte-h="svelte-a2sf39">After releasing the final version 3.0.0 we want to open discussions for the roadmap. We want you to propose features to help us continue building even better tools and allow people to make use of the BitTorrent ecosystem.</p> <p data-svelte-h="svelte-plipxz">Got ideas? Suggestions for improvement? Join the <a href="https://github.com/torrust/torrust-index-gui/discussions" rel="nofollow">discussion</a> on our GitHub repo’s discussion section. Your thoughts and proposals are a key part of our collaborative development process. Let’s brainstorm together to make Torrust even better.</p> <h2 id="important-notice-demo-availability" data-svelte-h="svelte-1b7v9jv"><a class="heading-link" title="Permalink" aria-hidden="true" href="#important-notice-demo-availability"><span>#</span></a>Important Notice: Demo Availability</h2> <div class="callout-block info svelte-sxx0n0"><div class="icon-wrapper svelte-sxx0n0"><svg width="100%" height="100%" stroke-width="1.5" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 11.5V16.5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path d="M12 7.51L12.01 7.49889" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path d="M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path></svg></div> <p data-svelte-h="svelte-168ochg">Please be aware that the demo is subject to downtime or resets. As a beta version, it’s part of our testing process. Any data you add may be lost during these periods. We appreciate your understanding and patience as we fine-tune the platform.</p></div> <h2 id="acknowledgments" data-svelte-h="svelte-1e4fcph"><a class="heading-link" title="Permalink" aria-hidden="true" href="#acknowledgments"><span>#</span></a>Acknowledgments</h2> <p data-svelte-h="svelte-1agj1iq">We want to extend our deepest thanks to all the contributors who have tirelessly tested and provided feedback on this release. Your insights have been crucial in getting us this far, and we look forward to continuing this journey together.</p></div></div>
          ]]></content:encoded>
          <media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://v2.torrust.com//images/posts/released-v3-0-0-alpha-12/team.png"/>
          <media:content xmlns:media="http://search.yahoo.com/mrss/" medium="image" url="https://v2.torrust.com//images/posts/released-v3-0-0-alpha-12/team.png"/>          
        </item>
      
        <item>
          <guid>https://v2.torrust.com/torrust-enhancing-the-bittorrent-ecosystem</guid>
          <title>Torrust - Enhancing the BitTorrent Ecosystem</title>
          <description>Torrust, an open-source organization, is making significant contributions to the BitTorrent ecosystem by developing robust tools, improving documentation, and fostering community collaboration.</description>
          <link>https://v2.torrust.com/torrust-enhancing-the-bittorrent-ecosystem</link>
          <pubDate>31/05/2024 09:33:14</pubDate>
          <category>Introduction</category><category>Torrust</category>
          <content:encoded><![CDATA[
            <div style="margin: 50px 0; font-style: italic;">
              If anything looks wrong, 
              <strong>
                <a href="https://v2.torrust.com/torrust-enhancing-the-bittorrent-ecosystem">
                  read on the site!
                </a>
              </strong>
            </div>

             <div class="flex svelte-19d8qsr"> <div class=" svelte-13ebny9" style="position: relative;"><div class="svelte-13ebny9"></div></div> <div class="svelte-4jsat1"><h2 id="hello-world-" data-svelte-h="svelte-164pckj"><a class="heading-link" title="Permalink" aria-hidden="true" href="#hello-world-"><span>#</span></a>Hello World! </h2> <p data-svelte-h="svelte-1kz2xuo">We haven’t introduced the Torrust Organization in this blog yet, including its vision, mission, and roadmap. This should have been the first post, but after contributing to the BitTorrent ecosystem for over three years, we now have a better understanding of what the BitTorrent protocols offer and how we can enhance the ecosystem.</p> <p data-svelte-h="svelte-b6ihlm">Torrust is an Open-Source Organization. It was created by <a href="https://github.com/mickvandijke" rel="nofollow">@mickvandijke</a> in 2021. Mick started by forking the UDP tracker from a <a href="https://github.com/naim94a" rel="nofollow">@naim94a</a>’s’ repository <a href="https://github.com/naim94a/udpt" rel="nofollow">https://github.com/naim94a/udpt</a> and using some packages for the UDP tracker from <a href="https://github.com/greatest-ape" rel="nofollow">@greatest-ape</a>’s <a href="https://github.com/greatest-ape/aquatic" rel="nofollow">Aquatic</a> repo. <a href="https://github.com/naim94a" rel="nofollow">@naim94a</a> had been working on the tracker since December 2012. In August 2022, <a href="https://github.com/Nautilus-Cyberneering" rel="nofollow">Nautilus Cyberneering</a> joined the project. <a href="https://github.com/mickvandijke" rel="nofollow">@mickvandijke</a> was already in contact with the Nautilus, and Nautilus decided to contribute due to the traction it was getting from the community and the alignment with their interests.</p> <p data-svelte-h="svelte-1k5fja4">We would like to thank <a href="https://github.com/naim94a" rel="nofollow">@naim94a</a> and <a href="https://github.com/greatest-ape" rel="nofollow">@greatest-ape</a> and all other contributors for their invaluable contributions in coding, opening issues, PRs, improving documentation, sharing ideas, etc.</p> <p data-svelte-h="svelte-gurw2h">Over the last two years, significant efforts have been made to establish Torrust software as a leading software in the BitTorrent open-source community. We have applied the best languages, tools, and practices to bring a modern, reliable <a href="https://github.com/torrust/torrust-tracker" rel="nofollow">Tracker</a> and <a href="https://github.com/torrust/torrust-index" rel="nofollow">Index</a>. We are close to releasing the version v3.0.0, which we consider a solid foundation for future web3 projects requiring file-sharing services.</p> <p data-svelte-h="svelte-azxlt3">During this time, we have focused not only on building great products but also on contributing to the community in different ways like improving BitTorrent documentation, helping maintainers to maintain their Rust-based BitTorrents packages, participating in protocol discussions, and writing articles about BitTorrent.</p> <p data-svelte-h="svelte-hm936d">We have also prioritized onboarding contributors to the organization. We strive to provide a good experience for anyone interested in contributing, whether it’s fixing a small typo, improving documentation, or submitting a large PR with a new feature. We respond quickly and make it easy to contribute, exemplified by the extensive documentation we have written.</p> <h2 id="why-is-bittorrent-important" data-svelte-h="svelte-4gd3lf"><a class="heading-link" title="Permalink" aria-hidden="true" href="#why-is-bittorrent-important"><span>#</span></a>Why is BitTorrent important?</h2> <p data-svelte-h="svelte-1ii666i">BitTorrent is a peer-to-peer (P2P) file sharing protocol, first released in 2001 by <a href="https://github.com/bramcohen" rel="nofollow">Bram Cohen</a>. It revolutionized file distribution across the internet by allowing efficient peer-to-peer sharing without relying on a single centralized server, making it highly resilient and scalable. BitTorrent enables each downloader to become an uploader, creating a network of file sharing that boosts download speeds and balances server loads.</p> <p data-svelte-h="svelte-ek6d9m">BitTorrent has been very often related to illegal sharing of copyrighted material, it’s worth noting that BitTorrent itself is not illegal. It is a tool, and like any tool, its legality depends on how it’s used. It has numerous legitimate uses such as distributing open-source software, sharing large datasets, real-time communications, and even reducing server load for large-scale events like product launches or game updates.</p> <p data-svelte-h="svelte-a783k">There have been many interesting and useful projects over the years, such as:</p> <ul data-svelte-h="svelte-zhqt35"><li><a href="https://academictorrents.com/" rel="nofollow">https://academictorrents.com/</a> for sharing enormous datasets, for researchers, by researchers.</li> <li><a href="https://help.archive.org/help/archive-bittorrents/" rel="nofollow">The Internet Archive</a> is also using torrents since 2012.</li> <li><a href="https://www.legittorrents.info/" rel="nofollow">https://www.legittorrents.info/</a> was a collection of legal torrents.</li></ul> <p data-svelte-h="svelte-1a1enxl">More recently, the <a href="https://webtorrent.io/" rel="nofollow">webtorrent</a> extension has enabled BitTorrent clients to run in a browser, unlocking new capabilities like:</p> <ul data-svelte-h="svelte-1r3wa61"><li><a href="https://peertube.cpy.re/" rel="nofollow">PeerTube</a>: Prototype of a decentralized video streaming platform in the web browser.</li> <li><a href="https://cinetimes.org/" rel="nofollow">CineTimes</a>: A streaming website of public domain movies.</li> <li><a href="https://www.bitchute.com/" rel="nofollow">BitChute</a>: A decentralized video streaming social network.</li></ul> <p data-svelte-h="svelte-87h3tw">You can find more <a href="https://webtorrent.io/faq" rel="nofollow">here</a>.</p> <p data-svelte-h="svelte-1n6t80c">Despite the emergence of blockchain alternatives like <a href="https://ipfs.tech/" rel="nofollow">IPFS</a> (InterPlanetary File System) or <a href="https://www.btfs.io/" rel="nofollow">BitTorrent File System 3.0</a>, we believe off-chain basic BitTorrent protocols without monetary incentives still fit many decentralization use cases. Many web3 applications could be based on what we already have, as shown in this <a href="https://webtorrent.io/faq" rel="nofollow">list</a>.</p> <h2 id="current-bittorrent-issues" data-svelte-h="svelte-1a7f7y3"><a class="heading-link" title="Permalink" aria-hidden="true" href="#current-bittorrent-issues"><span>#</span></a>Current BitTorrent Issues</h2> <p data-svelte-h="svelte-1ahm3oe">After being involved in the BitTorrent ecosystem for a couple of years, we believe there is a lot of room for improvement. For example:</p> <h3 id="documentation" data-svelte-h="svelte-1l6himn"><a class="heading-link" title="Permalink" aria-hidden="true" href="#documentation"><span>#</span></a>Documentation</h3> <p data-svelte-h="svelte-1h1okdb">The source of true for BitTorrent protocols are <a href="https://www.bittorrent.org/beps/bep_0000.html" rel="nofollow">BEPs</a>. While it’s a good starting point, the information provided is often insufficient for implementation. Important details are sometimes missing, and there are commonly applied extensions that are not documented.</p> <p data-svelte-h="svelte-1rufgbm">We aim to improve the official documentation in two stages. . First, we will write new <a href="https://github.com/torrust/teps" rel="nofollow">Torrust Enhancement Proposals</a>, and some of them could be converted into BEPs if they are generic enough.</p> <p data-svelte-h="svelte-1vipdn">Not only the official protocol documentation is sometimes vague but also clients, trackers implementations, etc. We think the documentations should be:</p> <ul data-svelte-h="svelte-1cnh3mu"><li>Clear</li> <li>Comprehensive</li> <li>Accessible</li> <li>Up-to-date</li> <li>User-focused</li> <li>Interactive and engaging</li> <li>Easy to update and maintain</li></ul> <p data-svelte-h="svelte-lobec9">And that should be for all levels, from low-level protocols to high-level end-user applications.</p> <p data-svelte-h="svelte-8isw5t">At Torrust, we document:</p> <ul data-svelte-h="svelte-1nu6f04"><li>Classes</li> <li>Modules</li> <li>Crates</li> <li>Application (including setup, how to use, ADRs, licenses, etc)</li> <li>Processes ((including how to contribute, how to release new version, how to make decisions, etc)</li></ul> <h3 id="sustainability" data-svelte-h="svelte-1555276"><a class="heading-link" title="Permalink" aria-hidden="true" href="#sustainability"><span>#</span></a>Sustainability</h3> <p data-svelte-h="svelte-1uyvq8m">Many projects are very old, which isn’t necessarily bad because they have proven to be robust and reliable. However, onboarding new contributors is often challenging.</p> <h3 id="scalability" data-svelte-h="svelte-1pcrlzw"><a class="heading-link" title="Permalink" aria-hidden="true" href="#scalability"><span>#</span></a>Scalability</h3> <p data-svelte-h="svelte-hebmyo">We haven’t seen many projects ready to scale horizontally. The focus is often on optimization for a single server. For example, the Tracker uses memory to keep peer lists, making it harder to use multiple servers. While our Tracker still has this limitation, other trackers like <a href="https://erdgeist.org/arts/software/opentracker/" rel="nofollow">opentracker</a> can run in a cluster.</p> <h3 id="lack-of-interest" data-svelte-h="svelte-1kauuol"><a class="heading-link" title="Permalink" aria-hidden="true" href="#lack-of-interest"><span>#</span></a>Lack of interest</h3> <p data-svelte-h="svelte-14ma3ct">Despite the advent of blockchain, it seems that average people are not concerned about the problems of centralization. Blockchain projects might still attract developers and users, but BitTorrent is often seen as “old” technology for a problem that people don’t see or care about.</p> <h3 id="missing-features" data-svelte-h="svelte-vs3fos"><a class="heading-link" title="Permalink" aria-hidden="true" href="#missing-features"><span>#</span></a>Missing features</h3> <p data-svelte-h="svelte-z7jnql">Several missing features make it harder to use BitTorrent in modern web3 applications:</p> <ul data-svelte-h="svelte-1pagpfy"><li><strong>Versioning</strong>: There is no official way to create versions of the same torrent. Releasing new versions requires creating a completely new torrent, which duplicates its contents.</li> <li><strong>Guaranteed Seeding</strong>: Torrents might include URLs for seeding, but hosting the content when no peer is sharing the torrent can be challenging. Blockchain-based solutions solve this problem with monetary incentives.</li> <li><strong>Standards for Content Formats</strong>: Even if you build a web3 app based on BitTorrent, interoperability is not guaranteed if content doesn’t follow standards. For example, if you want to build a “hiking” app, you should specify the format of the files included in the torrents: title, description, track, images, waypoints, etc.</li></ul> <h2 id="vision" data-svelte-h="svelte-1fzx1sz"><a class="heading-link" title="Permalink" aria-hidden="true" href="#vision"><span>#</span></a>Vision</h2> <p data-svelte-h="svelte-1yki8nj">Have you ever considered what would happen if the three big hosting providers (AWS, Azure, Google) disappeared?</p> <p data-svelte-h="svelte-wxd1rw">You would probably be affected, just like millions of others. The internet was conceived as a decentralized network (Usenet, DNS, Fidonet, etc.), but it has become increasingly centralized, raising the risk of a global collapse. Decentralized apps are more resilient, though more complex to build and less efficient.</p> <p data-svelte-h="svelte-zh0sca">There is content that we should all care about, such as scientific papers, datasets, and user-generated data like Wikipedia.</p> <p data-svelte-h="svelte-1jhr00p">Decentralization is the only way to make data truly open and accessible for all. It also allows for interoperability and data migration, so data owners are not locked into a specific provider.</p> <p data-svelte-h="svelte-pzj23e">Our vision is to <strong>enable future generations to build a resilient information repositories that ensures data access for everyone</strong>. There is a lot of valuable information locked in data centers that could be lost forever. For example, if you enjoy hiking, you might use an app to follow a track and find the starting point. This cultural heritage, created over generations, could be needed again in the future.</p> <h2 id="mission" data-svelte-h="svelte-a67asb"><a class="heading-link" title="Permalink" aria-hidden="true" href="#mission"><span>#</span></a>Mission</h2> <p data-svelte-h="svelte-193jguq">Where does Torrust fit into this picture? We aim to improve upon this impressive technology. Torrust is dedicated to developing robust, fault-tolerant tools for the BitTorrent ecosystem, with a focus on providing good testing coverage and thorough documentation for developers and users alike.</p> <p data-svelte-h="svelte-1nsj51">Our current portfolio includes a Tracker and an Index. The tracker, written in Rust, is a server that helps coordinate peers in the BitTorrent protocol. The Index is a website that serves as a database of torrent files, comprising a frontend web app (Index GUI) for user interaction and a backend REST API written in Rust for data and business logic (Index).</p> <p data-svelte-h="svelte-inr52u">We are planning to:</p> <ul data-svelte-h="svelte-176lr2t"><li>Provide these two components as a first step. In the medium term, we would like to extract more packages that could be used by other open-source BitTorrent projects, such as a core tracker, a tracker client library, etc.</li> <li>Build the foundations (libraries, apps, etc.) that will enable the creation of better BitTorrent apps more efficiently in the future.</li></ul> <h2 id="roadmap" data-svelte-h="svelte-171157t"><a class="heading-link" title="Permalink" aria-hidden="true" href="#roadmap"><span>#</span></a>Roadmap</h2> <p data-svelte-h="svelte-equgtn">Core:</p> <ul data-svelte-h="svelte-ao54ly"><li>Implement more BEPs.</li> <li>Support for <a href="https://webtorrent.io/" rel="nofollow">WebTorrent</a>.</li> <li>Extract packages that could be useful for other OS projects: tracker client, tracker checker.</li></ul> <p data-svelte-h="svelte-1vcoczx">New features:</p> <ul data-svelte-h="svelte-13rykkv"><li>Permanent keys for the Tracker.</li> <li>Peer and torrents specific statistics.</li></ul> <p data-svelte-h="svelte-sdcvrl">Persistence:</p> <ul data-svelte-h="svelte-1hiupqh"><li>Support other databases like PostgreSQL.</li> <li>Migration to NoSQL?.</li></ul> <p data-svelte-h="svelte-q2yqsw">Performance:</p> <ul data-svelte-h="svelte-eeulbu"><li>More optimizations for the tracker.</li></ul> <p data-svelte-h="svelte-p5rrof">Integrations:</p> <ul data-svelte-h="svelte-1u4mq5k"><li>Monitoring (Prometheus).</li></ul> <p data-svelte-h="svelte-zj5j9u">Improve interoperability:</p> <ul data-svelte-h="svelte-1t8iigk"><li>Better support for Windows.</li> <li>Docker images for other architectures.</li></ul> <h2 id="why-should-you-consider-collaborating-with-us" data-svelte-h="svelte-x2zvve"><a class="heading-link" title="Permalink" aria-hidden="true" href="#why-should-you-consider-collaborating-with-us"><span>#</span></a>Why should you consider collaborating with us?</h2> <p data-svelte-h="svelte-15ewmez">Torrust is an excellent way to learn and gain practical experience with Rust and cutting-edge technologies that are quickly gaining popularity in the industry. It is also a fantastic opportunity to be part of a community that values knowledge sharing and collaboration. You can contribute to making data more open and accessible, potentially building an alternative infrastructure that can help avoid data loss or monopolization, which can be crucial for the survival of humanity.</p> <h2 id="contributing" data-svelte-h="svelte-1gcj59h"><a class="heading-link" title="Permalink" aria-hidden="true" href="#contributing"><span>#</span></a>Contributing</h2> <p data-svelte-h="svelte-zbwu22">If you see something wrong or you want to contribute to this article by:</p> <ul data-svelte-h="svelte-1pxkwtk"><li>Adding new sections.</li> <li>Fixing typos.</li> <li>Making it clearer.</li> <li>Adding links.</li> <li>Or whatever you think that could be interesting to have,</li></ul> <p data-svelte-h="svelte-1cyks1i">please open an <a href="https://github.com/torrust/torrust-website/issues" rel="nofollow">issue</a> or a <a href="https://github.com/torrust/torrust-website/pulls" rel="nofollow">PR</a>.</p> <p data-svelte-h="svelte-jnq0pp">If you have any questions or issues please open an issue in the corresponding repository:</p> <ul data-svelte-h="svelte-psntnz"><li>Torrust Tracker: <a href="https://github.com/torrust/torrust-tracker/issues" rel="nofollow">https://github.com/torrust/torrust-tracker/issues</a></li> <li>Torrust Index: <a href="https://github.com/torrust/torrust-index/issues" rel="nofollow">https://github.com/torrust/torrust-index/issues</a></li> <li>Torrust Website: <a href="https://github.com/torrust/torrust-index-gui/issues" rel="nofollow">https://github.com/torrust/torrust-index-gui/issues</a></li> <li>Torrust Compose: <a href="https://github.com/torrust/torrust-compose" rel="nofollow">https://github.com/torrust/torrust-compose</a></li> <li>Containerizing Rust Applications Examples: <a href="https://github.com/torrust/containerizing-rust-apps-examples" rel="nofollow">https://github.com/torrust/containerizing-rust-apps-examples</a></li></ul> <p data-svelte-h="svelte-nld7t3">We very welcome any contributions to the projects or <a href="https://github.com/torrust/torrust-website/issues" rel="nofollow">this article</a>.</p></div></div>
          ]]></content:encoded>
          <media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://v2.torrust.com//images/posts/deploying-torrust-to-production/deploy-torrust-to-a-digital-ocean-droplet.png"/>
          <media:content xmlns:media="http://search.yahoo.com/mrss/" medium="image" url="https://v2.torrust.com//images/posts/deploying-torrust-to-production/deploy-torrust-to-a-digital-ocean-droplet.png"/>          
        </item>
      
        <item>
          <guid>https://v2.torrust.com/profiling-the-torrust-bittorrent-udp-tracker</guid>
          <title>Profiling the Torrust BitTorrent UDP Tracker</title>
          <description>Dive into the advanced profiling techniques driving the Torrust BitTorrent Tracker's performance. This post uncovers the tools and methods we leverage to ensure the tracker's efficiency, scalability, and our journey towards optimizing peer-to-peer file sharing.</description>
          <link>https://v2.torrust.com/profiling-the-torrust-bittorrent-udp-tracker</link>
          <pubDate>25/03/2024 00:00:00</pubDate>
          <category>Performance</category><category>Profiling</category><category>UDP Tracker</category><category>Flamegraph</category><category>Kcachegrind</category><category>Valgrind</category>
          <content:encoded><![CDATA[
            <div style="margin: 50px 0; font-style: italic;">
              If anything looks wrong, 
              <strong>
                <a href="https://v2.torrust.com/profiling-the-torrust-bittorrent-udp-tracker">
                  read on the site!
                </a>
              </strong>
            </div>

             <div class="flex svelte-19d8qsr"> <div class=" svelte-13ebny9" style="position: relative;"><div class="svelte-13ebny9"><h2 id="table-of-contents" data-svelte-h="svelte-1m3njcc"><a class="heading-link" title="Permalink" aria-hidden="true" href="#table-of-contents"><span>#</span></a>Table of Contents</h2> <ul data-svelte-h="svelte-a8wx0q"><li><a href="#introduction">Introduction</a></li> <li><a href="#understanding-the-tracker">Understanding The Tracker</a></li> <li><a href="#current-challenges">Current Challenges</a></li> <li><a href="#internal-repository-benchmarking">Internal Repository Benchmarking</a></li> <li><a href="#profiling-with-valgrind">Profiling With Valgrind</a></li> <li><a href="#profiling-with-perf">Profiling With Perf</a></li> <li><a href="#conclusion">Conclusion</a></li> <li><a href="#acknowledgments">Acknowledgments</a></li> <li><a href="#links">Links</a></li></ul></div></div> <div class="svelte-4jsat1"><h2 id="introduction" data-svelte-h="svelte-1ahwhrx"><a class="heading-link" title="Permalink" aria-hidden="true" href="#introduction"><span>#</span></a>Introduction</h2> <p data-svelte-h="svelte-p2wyqp">In our quest to elevate the Torrust BitTorrent Tracker’s performance, we’ve embraced a suite of sophisticated benchmarking and profiling tools. This article builds on our previous discussion, ”<a href="benchmarking-the-torrust-bittorrent-tracker">Benchmarking the Torrust BitTorrent Tracker</a>” and delves into the metrics that guide our optimization efforts. Join us as we explore the intricacies of profiling in the dynamic landscape of BitTorrent technology.</p> <p data-svelte-h="svelte-bw563p">In the previous article we introduced to the community the benchmarking tools we are using at the moment to know whether the Tracker performs at the same level as other applications on the market.</p> <p data-svelte-h="svelte-ur42q">With those benchmarking tools we ensure that the Tracker has a good performance and we don’t have regressions. If you are curious about how we do benchmarking you can read the ”<a href="benchmarking-the-torrust-bittorrent-tracker">Benchmarking the Torrust BitTorrent Tracker</a>” article.</p> <p data-svelte-h="svelte-xrh8z6">In this article we will explain how we are collecting metrics to know which parts of the code we should improve.</p> <h2 id="understanding-the-tracker" data-svelte-h="svelte-rkyc3w"><a class="heading-link" title="Permalink" aria-hidden="true" href="#understanding-the-tracker"><span>#</span></a>Understanding The Tracker</h2> <p data-svelte-h="svelte-12tv1np">Before you continue reading this article you should know a little bit about the tracker internal structure. You can see an overview on the ”<a href="benchmarking-the-torrust-bittorrent-tracker">Benchmarking the Torrust BitTorrent Tracker</a>” article.</p> <img srcset="/images/posts/benchmarking-the-torrust-bittorrent-tracker/torrust-tracker-simplified-architecture.png, /images/posts/benchmarking-the-torrust-bittorrent-tracker/torrust-tracker-simplified-architecture.png, /images/posts/benchmarking-the-torrust-bittorrent-tracker/torrust-tracker-simplified-architecture.png" src="/images/posts/benchmarking-the-torrust-bittorrent-tracker/torrust-tracker-simplified-architecture.png" alt="Torrust Architecture" loading="lazy" decoding="async" class="svelte-1ykl0dj"> <h2 id="current-challenges" data-svelte-h="svelte-152gobe"><a class="heading-link" title="Permalink" aria-hidden="true" href="#current-challenges"><span>#</span></a>Current Challenges</h2> <p data-svelte-h="svelte-10abmqn">Balancing feature-rich functionality with performance is our central challenge. The <strong>Torrents Repository</strong>, a critical component, has been our focus, serving as the primary bottleneck for scaling request handling capabilities.</p> <p data-svelte-h="svelte-1iraxfy">Regardless which protocol clients use to connect to the tracker, eventually all requests reach the internal “Tracker” domain service. This tracker contains a repository with the list of all torrents. Each entry on the list contains two pieces of information:</p> <ul data-svelte-h="svelte-12ux8dn"><li><strong>The statistics about that torrent</strong>: number of seeders, leechers and peers that have completed downloading.</li> <li><strong>The peer list</strong>: a list of all the clients announcing the same torrent (swarm).</li></ul> <div class="code-block svelte-11qxx87"> <div class="lang svelte-11qxx87">json</div> <button class="copy-button copy-button-gray svelte-11qxx87"></button> <div class="code-content"><pre class="language-json"><!-- HTML_TAG_START --><code class="language-json"><span class="token punctuation">&#123;</span>
	<span class="token property">"info_hash"</span><span class="token operator">:</span> <span class="token string">"090c6d4fb3a03191c4ef1fda6236ef0efb2d5c10"</span><span class="token punctuation">,</span>
	<span class="token property">"seeders"</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
	<span class="token property">"completed"</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
	<span class="token property">"leechers"</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
	<span class="token property">"peers"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
		<span class="token punctuation">&#123;</span>
			<span class="token property">"peer_id"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
				<span class="token property">"id"</span><span class="token operator">:</span> <span class="token string">"0x2d71423030303030303030303030303030303031"</span><span class="token punctuation">,</span>
				<span class="token property">"client"</span><span class="token operator">:</span> <span class="token null keyword">null</span>
			<span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
			<span class="token property">"peer_addr"</span><span class="token operator">:</span> <span class="token string">"0.0.0.0:17548"</span><span class="token punctuation">,</span>
			<span class="token property">"updated"</span><span class="token operator">:</span> <span class="token number">1709916034742</span><span class="token punctuation">,</span>
			<span class="token property">"updated_milliseconds_ago"</span><span class="token operator">:</span> <span class="token number">1709916034742</span><span class="token punctuation">,</span>
			<span class="token property">"uploaded"</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
			<span class="token property">"downloaded"</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
			<span class="token property">"left"</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
			<span class="token property">"event"</span><span class="token operator">:</span> <span class="token string">"Completed"</span>
		<span class="token punctuation">&#125;</span>
	<span class="token punctuation">]</span>
<span class="token punctuation">&#125;</span></code><!-- HTML_TAG_END --></pre></div></div> <p data-svelte-h="svelte-g5f19h">The reason why we have been focusing on that part is because we think that’s the main bottleneck if we want to increase the number of requests the tracker can handle per second.</p> <p data-svelte-h="svelte-gomc2i">The <code>announce</code> request is the most important request a tracker needs to handle. Peers get the list of other peers from the tracker by making announce requests. The purpose of that request is:</p> <ul data-svelte-h="svelte-zqyhcf"><li>To include the peer making the request in the list of peers which are seeding or downloading the torrent.</li> <li>Return the list of other peers so that the client can start asking for torrent pieces to the other peers.</li></ul> <p data-svelte-h="svelte-1xjkt7m">Every request is a write/read request. The system is intensive in writes. All requests eventually try to acquire a write lock to include themselves in the peer list. That’s why we think that’s the main bottleneck in our implementation, at the moment. For that reason we have been trying different implementations of the torrents repository:</p> <div class="code-block svelte-11qxx87"> <div class="lang svelte-11qxx87">rust</div> <button class="copy-button copy-button-gray svelte-11qxx87"></button> <div class="code-content"><pre class="language-rust"><!-- HTML_TAG_START --><code class="language-rust"><span class="token keyword">pub</span> <span class="token keyword">type</span> <span class="token type-definition class-name">TorrentsRwLockStd</span> <span class="token operator">=</span> <span class="token class-name">RwLockStd</span><span class="token operator">&lt;</span><span class="token class-name">EntrySingle</span><span class="token operator">></span><span class="token punctuation">;</span>
<span class="token keyword">pub</span> <span class="token keyword">type</span> <span class="token type-definition class-name">TorrentsRwLockStdMutexStd</span> <span class="token operator">=</span> <span class="token class-name">RwLockStd</span><span class="token operator">&lt;</span><span class="token class-name">EntryMutexStd</span><span class="token operator">></span><span class="token punctuation">;</span>
<span class="token keyword">pub</span> <span class="token keyword">type</span> <span class="token type-definition class-name">TorrentsRwLockStdMutexTokio</span> <span class="token operator">=</span> <span class="token class-name">RwLockStd</span><span class="token operator">&lt;</span><span class="token class-name">EntryMutexTokio</span><span class="token operator">></span><span class="token punctuation">;</span>
<span class="token keyword">pub</span> <span class="token keyword">type</span> <span class="token type-definition class-name">TorrentsRwLockTokio</span> <span class="token operator">=</span> <span class="token class-name">RwLockTokio</span><span class="token operator">&lt;</span><span class="token class-name">EntrySingle</span><span class="token operator">></span><span class="token punctuation">;</span>
<span class="token keyword">pub</span> <span class="token keyword">type</span> <span class="token type-definition class-name">TorrentsRwLockTokioMutexStd</span> <span class="token operator">=</span> <span class="token class-name">RwLockTokio</span><span class="token operator">&lt;</span><span class="token class-name">EntryMutexStd</span><span class="token operator">></span><span class="token punctuation">;</span>
<span class="token keyword">pub</span> <span class="token keyword">type</span> <span class="token type-definition class-name">TorrentsRwLockTokioMutexTokio</span> <span class="token operator">=</span> <span class="token class-name">RwLockTokio</span><span class="token operator">&lt;</span><span class="token class-name">EntryMutexTokio</span><span class="token operator">></span><span class="token punctuation">;</span>
<span class="token keyword">pub</span> <span class="token keyword">type</span> <span class="token type-definition class-name">TorrentsSkipMapMutexStd</span> <span class="token operator">=</span> <span class="token class-name">CrossbeamSkipList</span><span class="token operator">&lt;</span><span class="token class-name">EntryMutexStd</span><span class="token operator">></span><span class="token punctuation">;</span> <span class="token comment">// Default</span>
<span class="token keyword">pub</span> <span class="token keyword">type</span> <span class="token type-definition class-name">TorrentsSkipMapMutexParkingLot</span> <span class="token operator">=</span> <span class="token class-name">CrossbeamSkipList</span><span class="token operator">&lt;</span><span class="token class-name">EntryMutexParkingLot</span><span class="token operator">></span><span class="token punctuation">;</span>
<span class="token keyword">pub</span> <span class="token keyword">type</span> <span class="token type-definition class-name">TorrentsSkipMapRwLockParkingLot</span> <span class="token operator">=</span> <span class="token class-name">CrossbeamSkipList</span><span class="token operator">&lt;</span><span class="token class-name">EntryRwLockParkingLot</span><span class="token operator">></span><span class="token punctuation">;</span>
<span class="token keyword">pub</span> <span class="token keyword">type</span> <span class="token type-definition class-name">TorrentsDashMapMutexStd</span> <span class="token operator">=</span> <span class="token class-name">XacrimonDashMap</span><span class="token operator">&lt;</span><span class="token class-name">EntryMutexStd</span><span class="token operator">></span><span class="token punctuation">;</span></code><!-- HTML_TAG_END --></pre></div></div> <p data-svelte-h="svelte-1pecre8">The default implementation used in production is <code>TorrentsSkipMapMutexStd</code>.</p> <div class="callout-block info svelte-sxx0n0"><div class="icon-wrapper svelte-sxx0n0"><svg width="100%" height="100%" stroke-width="1.5" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 11.5V16.5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path d="M12 7.51L12.01 7.49889" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path d="M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path></svg></div> <p data-svelte-h="svelte-1wyma0n"><strong>NOTICE</strong>: All implementations are based on types that support ordering like <code>BTreeMap</code> or <code>SkipMap</code>. The reason we use those types is because the tracker API has an endpoint where you can get the ordered list of all torrents in the tracker repository.</p></div> <h2 id="internal-repository-benchmarking" data-svelte-h="svelte-109aklx"><a class="heading-link" title="Permalink" aria-hidden="true" href="#internal-repository-benchmarking"><span>#</span></a>Internal Repository Benchmarking</h2> <p data-svelte-h="svelte-i7tg8m">As we explained in a previous article (”<a href="benchmarking-the-torrust-bittorrent-tracker">Benchmarking the Torrust BitTorrent Tracker</a>”) you can run the benchmark for those different repository implementations with the following command:</p> <div class="code-block svelte-11qxx87"> <div class="lang svelte-11qxx87">terminal</div> <button class="copy-button copy-button-gray svelte-11qxx87"></button> <div class="code-content"><pre class="language-terminal"><!-- HTML_TAG_START --><code class="language-terminal">cargo bench -p torrust-tracker-torrent-repository</code><!-- HTML_TAG_END --></pre></div></div> <p data-svelte-h="svelte-vsfz9m">The output at the time of writing this post is similar to:</p> <div class="code-block svelte-11qxx87"> <div class="lang svelte-11qxx87">terminal</div> <button class="copy-button copy-button-gray svelte-11qxx87"></button> <div class="code-content"><pre class="language-terminal"><!-- HTML_TAG_START --><code class="language-terminal">     Running benches/repository_benchmark.rs (target/release/deps/repository_benchmark-a9b0013c8d09c3c3)
add_one_torrent/RwLockStd
                        time:   [63.057 ns 63.242 ns 63.506 ns]
Found 12 outliers among 100 measurements (12.00%)
  2 (2.00%) low severe
  2 (2.00%) low mild
  2 (2.00%) high mild
  6 (6.00%) high severe
add_one_torrent/RwLockStdMutexStd
                        time:   [62.505 ns 63.077 ns 63.817 ns]
Found 11 outliers among 100 measurements (11.00%)
  4 (4.00%) high mild
  7 (7.00%) high severe
Benchmarking add_one_torrent/RwLockStdMutexTokio: Collecting 100 samples in estimated 1.0004 s (10M iterationsadd_one_torrent/RwLockStdMutexTokio
                        time:   [98.440 ns 98.551 ns 98.660 ns]
Found 4 outliers among 100 measurements (4.00%)
  3 (3.00%) low mild
  1 (1.00%) high severe
add_one_torrent/RwLockTokio
                        time:   [107.84 ns 108.18 ns 108.54 ns]
Found 3 outliers among 100 measurements (3.00%)
  2 (2.00%) low mild
  1 (1.00%) high mild
Benchmarking add_one_torrent/RwLockTokioMutexStd: Collecting 100 samples in estimated 1.0001 s (8.7M iterationadd_one_torrent/RwLockTokioMutexStd
                        time:   [116.34 ns 116.48 ns 116.63 ns]
Found 2 outliers among 100 measurements (2.00%)
  1 (1.00%) high mild
  1 (1.00%) high severe
Benchmarking add_one_torrent/RwLockTokioMutexTokio: Collecting 100 samples in estimated 1.0005 s (6.9M iteratiadd_one_torrent/RwLockTokioMutexTokio
                        time:   [143.39 ns 143.51 ns 143.63 ns]</code><!-- HTML_TAG_END --></pre></div></div> <h2 id="profiling-with-valgrind" data-svelte-h="svelte-dn87f4"><a class="heading-link" title="Permalink" aria-hidden="true" href="#profiling-with-valgrind"><span>#</span></a>Profiling With Valgrind</h2> <p data-svelte-h="svelte-u2mco7">“Valgrind is an instrumentation framework for building dynamic analysis tools”. In fact it’s a suite of tools. The tool we are going to use is <code>callgrind</code> which collects data that can be later visualized with <code>kcachegrind</code>.</p> <p data-svelte-h="svelte-15g0w3i">Valgrind, coupled with Kcachegrind, offers a powerful profiling solution for in-depth analysis of BitTorrent tracker performance. By simulating cache behavior and collecting call graphs, developers gain valuable insights into code execution dynamics and potential optimizations.</p> <p data-svelte-h="svelte-pwuqah">In order to profile the UDP tracker you need to:</p> <ol data-svelte-h="svelte-1juzoy5"><li>Build and run the tracker for profiling.</li> <li>Make requests to the tracker while it’s running.</li></ol> <p data-svelte-h="svelte-awnev1">Build and run the binary for profiling with:</p> <div class="code-block svelte-11qxx87"> <div class="lang svelte-11qxx87">console</div> <button class="copy-button copy-button-gray svelte-11qxx87"></button> <div class="code-content"><pre class="language-console"><!-- HTML_TAG_START --><code class="language-console">RUSTFLAGS=&#39;-g&#39; cargo build --release --bin profiling \
   &amp;&amp; export TORRUST_TRACKER_CONFIG_TOML_PATH=&quot;./share/default/config/tracker.udp.benchmarking.toml&quot; \
   &amp;&amp; valgrind \
     --tool=callgrind \
     --callgrind-out-file=callgrind.out \
     --collect-jumps=yes \
     --simulate-cache=yes \
     ./target/release/profiling 60</code><!-- HTML_TAG_END --></pre></div></div> <div class="callout-block info svelte-sxx0n0"><div class="icon-wrapper svelte-sxx0n0"><svg width="100%" height="100%" stroke-width="1.5" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 11.5V16.5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path d="M12 7.51L12.01 7.49889" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path d="M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path></svg></div> <p data-svelte-h="svelte-1h4ju63"><strong>NOTICE:</strong> You should make requests to the services you want to profile. For example, using the <a href="./benchmarking-the-torrust-bittorrent-tracker">Aquatic UDP load test</a>.</p></div> <p data-svelte-h="svelte-1hu7esm">After running the tracker with <code>valgrind</code> it generates a file called <code>callgrind.out</code>
that you can open with <code>kcachegrind</code>.</p> <div class="code-block svelte-11qxx87"> <div class="lang svelte-11qxx87">terminal</div> <button class="copy-button copy-button-gray svelte-11qxx87"></button> <div class="code-content"><pre class="language-terminal"><!-- HTML_TAG_START --><code class="language-terminal">kcachegrind callgrind.out</code><!-- HTML_TAG_END --></pre></div></div> <img srcset="/images/posts/profiling-the-torrust-bittorrent-udp-tracker/kcachegrind-screenshot.png, /images/posts/profiling-the-torrust-bittorrent-udp-tracker/kcachegrind-screenshot.png, /images/posts/profiling-the-torrust-bittorrent-udp-tracker/kcachegrind-screenshot.png" src="/images/posts/profiling-the-torrust-bittorrent-udp-tracker/kcachegrind-screenshot.png" alt="Visualizing profiling data with kcachegrind" loading="lazy" decoding="async" class="svelte-1ykl0dj"> <p data-svelte-h="svelte-mo72iu">You have information like:</p> <ul data-svelte-h="svelte-1bfh9pj"><li>How many times a function is called (<code>Called</code> column).</li> <li>The total amount of time spent running a function (<code>Incl.</code> column).</li> <li>The total amount of time spent running a function excluding child functions (<code>Self</code> column).</li> <li>Etcetera.</li></ul> <p data-svelte-h="svelte-1btcmym">But one of the most interesting things it’s the interactive “Call Graph” where you can navigate through functions seeing how much time they spend.</p> <p data-svelte-h="svelte-g7mp2l">The main problem with this tool is the asynchronous code. Functions executed in tokio spawned tasks are not shown directly. Since the Torrust Tracker makes an intense use of async code that makes it harder to reach conclusions from the tool.</p> <p data-svelte-h="svelte-ozqz56">There are alternatives that we have not tried yet:</p> <ol data-svelte-h="svelte-3noc7e"><li>Use other tools like <a href="https://github.com/tokio-rs/console" rel="nofollow">tokio-console</a>.</li> <li>Insert your custom profiling functions in the code.</li> <li>Isolate the sync parts and profile them independently. For example, you could profile only the Torrent Repository or the Tracker domain Service.</li></ol> <h2 id="profiling-with-perf" data-svelte-h="svelte-1ia110c"><a class="heading-link" title="Permalink" aria-hidden="true" href="#profiling-with-perf"><span>#</span></a>Profiling With Perf</h2> <p data-svelte-h="svelte-1kerjib">Another alternative for profiling are flamegraphs. There is a crate called <a href="https://github.com/flamegraph-rs/flamegraph" rel="nofollow">cargo flamegraph</a> that allows you to easily generate flamegraphs that you can visualize in a modern browser.</p> <p data-svelte-h="svelte-szcvma">Flamegraphs offer a visual representation of code execution, providing invaluable insights into performance bottlenecks within the tracker codebase. By utilizing flamegraph profiling, developers can pinpoint hotspots and inefficiencies, guiding optimization efforts for enhanced performance.</p> <p data-svelte-h="svelte-13l7fn0">After installing the <code>cargo flamegraph</code> package you can generate the flamegraph with:</p> <div class="code-block svelte-11qxx87"> <div class="lang svelte-11qxx87">terminal</div> <button class="copy-button copy-button-gray svelte-11qxx87"></button> <div class="code-content"><pre class="language-terminal"><!-- HTML_TAG_START --><code class="language-terminal">TORRUST_TRACKER_CONFIG_TOML_PATH=&quot;./share/default/config/tracker.udp.benchmarking.toml&quot; cargo flamegraph --bin=profiling -- 60</code><!-- HTML_TAG_END --></pre></div></div> <p data-svelte-h="svelte-9ydouq">Running the <code>cargo flamegraph</code> running the whole service produces a flamegraph like <a href="/images/posts/profiling-the-torrust-bittorrent-udp-tracker/flamegraph.svg">this</a>:</p> <p data-svelte-h="svelte-1p0e1xw"><img src="/images/posts/profiling-the-torrust-bittorrent-udp-tracker/flamegraph.svg" alt="Visualizing profiling data with flamegraphs"></p> <p data-svelte-h="svelte-18wll46"><a href="/images/posts/profiling-the-torrust-bittorrent-udp-tracker/flamegraph.svg">Click here to see the interactive flamegraph</a>.</p> <p data-svelte-h="svelte-1vu9p2n">As you can see, there are a lot functions for the tokio package but if you see at the top of the flame you will see the functions in the <code>torrust_tracker</code> namespace.</p> <h2 id="conclusion" data-svelte-h="svelte-br5ox0"><a class="heading-link" title="Permalink" aria-hidden="true" href="#conclusion"><span>#</span></a>Conclusion</h2> <p data-svelte-h="svelte-hfwgse">Although using these tools with async code can be very challenging at least you can use them to confirm if you are making an effort on improving the performance on the right place. And you can also detect parts very slow parts.</p> <p data-svelte-h="svelte-1bu58i0">And as you can see more than 90% of the time is spent on the <code>Tracker::announce</code> method in these two functions:</p> <ul data-svelte-h="svelte-1f8lnhz"><li><code>Tracker::update_torrent_with_peer_and_get_stats</code>.</li> <li><code>Tracker::get_torrent_peers_for_peer</code>.</li></ul> <p data-svelte-h="svelte-1gdfb2n">Which are the functions that need a lock to write and read in the <code>Torrent Repository</code>. Notice that it is the code we are focused on improving right now.</p> <p data-svelte-h="svelte-gxsd2p">If you see something wrong or you want to contribute by:</p> <ul data-svelte-h="svelte-1jpxkfh"><li>Adding new sections.</li> <li>Fixing typos.</li> <li>Making it clearer.</li> <li>Adding links.</li> <li>Or whatever you think that could be interesting to add,</li></ul> <p data-svelte-h="svelte-1cyks1i">please open an <a href="https://github.com/torrust/torrust-website/issues" rel="nofollow">issue</a> or a <a href="https://github.com/torrust/torrust-website/pulls" rel="nofollow">PR</a>.</p> <p data-svelte-h="svelte-jnq0pp">If you have any questions or issues please open an issue in the corresponding repository:</p> <ul data-svelte-h="svelte-psntnz"><li>Torrust Tracker: <a href="https://github.com/torrust/torrust-tracker/issues" rel="nofollow">https://github.com/torrust/torrust-tracker/issues</a></li> <li>Torrust Index: <a href="https://github.com/torrust/torrust-index/issues" rel="nofollow">https://github.com/torrust/torrust-index/issues</a></li> <li>Torrust Website: <a href="https://github.com/torrust/torrust-index-gui/issues" rel="nofollow">https://github.com/torrust/torrust-index-gui/issues</a></li> <li>Torrust Compose: <a href="https://github.com/torrust/torrust-compose" rel="nofollow">https://github.com/torrust/torrust-compose</a></li> <li>Containerizing Rust Applications Examples: <a href="https://github.com/torrust/containerizing-rust-apps-examples" rel="nofollow">https://github.com/torrust/containerizing-rust-apps-examples</a></li></ul> <p data-svelte-h="svelte-nld7t3">We very welcome any contributions to the projects or <a href="https://github.com/torrust/torrust-website/issues" rel="nofollow">this article</a>.</p> <h2 id="acknowledgments" data-svelte-h="svelte-1e4fcph"><a class="heading-link" title="Permalink" aria-hidden="true" href="#acknowledgments"><span>#</span></a>Acknowledgments</h2> <p data-svelte-h="svelte-1beqmgs">Many thanks to <a href="https://github.com/bravit" rel="nofollow">Vitaly Bragilevsky</a> and others for sharing the talks about profiling.</p> <h2 id="links" data-svelte-h="svelte-32dd6s"><a class="heading-link" title="Permalink" aria-hidden="true" href="#links"><span>#</span></a>Links</h2> <p data-svelte-h="svelte-s0ys1s">Torrust Tracker Documentation for:</p> <ul data-svelte-h="svelte-15ln9ws"><li><a href="https://github.com/torrust/torrust-tracker/blob/develop/docs/benchmarking.md" rel="nofollow">Benchmarking</a>.</li> <li><a href="https://github.com/torrust/torrust-tracker/blob/develop/docs/profiling.md" rel="nofollow">Profiling</a>.</li></ul> <p data-svelte-h="svelte-1hod1vn">Profiling tools:</p> <ul data-svelte-h="svelte-hjky6h"><li><a href="https://valgrind.org/" rel="nofollow">valgrind</a>.</li> <li><a href="https://kcachegrind.github.io/" rel="nofollow">kcachegrind</a>.</li> <li><a href="https://github.com/flamegraph-rs/flamegraph" rel="nofollow">flamegraph</a>.</li></ul> <p data-svelte-h="svelte-7bt0ya">Talks about profiling:</p> <ul data-svelte-h="svelte-ybsdk"><li><a href="https://www.youtube.com/watch?v=X6Xz4CRd6kw&amp;t=191s" rel="nofollow">Profiling Rust Programs with valgrind, heaptrack, and hyperfine</a>.</li> <li><a href="https://www.youtube.com/watch?v=8FAdY_0DpkM" rel="nofollow">RustConf 2023 - Profiling async applications in Rust by Vitaly Bragilevsky</a>.</li> <li><a href="https://www.youtube.com/watch?v=JRMOIE_wAFk&amp;t=8s" rel="nofollow">Profiling Code in Rust - by Vitaly Bragilevsky - Rust Linz, December 2022</a>.</li> <li><a href="https://www.youtube.com/watch?v=h-0HpCblt3A" rel="nofollow">Xdebug 3 Profiling: 2. KCachegrind tour</a>.</li></ul> <p data-svelte-h="svelte-160mg43">Concurrent hash table data structures:</p> <ul data-svelte-h="svelte-8ott72"><li><a href="https://docs.rs/dashmap/latest/dashmap/" rel="nofollow">DashMap</a>.</li> <li><a href="https://docs.rs/flurry/latest/flurry/" rel="nofollow">flurry</a>.</li></ul> <p data-svelte-h="svelte-1w1gd8o">Tools for profiling/debugging async code:</p> <ul data-svelte-h="svelte-1g3ycg"><li><a href="https://github.com/tokio-rs/console" rel="nofollow">tokio-console</a>.</li></ul></div></div>
          ]]></content:encoded>
          <media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://v2.torrust.com//images/posts/profiling-the-torrust-bittorrent-udp-tracker/profiling-the-torrust-bittorrent-udp-tracker.webp"/>
          <media:content xmlns:media="http://search.yahoo.com/mrss/" medium="image" url="https://v2.torrust.com//images/posts/profiling-the-torrust-bittorrent-udp-tracker/profiling-the-torrust-bittorrent-udp-tracker.webp"/>          
        </item>
      
        <item>
          <guid>https://v2.torrust.com/benchmarking-the-torrust-bittorrent-tracker</guid>
          <title>Benchmarking the Torrust BitTorrent Tracker</title>
          <description>In the ever-evolving landscape of BitTorrent technology, performance and scalability are paramount. Torrust stands at the forefront, offering a suite of open-source software products designed to enhance peer-to-peer file sharing. At the heart of this suite is the Torrust BitTorrent Tracker, a Rust-based engine crafted for efficiency and speed. This post will introduce you to the benchmarking tools we are using at the moment for the tracker.</description>
          <link>https://v2.torrust.com/benchmarking-the-torrust-bittorrent-tracker</link>
          <pubDate>19/03/2024 00:00:00</pubDate>
          <category>Performance</category><category>Benchmarking</category>
          <content:encoded><![CDATA[
            <div style="margin: 50px 0; font-style: italic;">
              If anything looks wrong, 
              <strong>
                <a href="https://v2.torrust.com/benchmarking-the-torrust-bittorrent-tracker">
                  read on the site!
                </a>
              </strong>
            </div>

             <div class="flex svelte-19d8qsr"> <div class=" svelte-13ebny9" style="position: relative;"><div class="svelte-13ebny9"><h2 id="table-of-contents" data-svelte-h="svelte-1m3njcc"><a class="heading-link" title="Permalink" aria-hidden="true" href="#table-of-contents"><span>#</span></a>Table of Contents</h2> <ul data-svelte-h="svelte-1eez8z8"><li><a href="#introduction">Introduction</a></li> <li><a href="#understating-the-tracker">Understating The Tracker</a></li> <li><a href="#benchmarking-methodology">Benchmarking Methodology</a></li> <li><a href="#internal-repository-benchmarking">Internal Repository Benchmarking</a></li> <li><a href="#e2e-udp-benchmarking">E2E UDP Benchmarking</a></li> <li><a href="#comparative-udp-benchmarking-with-other-trackers">Comparative UDP Benchmarking With Other Trackers</a><ul><li><a href="#setup-the-chihaya-tracker">Setup The Chihaya Tracker</a></li> <li><a href="#setup-the-opentracker-tracker">Setup The Opentracker Tracker</a></li> <li><a href="#setup-the-aquatic-tracker">Setup The Aquatic Tracker</a></li> <li><a href="#running-the-bencher">Running The Bencher</a></li> <li><a href="#bencher-results">Bencher Results</a></li></ul></li> <li><a href="#conclusion">Conclusion</a></li> <li><a href="#links">Links</a></li></ul></div></div> <div class="svelte-4jsat1"><h2 id="introduction" data-svelte-h="svelte-1ahwhrx"><a class="heading-link" title="Permalink" aria-hidden="true" href="#introduction"><span>#</span></a>Introduction</h2> <p data-svelte-h="svelte-m3c9hm">In the ever-evolving landscape of BitTorrent technology, performance and scalability are paramount. Torrust stands at the forefront, offering a suite of open-source software products designed to enhance peer-to-peer file sharing. At the heart of this suite is the <a href="https://github.com/torrust/torrust-tracker" rel="nofollow">Torrust BitTorrent Tracker</a>, a Rust-based engine crafted for efficiency and speed. This post will introduce you to the benchmarking tools we are using at the moment for the tracker. It will also shed light on its performance and how it stacks up against its contemporaries.</p> <p data-svelte-h="svelte-16u4lb6">Before going into details we should explain what are the tradeoffs we did on the design of the Torrust Tracker. Our goal is to design a robust, reliable and fast tracker but at the same time a feature-reach and sustainable one. Very often those two groups of objectives are exclusive. We know that being the fastest tracker implies some drawbacks. In general, our rule is:</p> <div class="callout-block info svelte-sxx0n0"><div class="icon-wrapper svelte-sxx0n0"><svg width="100%" height="100%" stroke-width="1.5" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 11.5V16.5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path d="M12 7.51L12.01 7.49889" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path d="M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path></svg></div> <p data-svelte-h="svelte-1xu4f3t">“Embracing a slight slowdown for substantial benefits underlines our commitment to delivering a tracker that’s not just fast but also rich in features and usability.”</p></div> <p data-svelte-h="svelte-eg2ndv">We decided to use Rust due to its speed and memory-safe features but we also wanted to build a tracker with the following features:</p> <ul data-svelte-h="svelte-1tc011q"><li>A <strong>comprehensive API</strong> that allow users to perform any action or extract any data from the tracker.</li> <li>A <strong>good support for observability</strong>. For example, a logging system that allow users to detect errors or extract statistics. The logging has several levels. Enabling more verbose logging affects performance. But if you are only interested in performance you can disable logging. Observability it’s also related to testing. Code without support for observability it’s usually hard to test too.</li> <li>A <strong>sustainable code</strong>. Very often “fast code” means “direct code” without abstraction layers and separation of concerns, but that leads to code that is hard to maintain and eventually to a death project. It’s hard to attract maintainers for open-source projects that are hard to understand. And even if it’s not hard to understand it’s usually hard to change because there are no independent parts that can be changed independently.</li></ul> <h2 id="understating-the-tracker" data-svelte-h="svelte-f7ma2w"><a class="heading-link" title="Permalink" aria-hidden="true" href="#understating-the-tracker"><span>#</span></a>Understating The Tracker</h2> <p data-svelte-h="svelte-1191qar">BitTorrent trackers play a crucial role in the file-sharing ecosystem, acting as intermediaries that facilitate the transfer of files among users. By tracking peer locations and helping them connect, these trackers ensure the swift and reliable distribution of data.</p> <p data-svelte-h="svelte-1kpnyqh">Before benchmarking the tracker is important to know the internal architecture of the tracker. A deep dive into the Torrust Tracker’s architecture reveals a four-layer design, crucial for benchmarking accuracy.</p> <p data-svelte-h="svelte-1om9x5k">The first layer is the delivery layer. Clients can connect to the tracker in different ways: using the HTTP tracker, the UDP tracker, the tracker API or console commands. Internally all requests are routed through application services and reaching the main tracker domain service that handles the <code>announce</code> and <code>scrape</code> requests. At the lowest level the tracker service stores all the information in different data structures. One of them is the torrent repository that holds the list of torrents. Each torrent entry on the list contains statistics like how many peers have downloaded the torrent and the list of peers for that torrent (swarm).</p> <img srcset="/images/posts/benchmarking-the-torrust-bittorrent-tracker/torrust-tracker-simplified-architecture.png, /images/posts/benchmarking-the-torrust-bittorrent-tracker/torrust-tracker-simplified-architecture.png, /images/posts/benchmarking-the-torrust-bittorrent-tracker/torrust-tracker-simplified-architecture.png" src="/images/posts/benchmarking-the-torrust-bittorrent-tracker/torrust-tracker-simplified-architecture.png" alt="Torrust Architecture" loading="lazy" decoding="async" class="svelte-1ykl0dj"> <h2 id="benchmarking-methodology" data-svelte-h="svelte-19pdx5j"><a class="heading-link" title="Permalink" aria-hidden="true" href="#benchmarking-methodology"><span>#</span></a>Benchmarking Methodology</h2> <p data-svelte-h="svelte-7t1gkt">Our benchmarking approach encompasses three pivotal areas:</p> <ul data-svelte-h="svelte-14l9hbs"><li><strong>Internal repository benchmarking</strong>: Evaluating the repository within the tracker responsible for managing peer lists across torrents.</li> <li><strong>End-to-End benchmarking</strong>: Utilizing an external UDP tracker load test tool from the aquatic repository to simulate some real-world scenarios.</li> <li><strong>Comparative Benchmarking with other trackers</strong>: Employing the “Bencher” from the Aquatic GitHub repository to compare the Torrust Tracker against notable implementations like <a href="https://erdgeist.org/arts/software/opentracker/" rel="nofollow">opentracker</a>, <a href="https://github.com/chihaya/chihaya" rel="nofollow">Chihaya</a>, and <a href="https://github.com/greatest-ape/aquatic" rel="nofollow">aquatic</a> itself.</li></ul> <h2 id="internal-repository-benchmarking" data-svelte-h="svelte-109aklx"><a class="heading-link" title="Permalink" aria-hidden="true" href="#internal-repository-benchmarking"><span>#</span></a>Internal Repository Benchmarking</h2> <p data-svelte-h="svelte-gryjgp">Basically a tracker is just a shared data structure between all the BitTorrent peers. Peers announce themselves and the tracker builds up a list of torrents. For each torrent, the tracker keeps a list of peers interested in that torrent. The in-memory data structure is an array of structures that look like this one (example in JSON):</p> <div class="code-block svelte-11qxx87"> <div class="lang svelte-11qxx87">json</div> <button class="copy-button copy-button-gray svelte-11qxx87"></button> <div class="code-content"><pre class="language-json"><!-- HTML_TAG_START --><code class="language-json"><span class="token punctuation">&#123;</span>
	<span class="token property">"info_hash"</span><span class="token operator">:</span> <span class="token string">"090c6d4fb3a03191c4ef1fda6236ef0efb2d5c10"</span><span class="token punctuation">,</span>
	<span class="token property">"seeders"</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
	<span class="token property">"completed"</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
	<span class="token property">"leechers"</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
	<span class="token property">"peers"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
		<span class="token punctuation">&#123;</span>
			<span class="token property">"peer_id"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
				<span class="token property">"id"</span><span class="token operator">:</span> <span class="token string">"0x2d71423030303030303030303030303030303031"</span><span class="token punctuation">,</span>
				<span class="token property">"client"</span><span class="token operator">:</span> <span class="token null keyword">null</span>
			<span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
			<span class="token property">"peer_addr"</span><span class="token operator">:</span> <span class="token string">"0.0.0.0:17548"</span><span class="token punctuation">,</span>
			<span class="token property">"updated"</span><span class="token operator">:</span> <span class="token number">1709916034742</span><span class="token punctuation">,</span>
			<span class="token property">"updated_milliseconds_ago"</span><span class="token operator">:</span> <span class="token number">1709916034742</span><span class="token punctuation">,</span>
			<span class="token property">"uploaded"</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
			<span class="token property">"downloaded"</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
			<span class="token property">"left"</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
			<span class="token property">"event"</span><span class="token operator">:</span> <span class="token string">"Completed"</span>
		<span class="token punctuation">&#125;</span>
	<span class="token punctuation">]</span>
<span class="token punctuation">&#125;</span></code><!-- HTML_TAG_END --></pre></div></div> <p data-svelte-h="svelte-1nuj2p7">There are many ways to keep this information in memory. The access to this data is actually a bottleneck. Eventually all requests hit this structure. The problem is all <code>announce</code> requests need to update this structure. Due to Rust owning rules, only the owner can write into this struct. We have been trying different implementations to minimize contention. There is a trait for the torrent “Repository”. You can benchmark the different repository implementations by running the following command:</p> <div class="code-block svelte-11qxx87"> <div class="lang svelte-11qxx87">terminal</div> <button class="copy-button copy-button-gray svelte-11qxx87"></button> <div class="code-content"><pre class="language-terminal"><!-- HTML_TAG_START --><code class="language-terminal">cargo run --release -p torrust-torrent-repository-benchmarks -- --threads 4 --sleep 0 --compare true</code><!-- HTML_TAG_END --></pre></div></div> <p data-svelte-h="svelte-176unt0">The output at the time of writing this post is:</p> <div class="code-block svelte-11qxx87"> <div class="lang svelte-11qxx87">terminal</div> <button class="copy-button copy-button-gray svelte-11qxx87"></button> <div class="code-content"><pre class="language-terminal"><!-- HTML_TAG_START --><code class="language-terminal">tokio::sync::RwLock&lt;std::collections::BTreeMap&lt;InfoHash, Entry&gt;&gt;
add_one_torrent: Avg/AdjAvg: (60ns, 59ns)
update_one_torrent_in_parallel: Avg/AdjAvg: (10.909457ms, 0ns)
add_multiple_torrents_in_parallel: Avg/AdjAvg: (13.88879ms, 0ns)
update_multiple_torrents_in_parallel: Avg/AdjAvg: (7.772484ms, 7.782535ms)

std::sync::RwLock&lt;std::collections::BTreeMap&lt;InfoHash, Entry&gt;&gt;
add_one_torrent: Avg/AdjAvg: (43ns, 39ns)
update_one_torrent_in_parallel: Avg/AdjAvg: (4.020937ms, 4.020937ms)
add_multiple_torrents_in_parallel: Avg/AdjAvg: (5.896177ms, 5.768448ms)
update_multiple_torrents_in_parallel: Avg/AdjAvg: (3.883823ms, 3.883823ms)

std::sync::RwLock&lt;std::collections::BTreeMap&lt;InfoHash, Arc&lt;std::sync::Mutex&lt;Entry&gt;&gt;&gt;&gt;
add_one_torrent: Avg/AdjAvg: (51ns, 49ns)
update_one_torrent_in_parallel: Avg/AdjAvg: (3.252314ms, 3.149109ms)
add_multiple_torrents_in_parallel: Avg/AdjAvg: (8.411094ms, 8.411094ms)
update_multiple_torrents_in_parallel: Avg/AdjAvg: (4.106086ms, 4.106086ms)

tokio::sync::RwLock&lt;std::collections::BTreeMap&lt;InfoHash, Arc&lt;std::sync::Mutex&lt;Entry&gt;&gt;&gt;&gt;
add_one_torrent: Avg/AdjAvg: (91ns, 90ns)
update_one_torrent_in_parallel: Avg/AdjAvg: (3.542378ms, 3.435695ms)
add_multiple_torrents_in_parallel: Avg/AdjAvg: (15.651172ms, 15.651172ms)
update_multiple_torrents_in_parallel: Avg/AdjAvg: (4.368189ms, 4.257572ms)

tokio::sync::RwLock&lt;std::collections::BTreeMap&lt;InfoHash, Arc&lt;tokio::sync::Mutex&lt;Entry&gt;&gt;&gt;&gt;
add_one_torrent: Avg/AdjAvg: (111ns, 109ns)
update_one_torrent_in_parallel: Avg/AdjAvg: (6.590677ms, 6.808535ms)
add_multiple_torrents_in_parallel: Avg/AdjAvg: (16.572217ms, 16.30488ms)
update_multiple_torrents_in_parallel: Avg/AdjAvg: (4.073221ms, 4.000122ms)</code><!-- HTML_TAG_END --></pre></div></div> <p data-svelte-h="svelte-l982n6">We are benchmarking four scenarios that we think are the most relevant:</p> <ul data-svelte-h="svelte-1y5y1bo"><li><strong>Adding one torrent</strong>: How long it takes to add a new torrent to the tracker when there is only one peer. We run it several times sequentially to calculate the average.</li> <li><strong>Update one torrent in parallel</strong>: This is the same as the previous one but running updates in parallel, meaning we spawn some threads to make the same request. This case tries to simulate the case where multiple peers try to announce the same torrent, so they are competing to write on the same repository entry, which contains the peer list.</li> <li><strong>Add multiple torrents in parallel</strong>: In this case, the same peer is adding different torrents at the same time. This case tries to simulate many peers announcing different torrents, so they are not conflicting to access the same peer list.</li> <li><strong>Update multiple torrents in parallel</strong>: Finally, this case is the same as the previous one, but we prefill the repository with all the torrents. This tries to simulate an scenario where multiple peers are announcing multiple torrents but the torrent entries already exists. The main different in this case is that the application might not need to allocate more memory to increase the data structure. So the problem is reduced to contention or locking (how many writes we can do in parallel on the same peer list).</li></ul> <p data-svelte-h="svelte-1d8sz3c">At the moment we are trying with other data structures that allow concurrent updates like <a href="https://docs.rs/dashmap/latest/dashmap/" rel="nofollow">DashMap</a>. See <a href="https://github.com/torrust/torrust-tracker/issues/565" rel="nofollow">https://github.com/torrust/torrust-tracker/issues/565</a>.</p> <h2 id="e2e-udp-benchmarking" data-svelte-h="svelte-f8fokv"><a class="heading-link" title="Permalink" aria-hidden="true" href="#e2e-udp-benchmarking"><span>#</span></a>E2E UDP Benchmarking</h2> <p data-svelte-h="svelte-1s5piv7">We have been using one of the aquatic packages to test the UDP tracker performance as a whole service.</p> <p data-svelte-h="svelte-1pgm7n2"><a href="https://github.com/greatest-ape/aquatic" rel="nofollow">Aquatic</a> is a high-performance open BitTorrent tracker including a lot a packages. One of the tools provided by Aquatic is a UDP load test command.</p> <p data-svelte-h="svelte-eez38i">In order to test the Torrust Tracker with the “UDP load test” tool you need to run both the tracker and this tester.</p> <h3 id="running-the-torrust-tracker" data-svelte-h="svelte-1tmvw9e"><a class="heading-link" title="Permalink" aria-hidden="true" href="#running-the-torrust-tracker"><span>#</span></a>Running the Torrust Tracker</h3> <p data-svelte-h="svelte-583jw8">You can follow the <a href="https://docs.rs/torrust-tracker" rel="nofollow">Torrust Tracker documentation</a> to install the tracker but there is an especial configuration for benchmarking. First at all, you should build the tracker for release (<code>--release</code>) and you should also disable all services. Finally you should set the logging level to <code>error</code>.</p> <div class="callout-block info svelte-sxx0n0"><div class="icon-wrapper svelte-sxx0n0"><svg width="100%" height="100%" stroke-width="1.5" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 11.5V16.5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path d="M12 7.51L12.01 7.49889" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path d="M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path></svg></div> <p data-svelte-h="svelte-dwdsm1">Logging levels are: <code>Off</code>, <code>Error</code>, <code>Warn</code>, <code>Info</code>, <code>Debug</code> and <code>Trace</code>. The more you increase the log level and the verbosity the worse the performance results are.</p></div> <p data-svelte-h="svelte-18gtvwc">We provide a especial configuration for benchmarking <code>./share/default/config/tracker.udp.benchmarking.toml</code> with the best configuration to test the performance of the UDP tracker. After cloning the tracker repo you can build and run it with:</p> <div class="code-block svelte-11qxx87"> <div class="lang svelte-11qxx87">terminal</div> <button class="copy-button copy-button-gray svelte-11qxx87"></button> <div class="code-content"><pre class="language-terminal"><!-- HTML_TAG_START --><code class="language-terminal">cargo build --release
TORRUST_TRACKER_PATH_CONFIG=&quot;./share/default/config/tracker.udp.benchmarking.toml&quot; ./target/release/torrust-tracker</code><!-- HTML_TAG_END --></pre></div></div> <h3 id="running-the-aquatic-udp-load-test" data-svelte-h="svelte-1xrliam"><a class="heading-link" title="Permalink" aria-hidden="true" href="#running-the-aquatic-udp-load-test"><span>#</span></a>Running The Aquatic UDP Load Test</h3> <p data-svelte-h="svelte-eoqm0k">For updated instructions about how to setup the tool please follow the <a href="https://github.com/greatest-ape/aquatic/tree/master/crates/" rel="nofollow">official documentation</a>.</p> <div class="code-block svelte-11qxx87"> <div class="lang svelte-11qxx87">terminal</div> <button class="copy-button copy-button-gray svelte-11qxx87"></button> <div class="code-content"><pre class="language-terminal"><!-- HTML_TAG_START --><code class="language-terminal">cd /tmp
git clone git@github.com:greatest-ape/aquatic.git
cd aquatic
cargo build --release -p aquatic_udp_load_test
./target/release/aquatic_udp_load_test -p &gt; &quot;load-test-config.toml&quot;</code><!-- HTML_TAG_END --></pre></div></div> <p data-svelte-h="svelte-1s28mzo">The last line <code>./target/release/aquatic_udp_load_test -p &gt; &quot;load-test-config.toml&quot;</code> generates a config file. At least you will need to change the UDP port from <code>3000</code> to <code>6969</code> which is the default one in the Torrust Tracker. You can also edit other options like how many requests of each type you want to make.</p> <p data-svelte-h="svelte-zm5uqe">Edit the <code>load-test-config.toml</code>:</p> <div class="code-block svelte-11qxx87"> <div class="lang svelte-11qxx87">terminal</div> <button class="copy-button copy-button-gray svelte-11qxx87"></button> <div class="code-content"><pre class="language-toml"><!-- HTML_TAG_START --><code class="language-toml"><span class="token comment"># ...</span>
<span class="token key property">server_address</span> <span class="token punctuation">=</span> <span class="token string">"127.0.0.1:6969"</span>
<span class="token comment"># ...</span>
<span class="token comment"># Probability that a generated request is a connect request as part</span>
<span class="token comment"># of sum of the various weight arguments.</span>
<span class="token key property">weight_connect</span> <span class="token punctuation">=</span> <span class="token number">50</span>
<span class="token comment"># Probability that a generated request is a announce request, as part</span>
<span class="token comment"># of sum of the various weight arguments.</span>
<span class="token key property">weight_announce</span> <span class="token punctuation">=</span> <span class="token number">50</span>
<span class="token comment"># Probability that a generated request is a scrape request, as part</span>
<span class="token comment"># of sum of the various weight arguments.</span>
<span class="token key property">weight_scrape</span> <span class="token punctuation">=</span> <span class="token number">1</span>
<span class="token comment"># ...</span></code><!-- HTML_TAG_END --></pre></div></div> <p data-svelte-h="svelte-v0q6o6">Finally you can run the test with:</p> <div class="code-block svelte-11qxx87"> <div class="lang svelte-11qxx87">toml</div> <button class="copy-button copy-button-gray svelte-11qxx87"></button> <div class="code-content"><pre class="language-toml"><!-- HTML_TAG_START --><code class="language-toml"><span class="token punctuation">.</span>/target/release/aquatic_udp_load_test -c <span class="token string">"load-test-config.toml"</span></code><!-- HTML_TAG_END --></pre></div></div> <h3 id="test-results" data-svelte-h="svelte-h1mmer"><a class="heading-link" title="Permalink" aria-hidden="true" href="#test-results"><span>#</span></a>Test Results</h3> <p data-svelte-h="svelte-ctfkij">Just as an example we show the test results with a non dedicated machine.</p> <p data-svelte-h="svelte-uwio4l"><strong>Machine used for the test</strong>:</p> <ul data-svelte-h="svelte-1t4jvex"><li>RAM: 64GiB</li> <li>Processor: AMD Ryzen 9 7950X x 32</li> <li>Graphics: AMD Radeon Graphics / Intel Arc A770 Graphics (DG2)</li> <li>OS: Ubuntu 23.04</li> <li>OS Type: 64-bit</li> <li>Kernel Version: Linux 6.2.0-20-generic</li></ul> <p data-svelte-h="svelte-wegm7a"><strong>Test result</strong>:</p> <div class="code-block svelte-11qxx87"> <div class="lang svelte-11qxx87">terminal</div> <button class="copy-button copy-button-gray svelte-11qxx87"></button> <div class="code-content"><pre class="language-terminal"><!-- HTML_TAG_START --><code class="language-terminal">Requests out: 388702.94/second
Responses in: 349832.25/second
  - Connect responses:  173325.85
  - Announce responses: 173061.13
  - Scrape responses:   3445.27
  - Error responses:    0.00
Peers per announce response: 0.00
Announce responses per info hash:
  - p10: 1
  - p25: 1
  - p50: 1
  - p75: 1
  - p90: 2
  - p95: 3
  - p99: 106
  - p99.9: 283
  - p100: 357</code><!-- HTML_TAG_END --></pre></div></div> <h2 id="comparative-udp-benchmarking-with-other-trackers" data-svelte-h="svelte-4irimp"><a class="heading-link" title="Permalink" aria-hidden="true" href="#comparative-udp-benchmarking-with-other-trackers"><span>#</span></a>Comparative UDP Benchmarking With Other Trackers</h2> <p data-svelte-h="svelte-1eavs55">Aquatic also provides a tool to compare how several trackers perform on the same machine. At the moment they support these tracker:</p> <ul data-svelte-h="svelte-13yj5oq"><li><a href="https://erdgeist.org/arts/software/opentracker/" rel="nofollow">opentracker</a>.</li> <li><a href="https://github.com/chihaya/chihaya" rel="nofollow">Chihaya</a>.</li> <li><a href="https://github.com/greatest-ape/aquatic" rel="nofollow">aquatic</a>.</li></ul> <p data-svelte-h="svelte-ir9hy0">We’ve opened a <a href="https://github.com/greatest-ape/aquatic/pull/191" rel="nofollow">PR</a> to add support to the Torrust Tracker too.</p> <p data-svelte-h="svelte-160ca0h">In order to run the Bencher you need to install all the trackers first.</p> <h3 id="setup-the-chihaya-tracker" data-svelte-h="svelte-182q49k"><a class="heading-link" title="Permalink" aria-hidden="true" href="#setup-the-chihaya-tracker"><span>#</span></a>Setup The Chihaya Tracker</h3> <p data-svelte-h="svelte-ol1vec">Follow the <a href="https://github.com/chihaya/chihaya" rel="nofollow">official documentation</a>. You will need to install Go:</p> <div class="code-block svelte-11qxx87"> <div class="lang svelte-11qxx87">terminal</div> <button class="copy-button copy-button-gray svelte-11qxx87"></button> <div class="code-content"><pre class="language-terminal"><!-- HTML_TAG_START --><code class="language-terminal">sudo apt install golang-go</code><!-- HTML_TAG_END --></pre></div></div> <h3 id="setup-the-opentracker-tracker" data-svelte-h="svelte-15xxb3d"><a class="heading-link" title="Permalink" aria-hidden="true" href="#setup-the-opentracker-tracker"><span>#</span></a>Setup The Opentracker Tracker</h3> <p data-svelte-h="svelte-17kavr">You can <code>make</code> it from sources following the <a href="https://erdgeist.org/arts/software/opentracker/#toc-entry-3" rel="nofollow">official documentation</a> or install it on Ubuntu with:</p> <div class="code-block svelte-11qxx87"> <div class="lang svelte-11qxx87">terminal</div> <button class="copy-button copy-button-gray svelte-11qxx87"></button> <div class="code-content"><pre class="language-terminal"><!-- HTML_TAG_START --><code class="language-terminal">cd /tmp
cvs -d :pserver:cvs@cvs.fefe.de:/cvs -z9 co libowfat
cd libowfat
make
cd ..
git clone git://erdgeist.org/opentracker
cd opentracker
make
cp opentracker ~/bin
opentracker -h</code><!-- HTML_TAG_END --></pre></div></div> <div class="callout-block info svelte-sxx0n0"><div class="icon-wrapper svelte-sxx0n0"><svg width="100%" height="100%" stroke-width="1.5" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 11.5V16.5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path d="M12 7.51L12.01 7.49889" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path d="M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path></svg></div> <p data-svelte-h="svelte-1l9k0r8">NOTICE: Installing the opentracker from Ubuntu repositories did not work for us. Maybe arguments to run the application have changes in recent versions.</p></div> <h3 id="setup-the-aquatic-tracker" data-svelte-h="svelte-xt6m5d"><a class="heading-link" title="Permalink" aria-hidden="true" href="#setup-the-aquatic-tracker"><span>#</span></a>Setup The Aquatic Tracker</h3> <p data-svelte-h="svelte-1tyolfd">You can follow the <a href="https://github.com/greatest-ape/aquatic/tree/master/crates/udp" rel="nofollow">official documentation</a>. At the moment this is the process:</p> <div class="code-block svelte-11qxx87"> <div class="lang svelte-11qxx87">terminal</div> <button class="copy-button copy-button-gray svelte-11qxx87"></button> <div class="code-content"><pre class="language-terminal"><!-- HTML_TAG_START --><code class="language-terminal">sudo apt update &amp;&amp; sudo apt upgrade -y
sudo apt-get install libhwloc-dev
cd /tmp
git clone git@github.com:greatest-ape/aquatic.git
cd aquatic
cargo build --profile=release-debug --all-features -p aquatic_udp</code><!-- HTML_TAG_END --></pre></div></div> <div class="callout-block info svelte-sxx0n0"><div class="icon-wrapper svelte-sxx0n0"><svg width="100%" height="100%" stroke-width="1.5" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 11.5V16.5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path d="M12 7.51L12.01 7.49889" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path d="M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path></svg></div> <p data-svelte-h="svelte-1nn93ne">NOTICE: <code>libhwloc-dev</code> is needed for <code>io-uring</code> feature.</p></div> <h3 id="running-the-bencher" data-svelte-h="svelte-hnytli"><a class="heading-link" title="Permalink" aria-hidden="true" href="#running-the-bencher"><span>#</span></a>Running The Bencher</h3> <p data-svelte-h="svelte-269m44">You don’t need to run the trackers manually the Bencher does it. First you need to build the Bencher:</p> <div class="code-block svelte-11qxx87"> <div class="lang svelte-11qxx87">terminal</div> <button class="copy-button copy-button-gray svelte-11qxx87"></button> <div class="code-content"><pre class="language-terminal"><!-- HTML_TAG_START --><code class="language-terminal">cd /tmp
git clone git@github.com:greatest-ape/aquatic.git
cd aquatic
cargo build --profile=release-debug -p aquatic_bencher</code><!-- HTML_TAG_END --></pre></div></div> <p data-svelte-h="svelte-1x6qv3">And then you can run it with:</p> <div class="code-block svelte-11qxx87"> <div class="lang svelte-11qxx87">terminal</div> <button class="copy-button copy-button-gray svelte-11qxx87"></button> <div class="code-content"><pre class="language-terminal"><!-- HTML_TAG_START --><code class="language-terminal">./target/release-debug/aquatic_bencher udp</code><!-- HTML_TAG_END --></pre></div></div> <div class="callout-block info svelte-sxx0n0"><div class="icon-wrapper svelte-sxx0n0"><svg width="100%" height="100%" stroke-width="1.5" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 11.5V16.5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path d="M12 7.51L12.01 7.49889" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path d="M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path></svg></div> <p data-svelte-h="svelte-1oe9wpg">If you also want to include the Torrust Tracker make sure you use the fork in the <a href="https://github.com/greatest-ape/aquatic/pull/191" rel="nofollow">PR</a>.</p></div> <h3 id="bencher-results" data-svelte-h="svelte-1hc99h6"><a class="heading-link" title="Permalink" aria-hidden="true" href="#bencher-results"><span>#</span></a>Bencher Results</h3> <p data-svelte-h="svelte-1lfvggd">Again, this is only an example with the test result using a non dedicated machine.</p> <p data-svelte-h="svelte-16heg8s">Machine used for the test:</p> <ul data-svelte-h="svelte-1t4jvex"><li>RAM: 64GiB</li> <li>Processor: AMD Ryzen 9 7950X x 32</li> <li>Graphics: AMD Radeon Graphics / Intel Arc A770 Graphics (DG2)</li> <li>OS: Ubuntu 23.04</li> <li>OS Type: 64-bit</li> <li>Kernel Version: Linux 6.2.0-20-generic</li></ul> <p data-svelte-h="svelte-uh73g0">Bencher result:</p> <div class="code-block svelte-11qxx87"> <div class="lang svelte-11qxx87">terminal</div> <button class="copy-button copy-button-gray svelte-11qxx87"></button> <div class="code-content"><pre class="language-terminal"><!-- HTML_TAG_START --><code class="language-terminal"># Benchmark report

Total number of load test runs: 72
Estimated duration: 0 hours, 44 minutes

## Tracker cores: 1 (cpus: 0,16)
### aquatic_udp run (socket workers: 1) (load test workers: 8, cpus: 8-15,24-31)
- Average responses per second: 351,834
- Average tracker CPU utilization: 95.5%
- Peak tracker RSS: 192.5 MiB
### aquatic_udp run (socket workers: 1) (load test workers: 12, cpus: 4-15,20-31)
- Average responses per second: 372,991
- Average tracker CPU utilization: 95.5%
- Peak tracker RSS: 191.9 MiB
### aquatic_udp (io_uring) run (socket workers: 1) (load test workers: 8, cpus: 8-15,24-31)
- Average responses per second: 389,576
- Average tracker CPU utilization: 95.5%
- Peak tracker RSS: 214 MiB
### aquatic_udp (io_uring) run (socket workers: 1) (load test workers: 12, cpus: 4-15,20-31)
- Average responses per second: 409,824
- Average tracker CPU utilization: 95.5%
- Peak tracker RSS: 214.7 MiB
### opentracker run (workers: 0) (load test workers: 8, cpus: 8-15,24-31)
- Average responses per second: 297,698
- Average tracker CPU utilization: 95.5%
- Peak tracker RSS: 71.7 MiB
### opentracker run (workers: 0) (load test workers: 12, cpus: 4-15,20-31)
- Average responses per second: 307,874
- Average tracker CPU utilization: 95.5%
- Peak tracker RSS: 72 MiB
### opentracker run (workers: 1) (load test workers: 8, cpus: 8-15,24-31)
- Average responses per second: 343,570
- Average tracker CPU utilization: 95.4%
- Peak tracker RSS: 72 MiB
### opentracker run (workers: 1) (load test workers: 12, cpus: 4-15,20-31)
- Average responses per second: 378,880
- Average tracker CPU utilization: 95.3%
- Peak tracker RSS: 72.2 MiB
### chihaya run () (load test workers: 8, cpus: 8-15,24-31)
- Average responses per second: 115,159
- Average tracker CPU utilization: 190%
- Peak tracker RSS: 863.4 MiB
### chihaya run () (load test workers: 12, cpus: 4-15,20-31)
- Average responses per second: 113,002
- Average tracker CPU utilization: 190%
- Peak tracker RSS: 867.4 MiB
### torrust-tracker run () (load test workers: 8, cpus: 8-15,24-31)
- Average responses per second: 222,330
- Average tracker CPU utilization: 189%
- Peak tracker RSS: 193.3 MiB
### torrust-tracker run () (load test workers: 12, cpus: 4-15,20-31)
- Average responses per second: 216,407
- Average tracker CPU utilization: 189%
- Peak tracker RSS: 191.8 MiB
## Tracker cores: 2 (cpus: 0-1,16-17)
### aquatic_udp run (socket workers: 2) (load test workers: 8, cpus: 8-15,24-31)
- Average responses per second: 699,783
- Average tracker CPU utilization: 191%
- Peak tracker RSS: 195.6 MiB
### aquatic_udp run (socket workers: 2) (load test workers: 12, cpus: 4-15,20-31)
- Average responses per second: 804,774
- Average tracker CPU utilization: 191%
- Peak tracker RSS: 193.9 MiB
### aquatic_udp (io_uring) run (socket workers: 2) (load test workers: 8, cpus: 8-15,24-31)
- Average responses per second: 749,745
- Average tracker CPU utilization: 190%
- Peak tracker RSS: 237.4 MiB
### aquatic_udp (io_uring) run (socket workers: 2) (load test workers: 12, cpus: 4-15,20-31)
- Average responses per second: 797,605
- Average tracker CPU utilization: 190%
- Peak tracker RSS: 239 MiB
### opentracker run (workers: 2) (load test workers: 8, cpus: 8-15,24-31)
- Average responses per second: 692,167
- Average tracker CPU utilization: 190%
- Peak tracker RSS: 71.5 MiB
### opentracker run (workers: 2) (load test workers: 12, cpus: 4-15,20-31)
- Average responses per second: 780,108
- Average tracker CPU utilization: 190%
- Peak tracker RSS: 72 MiB
### chihaya run () (load test workers: 8, cpus: 8-15,24-31)
- Average responses per second: 185,137
- Average tracker CPU utilization: 371%
- Peak tracker RSS: 8.2 GiB
### chihaya run () (load test workers: 12, cpus: 4-15,20-31)
- Average responses per second: 186,243
- Average tracker CPU utilization: 380%
- Peak tracker RSS: 7.1 GiB
### torrust-tracker run () (load test workers: 8, cpus: 8-15,24-31)
- Average responses per second: 415,864
- Average tracker CPU utilization: 374%
- Peak tracker RSS: 188.4 MiB
### torrust-tracker run () (load test workers: 12, cpus: 4-15,20-31)
- Average responses per second: 407,551
- Average tracker CPU utilization: 375%
- Peak tracker RSS: 188.9 MiB
## Tracker cores: 4 (cpus: 0-3,16-19)
### aquatic_udp run (socket workers: 4) (load test workers: 8, cpus: 8-15,24-31)
- Average responses per second: 1,270,832
- Average tracker CPU utilization: 369%
- Peak tracker RSS: 194.9 MiB
### aquatic_udp run (socket workers: 4) (load test workers: 12, cpus: 4-15,20-31)
- Average responses per second: 1,482,250
- Average tracker CPU utilization: 382%
- Peak tracker RSS: 194.9 MiB
### aquatic_udp (io_uring) run (socket workers: 4) (load test workers: 8, cpus: 8-15,24-31)
- Average responses per second: 1,217,457
- Average tracker CPU utilization: 354%
- Peak tracker RSS: 237.9 MiB
### aquatic_udp (io_uring) run (socket workers: 4) (load test workers: 12, cpus: 4-15,20-31)
- Average responses per second: 1,618,228
- Average tracker CPU utilization: 381%
- Peak tracker RSS: 284.3 MiB
### opentracker run (workers: 4) (load test workers: 8, cpus: 8-15,24-31)
- Average responses per second: 1,348,825
- Average tracker CPU utilization: 381%
- Peak tracker RSS: 71.5 MiB
### opentracker run (workers: 4) (load test workers: 12, cpus: 4-15,20-31)
- Average responses per second: 1,546,907
- Average tracker CPU utilization: 381%
- Peak tracker RSS: 71 MiB
### chihaya run () (load test workers: 8, cpus: 8-15,24-31)
...</code><!-- HTML_TAG_END --></pre></div></div> <div class="callout-block info svelte-sxx0n0"><div class="icon-wrapper svelte-sxx0n0"><svg width="100%" height="100%" stroke-width="1.5" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 11.5V16.5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path d="M12 7.51L12.01 7.49889" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path d="M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path></svg></div> <p data-svelte-h="svelte-c72574"><strong>IMPORTANT</strong>: The test was run is a non dedicated machine running other tasks. It’s just an example. You can get the latest results with dedicated machine on the <a href="https://github.com/greatest-ape/aquatic" rel="nofollow">Aquatic</a> repo.</p></div> <p data-svelte-h="svelte-1sz0tx0">The extracted and ordered results for 1 core are:</p> <p data-svelte-h="svelte-145cgs5">Average responses per second with 8 load test workers and cpus: 8-15,24-31</p> <ol data-svelte-h="svelte-aj8gko"><li><strong>389,576</strong> aquatic (io_uring)</li> <li><strong>351,834</strong> aquatic</li> <li><strong>343,570</strong> opentracker (workers 1)</li> <li><strong>297,698</strong> opentracker (workers 0)</li> <li><strong>222,330</strong> torrust-tracker</li> <li><strong>115,159</strong> chihaya</li></ol> <p data-svelte-h="svelte-vf59nm">Average responses per second with 12 load test workers and cpus: 4-15,20-31</p> <ol data-svelte-h="svelte-104eset"><li><strong>409,824</strong> aquatic (io_uring)</li> <li><strong>378,880</strong> opentracker (workers 1)</li> <li><strong>372,991</strong> aquatic</li> <li><strong>307,874</strong> opentracker (workers 0)</li> <li><strong>216,407</strong> torrust-tracker</li> <li><strong>113,002</strong> chihaya</li></ol> <p data-svelte-h="svelte-1bra9f5">The <a href="https://github.com/greatest-ape/aquatic/blob/master/documents/aquatic-udp-load-test-2024-02-10.md" rel="nofollow">latest official results</a> (2024-02-10):</p> <img srcset="/images/posts/benchmarking-the-torrust-bittorrent-tracker/aquatic-bencher-average-responses-per-second.png, /images/posts/benchmarking-the-torrust-bittorrent-tracker/aquatic-bencher-average-responses-per-second.png, /images/posts/benchmarking-the-torrust-bittorrent-tracker/aquatic-bencher-average-responses-per-second.png" src="/images/posts/benchmarking-the-torrust-bittorrent-tracker/aquatic-bencher-average-responses-per-second.png" alt="Torrust Architecture" loading="lazy" decoding="async" class="svelte-1ykl0dj"> <div class="callout-block info svelte-sxx0n0"><div class="icon-wrapper svelte-sxx0n0"><svg width="100%" height="100%" stroke-width="1.5" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 11.5V16.5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path d="M12 7.51L12.01 7.49889" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path d="M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path></svg></div> <p data-svelte-h="svelte-jo5kpe">The Aquatic “Bencher” uses the Aquatic “UDP load test”.</p></div> <h2 id="conclusion" data-svelte-h="svelte-br5ox0"><a class="heading-link" title="Permalink" aria-hidden="true" href="#conclusion"><span>#</span></a>Conclusion</h2> <p data-svelte-h="svelte-18l64hv">As you have seen we are collecting metrics to improve the tracker and avoid performance regressions, by using these benchmarking tools provided by Aquatic. Although performance is important there are other factor like horizontal scalability that are even more critical because sooner or later no matter how powerful is your machine it will be not enough the handle all the requests. But that is our of the scope of this article.</p> <p data-svelte-h="svelte-no19bn">On the other hand, we have analyzed performance only from the point of view of number of request handled per second. Memory consumption should be also considered. We have started instrumenting the application to track memory consumption. See <a href="https://github.com/torrust/torrust-tracker/issues/567" rel="nofollow">https://github.com/torrust/torrust-tracker/issues/567</a>.</p> <p data-svelte-h="svelte-gxsd2p">If you see something wrong or you want to contribute by:</p> <ul data-svelte-h="svelte-1pxkwtk"><li>Adding new sections.</li> <li>Fixing typos.</li> <li>Making it clearer.</li> <li>Adding links.</li> <li>Or whatever you think that could be interesting to have,</li></ul> <p data-svelte-h="svelte-1cyks1i">please open an <a href="https://github.com/torrust/torrust-website/issues" rel="nofollow">issue</a> or a <a href="https://github.com/torrust/torrust-website/pulls" rel="nofollow">PR</a>.</p> <p data-svelte-h="svelte-jnq0pp">If you have any questions or issues please open an issue in the corresponding repository:</p> <ul data-svelte-h="svelte-psntnz"><li>Torrust Tracker: <a href="https://github.com/torrust/torrust-tracker/issues" rel="nofollow">https://github.com/torrust/torrust-tracker/issues</a></li> <li>Torrust Index: <a href="https://github.com/torrust/torrust-index/issues" rel="nofollow">https://github.com/torrust/torrust-index/issues</a></li> <li>Torrust Website: <a href="https://github.com/torrust/torrust-index-gui/issues" rel="nofollow">https://github.com/torrust/torrust-index-gui/issues</a></li> <li>Torrust Compose: <a href="https://github.com/torrust/torrust-compose" rel="nofollow">https://github.com/torrust/torrust-compose</a></li> <li>Containerizing Rust Applications Examples: <a href="https://github.com/torrust/containerizing-rust-apps-examples" rel="nofollow">https://github.com/torrust/containerizing-rust-apps-examples</a></li></ul> <p data-svelte-h="svelte-nld7t3">We very welcome any contributions to the projects or <a href="https://github.com/torrust/torrust-website/issues" rel="nofollow">this article</a>.</p> <h2 id="links" data-svelte-h="svelte-32dd6s"><a class="heading-link" title="Permalink" aria-hidden="true" href="#links"><span>#</span></a>Links</h2> <p data-svelte-h="svelte-q8fjkb">Other trackers:</p> <ul data-svelte-h="svelte-1jgk2dy"><li><a href="https://github.com/chihaya/chihaya" rel="nofollow">Chihaya</a>.</li> <li><a href="https://erdgeist.org/arts/software/opentracker/" rel="nofollow">opentracker</a>.</li> <li><a href="https://github.com/greatest-ape/aquatic" rel="nofollow">aquatic</a>.</li></ul> <p data-svelte-h="svelte-f37z12">Crates for concurrent writes:</p> <ul data-svelte-h="svelte-1yvyf58"><li><a href="https://docs.rs/dashmap/latest/dashmap/" rel="nofollow">DashMap</a>.</li></ul> <p data-svelte-h="svelte-uqycu9">Other links:</p> <ul data-svelte-h="svelte-1ig97l4"><li><a href="https://github.com/torrust/torrust-tracker/blob/develop/docs/benchmarking.md" rel="nofollow">Torrust Tracker Benchmarking Docs</a>.</li> <li><a href="https://github.com/greatest-ape/aquatic/tree/master/crates/udp_load_test" rel="nofollow">Aquatic UDP load test tool</a>.</li> <li><a href="https://github.com/greatest-ape/aquatic/tree/master/crates/bencher" rel="nofollow">Aquatic Bencher</a>.</li></ul></div></div>
          ]]></content:encoded>
          <media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://v2.torrust.com//images/posts/benchmarking-the-torrust-bittorrent-tracker/benchmarking-the-torrust-bittorrent-tracker-banner.webp"/>
          <media:content xmlns:media="http://search.yahoo.com/mrss/" medium="image" url="https://v2.torrust.com//images/posts/benchmarking-the-torrust-bittorrent-tracker/benchmarking-the-torrust-bittorrent-tracker-banner.webp"/>          
        </item>
      
        <item>
          <guid>https://v2.torrust.com/deploying-torrust-to-production</guid>
          <title>Deploying Torrust To Production</title>
          <description>Dive into our step-by-step tutorial on deploying a BitTorrent Index and Tracker, written in Rust, on a Digital Ocean droplet. From initial server setup to advanced configurations, this guide is designed for both non-developers and tech-savvy users, ensuring a seamless, production-ready deployment.</description>
          <link>https://v2.torrust.com/deploying-torrust-to-production</link>
          <pubDate>20/12/2023 00:00:00</pubDate>
          <category>Tutorial</category><category>Deployment</category><category>Production</category>
          <content:encoded><![CDATA[
            <div style="margin: 50px 0; font-style: italic;">
              If anything looks wrong, 
              <strong>
                <a href="https://v2.torrust.com/deploying-torrust-to-production">
                  read on the site!
                </a>
              </strong>
            </div>

             <div class="flex svelte-19d8qsr"> <div class=" svelte-13ebny9" style="position: relative;"><div class="svelte-13ebny9"><h2 id="table-of-contents" data-svelte-h="svelte-1m3njcc"><a class="heading-link" title="Permalink" aria-hidden="true" href="#table-of-contents"><span>#</span></a>Table of Contents</h2> <ul data-svelte-h="svelte-1ryjzs2"><li><a href="#introduction">Introduction</a></li> <li><a href="#requirements">Requirements</a></li> <li><a href="#initial-server-setup">Initial Server Setup</a><ul><li><a href="#setup-ssh-keys">Setup SSH Keys</a></li> <li><a href="#install-docker">Install Docker</a></li> <li><a href="#install-docker-compose">Install Docker Compose</a></li> <li><a href="#install-sqlite">Install SQLite</a></li></ul></li> <li><a href="#setup-the-dns">Setup The DNS</a></li> <li><a href="#install-the-application">Install The Application</a><ul><li><a href="#without-certificates">Without Certificates</a></li> <li><a href="#generate-certificates-with-lets-encrypt">Generate Certificates With Let’s Encrypt</a></li> <li><a href="#change-nginx-configuration-to-use-certificates">Change Nginx Configuration To Use Certificates</a></li> <li><a href="#setup-cronjob-to-renew-certificates">Setup Cronjob To Renew Certificates</a></li></ul></li> <li><a href="#exposed-services">Exposed Services</a><ul><li><a href="#firewall">Firewall</a></li> <li><a href="#health-checks">Health checks</a></li></ul></li> <li><a href="#troubleshooting">Troubleshooting</a></li> <li><a href="#maintenance">Maintenance</a><ul><li><a href="#backups">Backups</a></li> <li><a href="#monitoring">Monitoring</a></li></ul></li> <li><a href="#cost">Cost</a></li> <li><a href="#other-considerations">Other Considerations</a></li> <li><a href="#links">Links</a></li> <li><a href="#conclusion">Conclusion</a></li></ul></div></div> <div class="svelte-4jsat1"><h2 id="introduction" data-svelte-h="svelte-1ahwhrx"><a class="heading-link" title="Permalink" aria-hidden="true" href="#introduction"><span>#</span></a>Introduction</h2> <p data-svelte-h="svelte-1awa8lh">Welcome to our guide on deploying a BitTorrent Index and Tracker. We’ll walk you through each step, explaining the process in a user-friendly manner, so you can understand the magic behind hosting a powerful, Rust-based application on the cloud.</p> <p data-svelte-h="svelte-jwgro1">This guide provides detailed, technical steps for deploying your Rust-based BitTorrent Index and Tracker on a Digital Ocean droplet. You’ll find precise commands and configurations to ensure a smooth, efficient setup.</p> <p data-svelte-h="svelte-kguc39">You can find the docker compose configuration used in this guide on the following GitHub repo:</p> <p data-svelte-h="svelte-1o7fl1r"><a href="https://github.com/torrust/torrust-compose/tree/main/droplet" rel="nofollow">https://github.com/torrust/torrust-compose/tree/main/droplet</a></p> <p data-svelte-h="svelte-tpmjyq">Although we are using a droplet, this tutorial is intended to be so generic that
you should be able to setup the services in any virtual machine with docker and docker compose.</p> <p data-svelte-h="svelte-1tn4ufv">This tutorial is based on the Digital Ocean tutorial:</p> <p data-svelte-h="svelte-zy2fnp"><a href="https://www.digitalocean.com/community/tutorials/how-to-secure-a-containerized-node-js-application-with-nginx-let-s-encrypt-and-docker-compose" rel="nofollow">How To Secure a Containerized Node.js Application with Nginx, Let’s Encrypt, and Docker Compose</a>.</p> <p data-svelte-h="svelte-ijmibu">We have only changed the docker compose configuration and some steps to configure the <strong>Torrust Index and Tracker</strong> instead of
the sample node application.</p> <p data-svelte-h="svelte-nro7oh">After finishing this tutorial you will have these public services available (with your own domain):</p> <ul data-svelte-h="svelte-fk1fu0"><li>Torrust Index: <a href="https://index.torrust-demo.com" rel="nofollow">https://index.torrust-demo.com</a></li> <li>Torrust HTTP Tracker: <a href="https://tracker.torrust-demo.com/announce" rel="nofollow">https://tracker.torrust-demo.com/announce</a></li> <li>Torrust UDP Tracker: <a href="udp://tracker.torrust-demo.com:6969/announce">udp://tracker.torrust-demo.com:6969/announce</a></li></ul> <h2 id="requirements" data-svelte-h="svelte-d9t7ph"><a class="heading-link" title="Permalink" aria-hidden="true" href="#requirements"><span>#</span></a>Requirements</h2> <p data-svelte-h="svelte-14h9udh">You will need:</p> <ul data-svelte-h="svelte-kzy662"><li>A Digital Ocean account.</li> <li>A Digital Ocean virtual machine (droplet) with Ubuntu 22.04.2 LTS.</li> <li>Docker, Docker Compose, SQLite3 and Git installed on the server.</li></ul> <p data-svelte-h="svelte-481lss">We will explain how to install the required dependencies in the Ubuntu server.</p> <h3 id="server" data-svelte-h="svelte-1lk2f4q"><a class="heading-link" title="Permalink" aria-hidden="true" href="#server"><span>#</span></a>Server</h3> <p data-svelte-h="svelte-1zoymk">A Digital Ocean Droplet with a configuration similar to this:</p> <ul data-svelte-h="svelte-2vrxe3"><li><strong>Datacenter</strong>: Frankfurt (FRA1).</li> <li><strong>Image</strong>: Ubuntu 22.04 (LTS) x64.</li> <li><strong>Droplet Type</strong>: Shared CPU (Basic).</li> <li><strong>CPU options</strong>: Regular (Disk Type: SSD).</li></ul> <p data-svelte-h="svelte-1plfg5n">Resources:</p> <ul data-svelte-h="svelte-ogyfwb"><li>1 GB/1CPU.</li> <li>25 GB SS Disk.</li> <li>1000 GB transfer.</li></ul> <p data-svelte-h="svelte-fn4rp3">Features:</p> <ul data-svelte-h="svelte-hg1gm8"><li>Backups enabled.</li> <li>With improved metrics monitoring and alerting.</li></ul> <h3 id="software" data-svelte-h="svelte-1rxdbuo"><a class="heading-link" title="Permalink" aria-hidden="true" href="#software"><span>#</span></a>Software</h3> <ul data-svelte-h="svelte-16fgxx0"><li>Ubuntu 22.04.2 LTS (already installed in the droplet)</li> <li>Docker version 24.0.7, build afdd53b.</li> <li>Docker Compose version v2.3.3.</li> <li>SQLite3 version 3.37.2 2022-01-06 13:25:41 872ba256cbf61d9290b571c0e6d82a20c224ca3ad82971edc46b29818d5dalt1.</li> <li>Git version 2.34.1 (only for the installation).</li></ul> <p data-svelte-h="svelte-17kxcyd">The Docker images used by this tutorial are:</p> <div class="code-block svelte-11qxx87"> <div class="lang svelte-11qxx87">terminal</div> <button class="copy-button copy-button-gray svelte-11qxx87"></button> <div class="code-content"><pre class="language-console"><!-- HTML_TAG_START --><code class="language-console">$ docker images --digests
REPOSITORY          TAG               DIGEST                                                                    IMAGE ID       CREATED       SIZE
torrust/tracker     develop           sha256:5589eaf57af277feda6eca6f841859fd2aa05af7deafca546ad0a17fe36d8e51   c42f0cce3304   4 days ago    160MB
nginx               mainline-alpine   sha256:3923f8de8d2214b9490e68fd6ae63ea604deddd166df2755b788bef04848b9bc   01e5c69afaf6   2 weeks ago   42.6MB
torrust/index       develop           sha256:69b12dfcb9c47267bd314f4869dfce7585d3f2b172200ef0d7d7bb776e209fe6   a3db4d4e5d6a   2 weeks ago   64.9MB
torrust/index-gui   develop           sha256:b30deb84cdee8fa34e4d3783ce2f467542e6fdc13a14dd6bbed879e2e2b82bcb   4f6e446cb009   2 weeks ago   175MB</code><!-- HTML_TAG_END --></pre></div></div> <div class="callout-block info svelte-sxx0n0"><div class="icon-wrapper svelte-sxx0n0"><svg width="100%" height="100%" stroke-width="1.5" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 11.5V16.5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path d="M12 7.51L12.01 7.49889" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path d="M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path></svg></div> We will update them to use a concrete tag v3.0 after releasing it.</div> <h3 id="domain" data-svelte-h="svelte-xf7of1"><a class="heading-link" title="Permalink" aria-hidden="true" href="#domain"><span>#</span></a>Domain</h3> <p data-svelte-h="svelte-sbcnpw">You will need a domain. We are using “torrust-demo.com” in this tutorial.</p> <h2 id="initial-server-setup" data-svelte-h="svelte-1lt2y63"><a class="heading-link" title="Permalink" aria-hidden="true" href="#initial-server-setup"><span>#</span></a>Initial Server Setup</h2> <p data-svelte-h="svelte-1hq0qaj">Starting off, we’ll set up a virtual server using Ubuntu 22.04. Think of it as preparing a new computer for your application, ensuring it’s ready to run smoothly.</p> <p data-svelte-h="svelte-wt4zra">This section covers the initial configuration of your Ubuntu 22.04 server, focusing on essential security and performance optimizations.</p> <div class="callout-block info svelte-sxx0n0"><div class="icon-wrapper svelte-sxx0n0"><svg width="100%" height="100%" stroke-width="1.5" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 11.5V16.5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path d="M12 7.51L12.01 7.49889" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path d="M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path></svg></div> Disclaimer: For the initial server setup we only highlight the main points. We provide the links to Digital Ocean tutorials
  where you will find detailed information.</div> <p data-svelte-h="svelte-102dmr8">Please refer to <a href="https://docs.digitalocean.com/" rel="nofollow">Digital Ocean Documentation</a> for more information about how to create projects and droplets. Projects are the way DO (Digital Ocean) organizes resources (virtual machines, databases, domains, etc.). We have a project called “torrust-demo.com”.</p> <p data-svelte-h="svelte-kbwxhx">Once you have created your project and droplet you can follow the <a href="https://www.digitalocean.com/community/tutorials/initial-server-setup-with-ubuntu-22-04" rel="nofollow">Digital Ocean guide to setup a new Ubuntu server</a>.</p> <p data-svelte-h="svelte-masdly">For this tutorial we have used our demo environment.</p> <p data-svelte-h="svelte-73slgm">In this first step you will:</p> <ul data-svelte-h="svelte-2mg5wg"><li>Create a virtual machine (droplet).</li> <li>Access the virtual machine using the <code>root</code> account.</li> <li>Create a new user <code>torrust</code>.</li> <li>Access the server using the new account <code>torrust</code>.</li></ul> <p data-svelte-h="svelte-1gnydxc">After creating the droplet you should be able to connect by using SSH with the <code>root</code> account providing the password you set
during the droplet creation:</p> <div class="code-block svelte-11qxx87"> <div class="lang svelte-11qxx87">bash</div> <button class="copy-button copy-button-gray svelte-11qxx87"></button> <div class="code-content"><pre class="language-bash"><!-- HTML_TAG_START --><code class="language-bash"><span class="token function">ssh</span> root@139.59.150.216</code><!-- HTML_TAG_END --></pre></div></div> <p data-svelte-h="svelte-bsztye">After logging in you can create the new user account:</p> <div class="code-block svelte-11qxx87"> <div class="lang svelte-11qxx87">bash</div> <button class="copy-button copy-button-gray svelte-11qxx87"></button> <div class="code-content"><pre class="language-bash"><!-- HTML_TAG_START --><code class="language-bash">adduser torrust
<span class="token function">usermod</span> <span class="token parameter variable">-aG</span> <span class="token function">sudo</span> torrust</code><!-- HTML_TAG_END --></pre></div></div> <p data-svelte-h="svelte-e6ugj6">The user is added to the sudo group you can can execute command as root when needed.</p> <h3 id="setup-ssh-keys" data-svelte-h="svelte-1rxyfkq"><a class="heading-link" title="Permalink" aria-hidden="true" href="#setup-ssh-keys"><span>#</span></a>Setup SSH Keys</h3> <p data-svelte-h="svelte-g4kj1e">Security is key! Setting up SSH keys is like creating a special passcode for safe and secure access to your server.</p> <p data-svelte-h="svelte-ue2jkk">Follow the <a href="https://www.digitalocean.com/community/tutorials/how-to-set-up-ssh-keys-on-ubuntu-22-04" rel="nofollow">Digital Ocean tutorial</a> to establish secure SSH key authentication, enhancing the security of your server connections.</p> <p data-svelte-h="svelte-r2i9gz">You have to generate a new key and copy it to the server:</p> <div class="code-block svelte-11qxx87"> <div class="lang svelte-11qxx87">bash</div> <button class="copy-button copy-button-gray svelte-11qxx87"></button> <div class="code-content"><pre class="language-bash"><!-- HTML_TAG_START --><code class="language-bash">ssh-copy-id <span class="token parameter variable">-i</span> ~/.ssh/torrust_rsa.pub torrust@139.59.150.216</code><!-- HTML_TAG_END --></pre></div></div> <p data-svelte-h="svelte-1agehpc">If all went fine you should be able to login to the server with your SSH key.</p> <div class="code-block svelte-11qxx87"> <div class="lang svelte-11qxx87">bash</div> <button class="copy-button copy-button-gray svelte-11qxx87"></button> <div class="code-content"><pre class="language-bash"><!-- HTML_TAG_START --><code class="language-bash"><span class="token function">ssh</span> torrust@139.59.150.216</code><!-- HTML_TAG_END --></pre></div></div> <h3 id="install-docker" data-svelte-h="svelte-dcwzx2"><a class="heading-link" title="Permalink" aria-hidden="true" href="#install-docker"><span>#</span></a>Install Docker</h3> <p data-svelte-h="svelte-1iktbq8">Docker is a tool that lets you run applications in a consistent environment. It’s like having a universal app runner that works the same everywhere.</p> <p data-svelte-h="svelte-w05d69">You can also follow the DO guide: <a href="https://www.digitalocean.com/community/tutorials/how-to-install-and-use-docker-on-ubuntu-22-04" rel="nofollow">How To Install and Use Docker on Ubuntu 22.04</a>.</p> <p data-svelte-h="svelte-1tjig7w">In short, you only need to execute some commands:</p> <div class="code-block svelte-11qxx87"> <div class="lang svelte-11qxx87">bash</div> <button class="copy-button copy-button-gray svelte-11qxx87"></button> <div class="code-content"><pre class="language-bash"><!-- HTML_TAG_START --><code class="language-bash"><span class="token function">sudo</span> <span class="token function">apt</span> update
<span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> apt-transport-https ca-certificates <span class="token function">curl</span> software-properties-common
<span class="token function">curl</span> <span class="token parameter variable">-fsSL</span> https://download.docker.com/linux/ubuntu/gpg <span class="token operator">|</span> <span class="token function">sudo</span> gpg <span class="token parameter variable">--dearmor</span> <span class="token parameter variable">-o</span> /usr/share/keyrings/docker-archive-keyring.gpg
<span class="token builtin class-name">echo</span> <span class="token string">"deb [arch=<span class="token variable"><span class="token variable">$(</span>dpkg --print-architecture<span class="token variable">)</span></span> signed-by=/usr/share/keyrings/docker-archive-keyring.gpg] https://download.docker.com/linux/ubuntu <span class="token variable"><span class="token variable">$(</span>lsb_release <span class="token parameter variable">-cs</span><span class="token variable">)</span></span> stable"</span> <span class="token operator">|</span> <span class="token function">sudo</span> <span class="token function">tee</span> /etc/apt/sources.list.d/docker.list <span class="token operator">></span> /dev/null
<span class="token function">sudo</span> <span class="token function">apt</span> update
<span class="token function">apt-cache</span> policy docker-ce
<span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> docker-ce
<span class="token function">sudo</span> systemctl status <span class="token function">docker</span></code><!-- HTML_TAG_END --></pre></div></div> <p data-svelte-h="svelte-nhz2wx">If you want to execute docker without sudo you will need to execute some more commands:</p> <div class="code-block svelte-11qxx87"> <div class="lang svelte-11qxx87">bash</div> <button class="copy-button copy-button-gray svelte-11qxx87"></button> <div class="code-content"><pre class="language-bash"><!-- HTML_TAG_START --><code class="language-bash"><span class="token function">sudo</span> <span class="token function">usermod</span> <span class="token parameter variable">-aG</span> <span class="token function">docker</span> <span class="token variable">$&#123;<span class="token environment constant">USER</span>&#125;</span>
<span class="token function">su</span> - <span class="token variable">$&#123;<span class="token environment constant">USER</span>&#125;</span></code><!-- HTML_TAG_END --></pre></div></div> <p data-svelte-h="svelte-rcbycd">Make sure docker is running with <code>docker run hello-world</code>.</p> <h3 id="install-docker-compose" data-svelte-h="svelte-cbitrm"><a class="heading-link" title="Permalink" aria-hidden="true" href="#install-docker-compose"><span>#</span></a>Install Docker Compose</h3> <p data-svelte-h="svelte-1pn413f">Docker Compose helps in running complex apps easily. It’s like a recipe that tells Docker how to prepare and serve your app.</p> <p data-svelte-h="svelte-q7j166">You can follow the Digital Ocean Tutorial: <a href="https://www.digitalocean.com/community/tutorials/how-to-install-and-use-docker-compose-on-ubuntu-22-04" rel="nofollow">How To Install and Use Docker Compose on Ubuntu 22.04</a></p> <div class="code-block svelte-11qxx87"> <div class="lang svelte-11qxx87">bash</div> <button class="copy-button copy-button-gray svelte-11qxx87"></button> <div class="code-content"><pre class="language-bash"><!-- HTML_TAG_START --><code class="language-bash"><span class="token function">mkdir</span> <span class="token parameter variable">-p</span> ~/.docker/cli-plugins/
<span class="token function">curl</span> <span class="token parameter variable">-SL</span> https://github.com/docker/compose/releases/download/v2.3.3/docker-compose-linux-x86_64 <span class="token parameter variable">-o</span> ~/.docker/cli-plugins/docker-compose
<span class="token function">chmod</span> +x ~/.docker/cli-plugins/docker-compose</code><!-- HTML_TAG_END --></pre></div></div> <p data-svelte-h="svelte-hvrddu">And also make sure it’s installed correctly with <code>docker compose version</code>.</p> <h3 id="install-sqlite" data-svelte-h="svelte-euwmmq"><a class="heading-link" title="Permalink" aria-hidden="true" href="#install-sqlite"><span>#</span></a>Install SQLite</h3> <p data-svelte-h="svelte-kfcmms">SQLite is a simple database system. You won’t needed if you use MySQL for both the Index and Tracker. In this tutorial
we will use it.</p> <div class="code-block svelte-11qxx87"> <div class="lang svelte-11qxx87">bash</div> <button class="copy-button copy-button-gray svelte-11qxx87"></button> <div class="code-content"><pre class="language-bash"><!-- HTML_TAG_START --><code class="language-bash"><span class="token function">sudo</span> <span class="token function">apt</span> update
<span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> sqlite3</code><!-- HTML_TAG_END --></pre></div></div> <p data-svelte-h="svelte-1dgnv5y">You can check if it’s installed correctly with <code>sqlite3 --version</code>.</p> <p data-svelte-h="svelte-55ocrl">You can execute queries to get the Tracker or Index data connecting with:</p> <div class="code-block svelte-11qxx87"> <div class="lang svelte-11qxx87">bash</div> <button class="copy-button copy-button-gray svelte-11qxx87"></button> <div class="code-content"><pre class="language-bash"><!-- HTML_TAG_START --><code class="language-bash">$ sqlite3 ./storage/index/lib/database/sqlite3.db
SQLite version <span class="token number">3.37</span>.2 <span class="token number">2022</span>-01-06 <span class="token number">13</span>:25:41
Enter <span class="token string">".help"</span> <span class="token keyword">for</span> usage hints.
sqlite<span class="token operator">></span></code><!-- HTML_TAG_END --></pre></div></div> <p data-svelte-h="svelte-1xpdkxs">Some useful commands are:</p> <ul data-svelte-h="svelte-16kbk4m"><li><code>.help</code>: show help.</li> <li><code>.tables</code>: list tables.</li> <li><code>.quit</code>: exit.</li></ul> <h2 id="setup-the-dns" data-svelte-h="svelte-yrf5v8"><a class="heading-link" title="Permalink" aria-hidden="true" href="#setup-the-dns"><span>#</span></a>Setup The DNS</h2> <p data-svelte-h="svelte-11szrw9">Before running the application we have to setup the DNS. You can load the application using your domain instead of the droplet IP.</p> <div class="callout-block info svelte-sxx0n0"><div class="icon-wrapper svelte-sxx0n0"><svg width="100%" height="100%" stroke-width="1.5" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 11.5V16.5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path d="M12 7.51L12.01 7.49889" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path d="M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path></svg></div> The droplet has an IP that can be used to setup the DNS, but we recommend using an reserved IP. You can link the reserved IP to the droplet.</div> <p data-svelte-h="svelte-1fzhnoh">First at all, you need to change your name servers and use the ones from Digital Ocean. You have to find out how to do that
in your domain provider.</p> <p data-svelte-h="svelte-1gx85hd">Then you need to create two <code>A</code> records to point the domains to the droplet IP (or the reserved IP if you are using one).</p> <p data-svelte-h="svelte-1oivqlp">Here is how the DNS configuration looks like for our demo:</p> <img srcset="/images/posts/deploying-torrust-to-production/dns-configuration.png, /images/posts/deploying-torrust-to-production/dns-configuration.png, /images/posts/deploying-torrust-to-production/dns-configuration.png" src="/images/posts/deploying-torrust-to-production/dns-configuration.png" alt="Create" loading="lazy" decoding="async" class="svelte-1ykl0dj"> <h3 id="bep-34" data-svelte-h="svelte-12m5xlv"><a class="heading-link" title="Permalink" aria-hidden="true" href="#bep-34"><span>#</span></a>BEP 34</h3> <p data-svelte-h="svelte-kibdaw">As you can see in our DNS configuration we have a <code>TXT</code> record for the tracker with this value:</p> <pre class="language-text"><!-- HTML_TAG_START --><code class="language-text">BITTORRENT UDP:6969 TCP:443</code><!-- HTML_TAG_END --></pre> <p data-svelte-h="svelte-12rh0x4">That record implements the <a href="https://www.bittorrent.org/beps/bep_0034.html" rel="nofollow">BEP 34 DNS Tracker Preferences</a>.</p> <p data-svelte-h="svelte-9lq4rk">That allows administrators to declare the port and the service priorities for a tracker domain. In our case, we have two different trackers running on ports <code>6969</code> and <code>443</code> and we prioritize the UDP tracker.</p> <p data-svelte-h="svelte-1u4ac1h">Some services related to tracker (for instance <a href="https://newtrackon.com" rel="nofollow">https://newtrackon.com</a>) use this DNS record to verify tracker URLs.</p> <h2 id="install-the-application" data-svelte-h="svelte-146i9al"><a class="heading-link" title="Permalink" aria-hidden="true" href="#install-the-application"><span>#</span></a>Install The Application</h2> <p data-svelte-h="svelte-8lo22w">First, we will install the application on port <code>80</code> because we need a live app to generate the HTTPs certificates with
Let’s Encrypt. Once we generate the certificates we can change the configuration to serve the application on port <code>443</code>.</p> <h3 id="without-certificates" data-svelte-h="svelte-j2n8q1"><a class="heading-link" title="Permalink" aria-hidden="true" href="#without-certificates"><span>#</span></a>Without certificates</h3> <p data-svelte-h="svelte-eiuzgi">We’ll start by launching your app in a basic, non-secure mode. Initial deployment steps will be covered, focusing on functionality before implementing SSL/TLS certificates. We need to run the application in order to generate certificates with Let’s Encrypt.</p> <p data-svelte-h="svelte-1k7c2w7">First, we need to get the docker compose configuration. You can download it directly from the <a href="https://github.com/torrust/torrust-compose" rel="nofollow">Torrust Compose GitHub repo</a> or you can use Git:</p> <div class="code-block svelte-11qxx87"> <div class="lang svelte-11qxx87">bash</div> <button class="copy-button copy-button-gray svelte-11qxx87"></button> <div class="code-content"><pre class="language-bash"><!-- HTML_TAG_START --><code class="language-bash"><span class="token builtin class-name">cd</span> <span class="token punctuation"></span><span class="token punctuation"></span>
  <span class="token operator">&amp;&amp;</span> <span class="token function">mkdir</span> <span class="token parameter variable">-p</span> github/torrust <span class="token punctuation"></span><span class="token punctuation"></span>
  <span class="token operator">&amp;&amp;</span> <span class="token builtin class-name">cd</span> torrust/  <span class="token punctuation"></span><span class="token punctuation"></span>
  <span class="token operator">&amp;&amp;</span> <span class="token function">git</span> clone --single-branch <span class="token parameter variable">--branch</span> main https://github.com/torrust/torrust-compose.git  <span class="token punctuation"></span><span class="token punctuation"></span>
  <span class="token operator">&amp;&amp;</span> <span class="token builtin class-name">cd</span> torrust-compose/  <span class="token punctuation"></span><span class="token punctuation"></span>
  <span class="token operator">&amp;&amp;</span> <span class="token function">git</span> status  <span class="token punctuation"></span><span class="token punctuation"></span>
  <span class="token operator">&amp;&amp;</span> <span class="token builtin class-name">cd</span> droplet/</code><!-- HTML_TAG_END --></pre></div></div> <p data-svelte-h="svelte-f6dfud">If you use Git you will need to install it in the server. Follow the <a href="https://www.digitalocean.com/community/tutorials/how-to-install-git-on-ubuntu-22-04" rel="nofollow">“How To Install Git on Ubuntu 22.04”</a> guide.</p> <p data-svelte-h="svelte-8zuklx">After cloning the repository you have to run the install script:</p> <div class="code-block svelte-11qxx87"> <div class="lang svelte-11qxx87">bash</div> <button class="copy-button copy-button-gray svelte-11qxx87"></button> <div class="code-content"><pre class="language-bash"><!-- HTML_TAG_START --><code class="language-bash">$ ./bin/install.sh
Creating compose .env <span class="token string">'./.env'</span>
Creating proxy config file: <span class="token string">'./storage/proxy/etc/nginx-conf/nginx.conf'</span>
Creating index database: <span class="token string">'./storage/index/lib/database/sqlite3.db'</span>
Creating index configuration: <span class="token string">'./storage/index/etc/index.toml'</span>
Creating tracker database: <span class="token string">'./storage/tracker/lib/database/sqlite3.db'</span>
Creating tracker configuration: <span class="token string">'./storage/tracker/etc/tracker.toml'</span></code><!-- HTML_TAG_END --></pre></div></div> <p data-svelte-h="svelte-kgb9wo">The script will create some needed directories and empty SQLite databases:</p> <div class="code-block svelte-11qxx87"> <div class="lang svelte-11qxx87">bash</div> <button class="copy-button copy-button-gray svelte-11qxx87"></button> <div class="code-content"><pre class="language-bash"><!-- HTML_TAG_START --><code class="language-bash">$ tree storage/
storage/
├── certbot
│   ├── etc
│   └── lib
├── dhparam
├── index
│   ├── etc
│   │   └── index.toml
│   └── lib
│       └── database
│           └── sqlite3.db
├── proxy
│   ├── etc
│   │   └── nginx-conf
│   │       └── nginx.conf
│   └── webroot
└── tracker
    ├── etc
    │   └── tracker.toml
    └── lib
        └── database
            └── sqlite3.db

<span class="token number">17</span> directories, <span class="token number">5</span> files
</code><!-- HTML_TAG_END --></pre></div></div> <p data-svelte-h="svelte-1qjv41z">Now you can continue with some customizations. You can adjust the default configuration for all services
or leave the default values. But at least you must change the domain and the secrets.</p> <p data-svelte-h="svelte-gb06cg">First open the <code>.env</code> file and find these environment variables:</p> <ul data-svelte-h="svelte-1r13dla"><li><code>TORRUST_INDEX_GUI_API_BASE_URL</code></li> <li><code>TORRUST_INDEX_CONFIG_OVERRIDE_TRACKER__TOKEN</code></li> <li><code>TORRUST_INDEX_CONFIG_OVERRIDE_AUTH__SECRET_KEY</code></li> <li><code>TORRUST_TRACKER_CONFIG_OVERRIDE_HTTP_API__ACCESS_TOKENS__ADMIN</code></li></ul> <p data-svelte-h="svelte-wdd93k">Replace the value for <code>TORRUST_INDEX_GUI_API_BASE_URL</code> with your domain:</p> <pre class="language-text"><!-- HTML_TAG_START --><code class="language-text">TORRUST_INDEX_GUI_API_BASE_URL='http://index.your-domain.com/api/v1'</code><!-- HTML_TAG_END --></pre> <p data-svelte-h="svelte-vqh9gt">You can generate the Tracker API token and the Auth Secret Key with:</p> <div class="code-block svelte-11qxx87"> <div class="lang svelte-11qxx87">bash</div> <button class="copy-button copy-button-gray svelte-11qxx87"></button> <div class="code-content"><pre class="language-bash"><!-- HTML_TAG_START --><code class="language-bash"> gpg <span class="token parameter variable">--armor</span> --gen-random <span class="token number">1</span> <span class="token number">40</span>
<span class="token assign-left variable">jcrmbzlGyeP7z53TUQtXmtltMb5TubsIE9e0DPLnS4Ih29JddQw5JA</span><span class="token operator">==</span></code><!-- HTML_TAG_END --></pre></div></div> <div class="callout-block info svelte-sxx0n0"><div class="icon-wrapper svelte-sxx0n0"><svg width="100%" height="100%" stroke-width="1.5" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 11.5V16.5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path d="M12 7.51L12.01 7.49889" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path d="M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path></svg></div> NOTICE: We are not sending emails from the application because user&#39;s email validation is disabled on registration for the demo. If you want to enable email validation you will need to provide the SMTP configuration including the password in the `storage/index/etc/index.toml` config file.</div> <p data-svelte-h="svelte-1l5cthl">Now, you should be able to run the application with the following command:</p> <div class="code-block svelte-11qxx87"> <div class="lang svelte-11qxx87">bash</div> <button class="copy-button copy-button-gray svelte-11qxx87"></button> <div class="code-content"><pre class="language-bash"><!-- HTML_TAG_START --><code class="language-bash"><span class="token function">docker</span> compose up <span class="token parameter variable">--build</span> <span class="token parameter variable">--detach</span></code><!-- HTML_TAG_END --></pre></div></div> <p data-svelte-h="svelte-48w7bs">If you have reached this point, congratulations! you already have these live services:</p> <ul data-svelte-h="svelte-paup52"><li>Torrust Index: <a href="http://index.your-domain.com" rel="nofollow">http://index.your-domain.com</a></li> <li>Torrust HTTP Tracker: <a href="http://tracker.your-domain.com/announce" rel="nofollow">http://tracker.your-domain.com/announce</a></li> <li>Torrust UDP Tracker: <a href="udp://tracker.your-domain.com:6969/announce">udp://tracker.your-domain.com:6969/announce</a></li></ul> <p data-svelte-h="svelte-1np0zyr">In the next sections we will describe how to use Let’s Encrypt to generate certificates to use HTTPs for the Index website and HTTP Tracker.</p> <h3 id="generate-certificates-with-lets-encrypt" data-svelte-h="svelte-luskqm"><a class="heading-link" title="Permalink" aria-hidden="true" href="#generate-certificates-with-lets-encrypt"><span>#</span></a>Generate Certificates With Let’s Encrypt</h3> <p data-svelte-h="svelte-9zvs5l">Let’s Encrypt provides free certificates. You’ll learn how to obtain and configure Let’s Encrypt SSL certificates for secure HTTPS connections.</p> <p data-svelte-h="svelte-402pa9">First, you need to log in the “certbot” container. <a href="https://certbot.eff.org/" rel="nofollow">Certbot</a> is a free, open source software tool for automatically (using Let’s Encrypt certificates) enable HTTPS.</p> <div class="code-block svelte-11qxx87"> <div class="lang svelte-11qxx87">bash</div> <button class="copy-button copy-button-gray svelte-11qxx87"></button> <div class="code-content"><pre class="language-bash"><!-- HTML_TAG_START --><code class="language-bash"><span class="token function">docker</span> compose run <span class="token parameter variable">--entrypoint</span> /bin/sh certbot</code><!-- HTML_TAG_END --></pre></div></div> <div class="callout-block info svelte-sxx0n0"><div class="icon-wrapper svelte-sxx0n0"><svg width="100%" height="100%" stroke-width="1.5" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 11.5V16.5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path d="M12 7.51L12.01 7.49889" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path d="M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path></svg></div> Notice that the previous command recreates the docker containers so you site will be down for some seconds.</div> <p data-svelte-h="svelte-3km01r">Once you are logged in the certbot container you need to execute these certbot commands to generate the staging certificates:</p> <div class="code-block svelte-11qxx87"> <div class="lang svelte-11qxx87">bash</div> <button class="copy-button copy-button-gray svelte-11qxx87"></button> <div class="code-content"><pre class="language-bash"><!-- HTML_TAG_START --><code class="language-bash">certbot certonly <span class="token parameter variable">--webroot</span> --webroot-path<span class="token operator">=</span>/var/www/html <span class="token parameter variable">--email</span> email@example.com --agree-tos --no-eff-email <span class="token parameter variable">--staging</span> <span class="token parameter variable">-d</span> index.torrust-demo.com
certbot certonly <span class="token parameter variable">--webroot</span> --webroot-path<span class="token operator">=</span>/var/www/html <span class="token parameter variable">--email</span> email@example.com --agree-tos --no-eff-email <span class="token parameter variable">--staging</span> <span class="token parameter variable">-d</span> tracker.torrust-demo.com</code><!-- HTML_TAG_END --></pre></div></div> <p data-svelte-h="svelte-wk4kyj">Replace <code>email@example.com</code> with your email.</p> <p data-svelte-h="svelte-bhkkmm">For the production certificates you can execute the same command but removing the flag <code>--staging</code>:</p> <div class="code-block svelte-11qxx87"> <div class="lang svelte-11qxx87">bash</div> <button class="copy-button copy-button-gray svelte-11qxx87"></button> <div class="code-content"><pre class="language-bash"><!-- HTML_TAG_START --><code class="language-bash">certbot certonly <span class="token parameter variable">--webroot</span> --webroot-path<span class="token operator">=</span>/var/www/html <span class="token parameter variable">--email</span> email@example.com --agree-tos --no-eff-email --force-renewal <span class="token parameter variable">-d</span> index.torrust-demo.com
certbot certonly <span class="token parameter variable">--webroot</span> --webroot-path<span class="token operator">=</span>/var/www/html <span class="token parameter variable">--email</span> email@example.com --agree-tos --no-eff-email --force-renewal <span class="token parameter variable">-d</span> tracker.torrust-demo.com</code><!-- HTML_TAG_END --></pre></div></div> <p data-svelte-h="svelte-e0iof">In the directory <code>storage/certbot/etc/live</code> you should have at least one directory per domain.</p> <h3 id="change-nginx-configuration-to-use-certificates" data-svelte-h="svelte-9zpi6d"><a class="heading-link" title="Permalink" aria-hidden="true" href="#change-nginx-configuration-to-use-certificates"><span>#</span></a>Change Nginx Configuration To Use Certificates</h3> <p data-svelte-h="svelte-r7njd6">Once we have the certificates, we’ll tell our server (Nginx) to use them, ensuring a secure website. Detailed steps to modify your Nginx configuration for SSL implementation will be provided.</p> <h4 id="generate-the-diffie-hellman-key" data-svelte-h="svelte-1a5u8pf"><a class="heading-link" title="Permalink" aria-hidden="true" href="#generate-the-diffie-hellman-key"><span>#</span></a>Generate The Diffie-Hellman Key</h4> <div class="code-block svelte-11qxx87"> <div class="lang svelte-11qxx87">bash</div> <button class="copy-button copy-button-gray svelte-11qxx87"></button> <div class="code-content"><pre class="language-bash"><!-- HTML_TAG_START --><code class="language-bash"><span class="token function">sudo</span> openssl dhparam <span class="token parameter variable">-out</span> /home/torrust/github/torrust/torrust-compose/droplet/storage/dhparam/dhparam-2048.pem <span class="token number">2048</span></code><!-- HTML_TAG_END --></pre></div></div> <h4 id="update-nginx-configuration" data-svelte-h="svelte-1osroiw"><a class="heading-link" title="Permalink" aria-hidden="true" href="#update-nginx-configuration"><span>#</span></a>Update Nginx Configuration</h4> <p data-svelte-h="svelte-19ikup3">Edit the file <code>./storage/proxy/etc/nginx-conf/nginx.conf</code> and uncomment all the commented lines for HTTPs servers:</p> <div class="code-block svelte-11qxx87"> <div class="lang svelte-11qxx87">nginx</div> <button class="copy-button copy-button-gray svelte-11qxx87"></button> <div class="code-content"><pre class="language-nginx"><!-- HTML_TAG_START --><code class="language-nginx"><span class="token directive"><span class="token keyword">server</span></span>
<span class="token punctuation">&#123;</span>
  <span class="token directive"><span class="token keyword">listen</span> <span class="token number">443</span> ssl http2</span><span class="token punctuation">;</span>
  <span class="token directive"><span class="token keyword">listen</span> [::]:443 ssl http2</span><span class="token punctuation">;</span>
  <span class="token directive"><span class="token keyword">server_name</span> index.torrust-demo.com</span><span class="token punctuation">;</span>

  <span class="token directive"><span class="token keyword">server_tokens</span> <span class="token boolean">off</span></span><span class="token punctuation">;</span>

  <span class="token directive"><span class="token keyword">ssl_certificate</span> /etc/letsencrypt/live/index.torrust-demo.com-0001/fullchain.pem</span><span class="token punctuation">;</span>
  <span class="token directive"><span class="token keyword">ssl_certificate_key</span> /etc/letsencrypt/live/index.torrust-demo.com-0001/privkey.pem</span><span class="token punctuation">;</span>

  <span class="token directive"><span class="token keyword">ssl_buffer_size</span> <span class="token number">8k</span></span><span class="token punctuation">;</span>

  <span class="token directive"><span class="token keyword">ssl_dhparam</span> /etc/ssl/certs/dhparam-2048.pem</span><span class="token punctuation">;</span>

  <span class="token directive"><span class="token keyword">ssl_protocols</span> TLSv1.2</span><span class="token punctuation">;</span>
  <span class="token directive"><span class="token keyword">ssl_prefer_server_ciphers</span> <span class="token boolean">on</span></span><span class="token punctuation">;</span>

  <span class="token directive"><span class="token keyword">ssl_ciphers</span> ECDH+AESGCM:ECDH+AES256:ECDH+AES128:DH+3DES:!ADH:!AECDH:!MD5</span><span class="token punctuation">;</span>

  <span class="token directive"><span class="token keyword">ssl_ecdh_curve</span> secp384r1</span><span class="token punctuation">;</span>
  <span class="token directive"><span class="token keyword">ssl_session_tickets</span> <span class="token boolean">off</span></span><span class="token punctuation">;</span>

  <span class="token directive"><span class="token keyword">ssl_stapling</span> <span class="token boolean">on</span></span><span class="token punctuation">;</span>
  <span class="token directive"><span class="token keyword">ssl_stapling_verify</span> <span class="token boolean">on</span></span><span class="token punctuation">;</span>
  <span class="token directive"><span class="token keyword">resolver</span> 8.8.8.8</span><span class="token punctuation">;</span>

  <span class="token directive"><span class="token keyword">location</span> ^~/api/</span>
  <span class="token punctuation">&#123;</span>
    <span class="token directive"><span class="token keyword">rewrite</span> ^/api/(.*)$ /<span class="token variable">$1</span> break</span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">try_files</span> <span class="token variable">$uri</span> @index</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>

  <span class="token directive"><span class="token keyword">location</span> /</span>
  <span class="token punctuation">&#123;</span>
    <span class="token directive"><span class="token keyword">try_files</span> <span class="token variable">$uri</span> @index-gui</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>

  <span class="token directive"><span class="token keyword">location</span> @index</span>
  <span class="token punctuation">&#123;</span>
    <span class="token directive"><span class="token keyword">proxy_pass</span> http://index:3001</span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">add_header</span> X-Frame-Options <span class="token string">"SAMEORIGIN"</span> always</span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">add_header</span> X-XSS-Protection <span class="token string">"1; mode=block"</span> always</span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">add_header</span> X-Content-Type-Options <span class="token string">"nosniff"</span> always</span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">add_header</span> Referrer-Policy <span class="token string">"no-referrer-when-downgrade"</span> always</span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">add_header</span> Content-Security-Policy <span class="token string">"default-src * data: 'unsafe-eval' 'unsafe-inline'"</span> always</span><span class="token punctuation">;</span>
    <span class="token comment">#add_header Strict-Transport-Security "max-age=31536000; includeSubDomains; preload" always;</span>
    <span class="token comment"># enable strict transport security only if you understand the implications</span>
  <span class="token punctuation">&#125;</span>

  <span class="token directive"><span class="token keyword">location</span> @index-gui</span>
  <span class="token punctuation">&#123;</span>
    <span class="token directive"><span class="token keyword">proxy_pass</span> http://index-gui:3000</span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">add_header</span> X-Frame-Options <span class="token string">"SAMEORIGIN"</span> always</span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">add_header</span> X-XSS-Protection <span class="token string">"1; mode=block"</span> always</span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">add_header</span> X-Content-Type-Options <span class="token string">"nosniff"</span> always</span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">add_header</span> Referrer-Policy <span class="token string">"no-referrer-when-downgrade"</span> always</span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">add_header</span> Content-Security-Policy <span class="token string">"default-src * data: 'unsafe-eval' 'unsafe-inline'"</span> always</span><span class="token punctuation">;</span>
    <span class="token comment">#add_header Strict-Transport-Security "max-age=31536000; includeSubDomains; preload" always;</span>
    <span class="token comment"># enable strict transport security only if you understand the implications</span>
  <span class="token punctuation">&#125;</span>

  <span class="token directive"><span class="token keyword">root</span> /var/www/html</span><span class="token punctuation">;</span>
  <span class="token directive"><span class="token keyword">index</span> index.html index.htm index.nginx-debian.html</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token directive"><span class="token keyword">server</span></span>
<span class="token punctuation">&#123;</span>
  <span class="token directive"><span class="token keyword">listen</span> <span class="token number">443</span> ssl http2</span><span class="token punctuation">;</span>
  <span class="token directive"><span class="token keyword">listen</span> [::]:443 ssl http2</span><span class="token punctuation">;</span>
  <span class="token directive"><span class="token keyword">server_name</span> tracker.torrust-demo.com</span><span class="token punctuation">;</span>

  <span class="token directive"><span class="token keyword">server_tokens</span> <span class="token boolean">off</span></span><span class="token punctuation">;</span>

  <span class="token directive"><span class="token keyword">ssl_certificate</span> /etc/letsencrypt/live/tracker.torrust-demo.com/fullchain.pem</span><span class="token punctuation">;</span>
  <span class="token directive"><span class="token keyword">ssl_certificate_key</span> /etc/letsencrypt/live/tracker.torrust-demo.com/privkey.pem</span><span class="token punctuation">;</span>

  <span class="token directive"><span class="token keyword">ssl_buffer_size</span> <span class="token number">8k</span></span><span class="token punctuation">;</span>

  <span class="token directive"><span class="token keyword">ssl_dhparam</span> /etc/ssl/certs/dhparam-2048.pem</span><span class="token punctuation">;</span>

  <span class="token directive"><span class="token keyword">ssl_protocols</span> TLSv1.2</span><span class="token punctuation">;</span>
  <span class="token directive"><span class="token keyword">ssl_prefer_server_ciphers</span> <span class="token boolean">on</span></span><span class="token punctuation">;</span>

  <span class="token directive"><span class="token keyword">ssl_ciphers</span> ECDH+AESGCM:ECDH+AES256:ECDH+AES128:DH+3DES:!ADH:!AECDH:!MD5</span><span class="token punctuation">;</span>

  <span class="token directive"><span class="token keyword">ssl_ecdh_curve</span> secp384r1</span><span class="token punctuation">;</span>
  <span class="token directive"><span class="token keyword">ssl_session_tickets</span> <span class="token boolean">off</span></span><span class="token punctuation">;</span>

  <span class="token directive"><span class="token keyword">ssl_stapling</span> <span class="token boolean">on</span></span><span class="token punctuation">;</span>
  <span class="token directive"><span class="token keyword">ssl_stapling_verify</span> <span class="token boolean">on</span></span><span class="token punctuation">;</span>
  <span class="token directive"><span class="token keyword">resolver</span> 8.8.8.8</span><span class="token punctuation">;</span>

  <span class="token directive"><span class="token keyword">location</span> /api/</span>
  <span class="token punctuation">&#123;</span>
    <span class="token directive"><span class="token keyword">try_files</span> <span class="token variable">$uri</span> @tracker-api</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>

  <span class="token directive"><span class="token keyword">location</span> /</span>
  <span class="token punctuation">&#123;</span>
    <span class="token directive"><span class="token keyword">try_files</span> <span class="token variable">$uri</span> @tracker-http</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>

  <span class="token directive"><span class="token keyword">location</span> @tracker-api</span>
  <span class="token punctuation">&#123;</span>
    <span class="token directive"><span class="token keyword">proxy_pass</span> http://tracker:1212</span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">add_header</span> X-Frame-Options <span class="token string">"SAMEORIGIN"</span> always</span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">add_header</span> X-XSS-Protection <span class="token string">"1; mode=block"</span> always</span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">add_header</span> X-Content-Type-Options <span class="token string">"nosniff"</span> always</span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">add_header</span> Referrer-Policy <span class="token string">"no-referrer-when-downgrade"</span> always</span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">add_header</span> Content-Security-Policy <span class="token string">"default-src * data: 'unsafe-eval' 'unsafe-inline'"</span> always</span><span class="token punctuation">;</span>
    <span class="token comment">#add_header Strict-Transport-Security "max-age=31536000; includeSubDomains; preload" always;</span>
    <span class="token comment"># enable strict transport security only if you understand the implications</span>
  <span class="token punctuation">&#125;</span>

  <span class="token directive"><span class="token keyword">location</span> @tracker-http</span>
  <span class="token punctuation">&#123;</span>
    <span class="token directive"><span class="token keyword">proxy_pass</span> http://tracker:7070</span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">add_header</span> X-Frame-Options <span class="token string">"SAMEORIGIN"</span> always</span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">add_header</span> X-XSS-Protection <span class="token string">"1; mode=block"</span> always</span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">add_header</span> X-Content-Type-Options <span class="token string">"nosniff"</span> always</span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">add_header</span> Referrer-Policy <span class="token string">"no-referrer-when-downgrade"</span> always</span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">add_header</span> Content-Security-Policy <span class="token string">"default-src * data: 'unsafe-eval' 'unsafe-inline'"</span> always</span><span class="token punctuation">;</span>
    <span class="token comment">#add_header Strict-Transport-Security "max-age=31536000; includeSubDomains; preload" always;</span>
    <span class="token comment"># enable strict transport security only if you understand the implications</span>

    <span class="token directive"><span class="token keyword">proxy_set_header</span> X-Forwarded-For <span class="token variable">$proxy_add_x_forwarded_for</span></span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>

  <span class="token directive"><span class="token keyword">root</span> /var/www/html</span><span class="token punctuation">;</span>
  <span class="token directive"><span class="token keyword">index</span> index.html index.htm index.nginx-debian.html</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span></code><!-- HTML_TAG_END --></pre></div></div> <p data-svelte-h="svelte-b4z69l">Make sure you also change the domains:</p> <ul data-svelte-h="svelte-1gfj7cg"><li>index.torrust-demo.com</li> <li>tracker.torrust-demo.com</li></ul> <p data-svelte-h="svelte-vpc8yu">You also have to change the API base URL in the <code>.env</code> file:</p> <pre class="language-text"><!-- HTML_TAG_START --><code class="language-text">TORRUST_INDEX_GUI_API_BASE_URL=https://index.torrust-demo.com/api/v1</code><!-- HTML_TAG_END --></pre> <p data-svelte-h="svelte-aivotr">Replace it from <code>http://index.torrust-demo.com/api/v1</code> to <code>https://index.torrust-demo.com/api/v1</code>.</p> <p data-svelte-h="svelte-1crqqiv">After changing the Nginx configuration you need to restart the Nginx server:</p> <div class="code-block svelte-11qxx87"> <div class="lang svelte-11qxx87">bash</div> <button class="copy-button copy-button-gray svelte-11qxx87"></button> <div class="code-content"><pre class="language-bash"><!-- HTML_TAG_START --><code class="language-bash"><span class="token function">docker</span> compose <span class="token parameter variable">--ansi</span> never restart proxy</code><!-- HTML_TAG_END --></pre></div></div> <h3 id="setup-cronjob-to-renew-certificates" data-svelte-h="svelte-1kcbweb"><a class="heading-link" title="Permalink" aria-hidden="true" href="#setup-cronjob-to-renew-certificates"><span>#</span></a>Setup Cronjob To Renew Certificates</h3> <p data-svelte-h="svelte-ds65v7">Certificates expire, so we’ll set up an automatic renewal system, like a subscription that renews itself. We will set up an automate SSL certificate renewal using cronjobs to maintain continuous security.</p> <p data-svelte-h="svelte-el7wb5">We will use crontab to execute a command every day:</p> <div class="code-block svelte-11qxx87"> <div class="lang svelte-11qxx87">bash</div> <button class="copy-button copy-button-gray svelte-11qxx87"></button> <div class="code-content"><pre class="language-bash"><!-- HTML_TAG_START --><code class="language-bash"><span class="token function">sudo</span> <span class="token function">crontab</span> <span class="token parameter variable">-e</span></code><!-- HTML_TAG_END --></pre></div></div> <p data-svelte-h="svelte-254yos">Add the following crontab line:</p> <div class="code-block svelte-11qxx87"> <div class="lang svelte-11qxx87">text</div> <button class="copy-button copy-button-gray svelte-11qxx87"></button> <div class="code-content"><pre class="language-text"><!-- HTML_TAG_START --><code class="language-text">0 12 * * * /home/torrust/github/torrust/torrust-compose/droplet/bin/ssl_renew.sh >> /var/log/cron.log 2>&amp;1</code><!-- HTML_TAG_END --></pre></div></div> <p data-svelte-h="svelte-pebjgs">You can check the cronjob output with:</p> <div class="code-block svelte-11qxx87"> <div class="lang svelte-11qxx87">bash</div> <button class="copy-button copy-button-gray svelte-11qxx87"></button> <div class="code-content"><pre class="language-bash"><!-- HTML_TAG_START --><code class="language-bash"><span class="token function">tail</span> <span class="token parameter variable">-f</span> /var/log/cron.log</code><!-- HTML_TAG_END --></pre></div></div> <p data-svelte-h="svelte-1t6fbuj">After generating the certificates and renewing them you should have a certbot directory structure similar to this:</p> <div class="code-block svelte-11qxx87"> <div class="lang svelte-11qxx87">bash</div> <button class="copy-button copy-button-gray svelte-11qxx87"></button> <div class="code-content"><pre class="language-bash"><!-- HTML_TAG_START --><code class="language-bash">$ <span class="token function">sudo</span> tree storage/certbot/
<span class="token punctuation">[</span>sudo<span class="token punctuation">]</span> password <span class="token keyword">for</span> torrust:
storage/certbot/
├── etc
│   ├── accounts
│   │   ├── acme-staging-v02.api.letsencrypt.org
│   │   │   └── directory
│   │   │       └── b39c03e978*****df8366ab6539
│   │   │           ├── meta.json
│   │   │           ├── private_key.json
│   │   │           └── regr.json
│   │   └── acme-v02.api.letsencrypt.org
│   │       └── directory
│   │           └── 441a435b0f8*****cc6dd22f34468
│   │               ├── meta.json
│   │               ├── private_key.json
│   │               └── regr.json
│   ├── archive
│   │   ├── index.torrust-demo.com
│   │   │   ├── cert1.pem
│   │   │   ├── chain1.pem
│   │   │   ├── fullchain1.pem
│   │   │   └── privkey1.pem
│   │   ├── index.torrust-demo.com-0001
│   │   │   ├── cert1.pem
│   │   │   ├── cert2.pem
│   │   │   ├── chain1.pem
│   │   │   ├── chain2.pem
│   │   │   ├── fullchain1.pem
│   │   │   ├── fullchain2.pem
│   │   │   ├── privkey1.pem
│   │   │   └── privkey2.pem
│   │   └── tracker.torrust-demo.com
│   │       ├── cert1.pem
│   │       ├── cert2.pem
│   │       ├── cert3.pem
│   │       ├── chain1.pem
│   │       ├── chain2.pem
│   │       ├── chain3.pem
│   │       ├── fullchain1.pem
│   │       ├── fullchain2.pem
│   │       ├── fullchain3.pem
│   │       ├── privkey1.pem
│   │       ├── privkey2.pem
│   │       └── privkey3.pem
│   ├── live
│   │   ├── README
│   │   ├── index.torrust-demo.com
│   │   │   ├── README
│   │   │   ├── cert.pem -<span class="token operator">></span> <span class="token punctuation">..</span>/<span class="token punctuation">..</span>/archive/index.torrust-demo.com/cert1.pem
│   │   │   ├── chain.pem -<span class="token operator">></span> <span class="token punctuation">..</span>/<span class="token punctuation">..</span>/archive/index.torrust-demo.com/chain1.pem
│   │   │   ├── fullchain.pem -<span class="token operator">></span> <span class="token punctuation">..</span>/<span class="token punctuation">..</span>/archive/index.torrust-demo.com/fullchain1.pem
│   │   │   └── privkey.pem -<span class="token operator">></span> <span class="token punctuation">..</span>/<span class="token punctuation">..</span>/archive/index.torrust-demo.com/privkey1.pem
│   │   ├── index.torrust-demo.com-0001
│   │   │   ├── README
│   │   │   ├── cert.pem -<span class="token operator">></span> <span class="token punctuation">..</span>/<span class="token punctuation">..</span>/archive/index.torrust-demo.com-0001/cert2.pem
│   │   │   ├── chain.pem -<span class="token operator">></span> <span class="token punctuation">..</span>/<span class="token punctuation">..</span>/archive/index.torrust-demo.com-0001/chain2.pem
│   │   │   ├── fullchain.pem -<span class="token operator">></span> <span class="token punctuation">..</span>/<span class="token punctuation">..</span>/archive/index.torrust-demo.com-0001/fullchain2.pem
│   │   │   └── privkey.pem -<span class="token operator">></span> <span class="token punctuation">..</span>/<span class="token punctuation">..</span>/archive/index.torrust-demo.com-0001/privkey2.pem
│   │   └── tracker.torrust-demo.com
│   │       ├── README
│   │       ├── cert.pem -<span class="token operator">></span> <span class="token punctuation">..</span>/<span class="token punctuation">..</span>/archive/tracker.torrust-demo.com/cert3.pem
│   │       ├── chain.pem -<span class="token operator">></span> <span class="token punctuation">..</span>/<span class="token punctuation">..</span>/archive/tracker.torrust-demo.com/chain3.pem
│   │       ├── fullchain.pem -<span class="token operator">></span> <span class="token punctuation">..</span>/<span class="token punctuation">..</span>/archive/tracker.torrust-demo.com/fullchain3.pem
│   │       └── privkey.pem -<span class="token operator">></span> <span class="token punctuation">..</span>/<span class="token punctuation">..</span>/archive/tracker.torrust-demo.com/privkey3.pem
│   ├── renewal
│   │   ├── index.torrust-demo.com-0001.conf
│   │   ├── index.torrust-demo.com.conf
│   │   └── tracker.torrust-demo.com.conf
│   └── renewal-hooks
│       ├── deploy
│       ├── post
│       └── pre
└── lib

<span class="token number">22</span> directories, <span class="token number">49</span> files</code><!-- HTML_TAG_END --></pre></div></div> <h2 id="exposed-services" data-svelte-h="svelte-48ebsd"><a class="heading-link" title="Permalink" aria-hidden="true" href="#exposed-services"><span>#</span></a>Exposed services</h2> <p data-svelte-h="svelte-1pc2bld">After finishing the instalaltion the main available services are:</p> <ul data-svelte-h="svelte-1biu1k0"><li>The Index: <a href="http://index.torrust-demo.com/" rel="nofollow">http://index.torrust-demo.com/</a></li> <li>The HTTP Tracker: <a href="https://tracker.torrust-demo.com/announce" rel="nofollow">https://tracker.torrust-demo.com/announce</a></li> <li>The UDP Tracker: <a href="udp://tracker.torrust-demo.com:6969/announce">udp://tracker.torrust-demo.com:6969/announce</a></li></ul> <p data-svelte-h="svelte-5q9hh8">But there are some other exposed ports. In addition to the SSH port (22), when you run the container you’ll expose all the following ports on the server:</p> <ul data-svelte-h="svelte-1qll13y"><li>80 (proxy)</li> <li>443 (proxy)</li> <li>3001 (index-gui)</li> <li>3000 (index)</li> <li>6969 (tracker)</li> <li>7070 (tracker)</li> <li>1212 (tracker)</li></ul> <p data-svelte-h="svelte-1scudva">You should have access to all exposed services by default.</p> <p data-svelte-h="svelte-6ax34j">You should be able to access the services directly (with no proxy) connecting to the containers:</p> <ul data-svelte-h="svelte-16yb0ke"><li>Index GUI (webapp): <a href="http://index.torrust-demo.com:3000" rel="nofollow">http://index.torrust-demo.com:3000</a></li> <li>Index (API): <a href="http://tracker.torrust-demo.com:3001" rel="nofollow">http://tracker.torrust-demo.com:3001</a></li> <li>Tracker (HTTP): <a href="http://tracker.torrust-demo.com:7070/announce" rel="nofollow">http://tracker.torrust-demo.com:7070/announce</a></li> <li>Tracker (UDP): udp://tracker.torrust-demo.com:6969</li> <li>Tracker (API): <a href="http://tracker.torrust-demo.com:1212" rel="nofollow">http://tracker.torrust-demo.com:1212</a></li></ul> <p data-svelte-h="svelte-ajgwh5">But you should also be able to connect to all services except the UDP Tracker via the Nginx proxy both with HTTP
or HTTPs:</p> <p data-svelte-h="svelte-1p0yt7j">HTTP access to services via proxy:</p> <ul data-svelte-h="svelte-qcct0u"><li><p>Index GUI (webapp): <a href="http://index.torrust-demo.com" rel="nofollow">http://index.torrust-demo.com</a></p></li> <li><p>Index (API): <a href="http://index.torrust-demo.com/api" rel="nofollow">http://index.torrust-demo.com/api</a></p></li> <li><p>Tracker (HTTP): <a href="http://tracker.torrust-demo.com/announce" rel="nofollow">http://tracker.torrust-demo.com/announce</a></p></li> <li><p>Tracker (API): <a href="http://tracker.torrust-demo.com/api" rel="nofollow">http://tracker.torrust-demo.com/api</a></p></li></ul> <p data-svelte-h="svelte-14y9mds">HTTPs access to services via proxy:</p> <ul data-svelte-h="svelte-168ip3o"><li><p>Index GUI (webapp): <a href="https://index.torrust-demo.com" rel="nofollow">https://index.torrust-demo.com</a></p></li> <li><p>Index (API): <a href="https://index.torrust-demo.com/api" rel="nofollow">https://index.torrust-demo.com/api</a></p></li> <li><p>Tracker (HTTP): <a href="https://tracker.torrust-demo.com/announce" rel="nofollow">https://tracker.torrust-demo.com/announce</a></p></li> <li><p>Tracker (API): <a href="https://tracker.torrust-demo.com/api" rel="nofollow">https://tracker.torrust-demo.com/api</a></p></li></ul> <p data-svelte-h="svelte-2tutof">You can disable both, direct access to the container (without using the Nginx proxy) and also access without certificates (HTTP). In that case you only need to expose port: <code>443</code> and <code>6969</code>. In order to do that you will
need to enable a firewall on the server or the Digital Ocean firewall.</p> <div class="callout-block info svelte-sxx0n0"><div class="icon-wrapper svelte-sxx0n0"><svg width="100%" height="100%" stroke-width="1.5" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 11.5V16.5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path d="M12 7.51L12.01 7.49889" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path d="M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path></svg></div> Notice: The UDP tracker is not available via the proxy. If you want all requests to go through the
  proxy you need to change the Nginx configuration to set up a UDP proxy. There is a discussion
  on the Tracker repository on GitHub about how to setup the proxy for the UDP tracker.</div> <h3 id="firewall" data-svelte-h="svelte-i8d4dt"><a class="heading-link" title="Permalink" aria-hidden="true" href="#firewall"><span>#</span></a>Firewall</h3> <p data-svelte-h="svelte-ogbeo">By default there is no firewall on the server. If you want to enable the firewall you have two options:</p> <ul data-svelte-h="svelte-yg13nw"><li><a href="https://www.digitalocean.com/community/tutorials/how-to-set-up-a-firewall-with-ufw-on-ubuntu-22-04" rel="nofollow">Setup your own firewall on the server</a>.</li> <li><a href="https://docs.digitalocean.com/products/networking/firewalls/getting-started/quickstart/" rel="nofollow">Enable the Digital Ocean firewall</a>.</li></ul> <p data-svelte-h="svelte-kmoeiz">You can enable the UFW firewall on the server by following the Digital Ocean guide:</p> <p data-svelte-h="svelte-wepyce"><a href="https://www.digitalocean.com/community/tutorials/how-to-set-up-a-firewall-with-ufw-on-ubuntu-22-04" rel="nofollow">How To Set Up a Firewall with UFW on Ubuntu 22.04</a>.</p> <p data-svelte-h="svelte-1loho9w">For example, you can allow only the ports <code>22</code>, <code>43</code> and <code>6969</code> with the following command:</p> <div class="code-block svelte-11qxx87"> <div class="lang svelte-11qxx87">bash</div> <button class="copy-button copy-button-gray svelte-11qxx87"></button> <div class="code-content"><pre class="language-bash"><!-- HTML_TAG_START --><code class="language-bash"><span class="token function">sudo</span> ufw default deny incoming
<span class="token function">sudo</span> ufw default allow outgoing
<span class="token function">sudo</span> ufw allow <span class="token function">ssh</span>
<span class="token function">sudo</span> ufw allow <span class="token number">443</span>
<span class="token function">sudo</span> ufw allow <span class="token number">6969</span>/udp
<span class="token function">sudo</span> ufw <span class="token builtin class-name">enable</span>
<span class="token function">sudo</span> ufw status verbose</code><!-- HTML_TAG_END --></pre></div></div> <div class="callout-block info svelte-sxx0n0"><div class="icon-wrapper svelte-sxx0n0"><svg width="100%" height="100%" stroke-width="1.5" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 11.5V16.5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path d="M12 7.51L12.01 7.49889" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path d="M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path></svg></div> However, there is a problem with setting up your own firewall. By default, Docker manipulates iptables to set up network isolation. However, this can interfere with UFW. To fix this, you need to tell Docker not to modify iptables.</div> <h3 id="health-checks" data-svelte-h="svelte-1pfvxou"><a class="heading-link" title="Permalink" aria-hidden="true" href="#health-checks"><span>#</span></a>Health checks</h3> <p data-svelte-h="svelte-1yq9drv">Some services expose public health check endpoints.</p> <p data-svelte-h="svelte-6kq4xr">Via proxy (HTTP):</p> <ul data-svelte-h="svelte-1ajx2es"><li>Index API: <a href="http://index.torrust-demo.com/api/health_check" rel="nofollow">http://index.torrust-demo.com/api/health_check</a></li> <li>Tracker API: <a href="http://tracker.torrust-demo.com/api/health_check" rel="nofollow">http://tracker.torrust-demo.com/api/health_check</a></li> <li>Tracker HTTP: <a href="http://tracker.torrust-demo.com/health_check" rel="nofollow">http://tracker.torrust-demo.com/health_check</a></li></ul> <p data-svelte-h="svelte-xo4ab2">Via proxy (HTTPs):</p> <ul data-svelte-h="svelte-1ljr93f"><li>Index: <a href="https://index.torrust-demo.com/api/health_check" rel="nofollow">https://index.torrust-demo.com/api/health_check</a></li> <li>Tracker API: <a href="https://tracker.torrust-demo.com/api/health_check" rel="nofollow">https://tracker.torrust-demo.com/api/health_check</a></li> <li>Tracker HTTPs: <a href="https://tracker.torrust-demo.com/health_check" rel="nofollow">https://tracker.torrust-demo.com/health_check</a></li></ul> <p data-svelte-h="svelte-1fvfa7z">Direct access:</p> <ul data-svelte-h="svelte-e687zk"><li>Index API: <a href="http://tracker.torrust-demo.com:3001/health_check" rel="nofollow">http://tracker.torrust-demo.com:3001/health_check</a></li> <li>Tracker API: <a href="http://tracker.torrust-demo.com:1212/health_check" rel="nofollow">http://tracker.torrust-demo.com:1212/health_check</a></li> <li>Tracker HTTP: <a href="http://tracker.torrust-demo.com:7070/health_check" rel="nofollow">http://tracker.torrust-demo.com:7070/health_check</a></li></ul> <div class="callout-block info svelte-sxx0n0"><div class="icon-wrapper svelte-sxx0n0"><svg width="100%" height="100%" stroke-width="1.5" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 11.5V16.5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path d="M12 7.51L12.01 7.49889" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path d="M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path></svg></div> These endpoints are very useful to test if your installation is OK.</div> <h2 id="troubleshooting" data-svelte-h="svelte-2s3f5p"><a class="heading-link" title="Permalink" aria-hidden="true" href="#troubleshooting"><span>#</span></a>Troubleshooting</h2> <p data-svelte-h="svelte-ax5yuc">You might have problems setting up the application. There are some useful things you should know
in order to be able to address potential problems.</p> <p data-svelte-h="svelte-o6x4qt">First, it might be useful to enable the debug logging for some services. Both the Index and the Tracker
have a configuration option <code>log_level = &quot;info&quot;</code>. You can change the logging level to <code>debug</code> or even <code>trace</code>.</p> <p data-svelte-h="svelte-51udfm">Configuration files are located in:</p> <ul data-svelte-h="svelte-1wxrdno"><li><code>./storage/index/etc/index.toml</code>.</li> <li><code>./storage/tracker/etc/tracker.toml</code>.</li></ul> <p data-svelte-h="svelte-30yl3m">If you change the config files you will need to restart the services:</p> <div class="code-block svelte-11qxx87"> <div class="lang svelte-11qxx87">bash</div> <button class="copy-button copy-button-gray svelte-11qxx87"></button> <div class="code-content"><pre class="language-bash"><!-- HTML_TAG_START --><code class="language-bash"><span class="token function">docker</span> compose restart</code><!-- HTML_TAG_END --></pre></div></div> <p data-svelte-h="svelte-1q5ghpo">You can also check the logs of any service with:</p> <div class="code-block svelte-11qxx87"> <div class="lang svelte-11qxx87">bash</div> <button class="copy-button copy-button-gray svelte-11qxx87"></button> <div class="code-content"><pre class="language-bash"><!-- HTML_TAG_START --><code class="language-bash"><span class="token function">docker</span> compose logs proxy
<span class="token function">docker</span> compose logs certbot
<span class="token function">docker</span> compose logs index
<span class="token function">docker</span> compose logs index-gui
<span class="token function">docker</span> compose logs tracker</code><!-- HTML_TAG_END --></pre></div></div> <p data-svelte-h="svelte-1jdvk2u">If you change the config files you will need to restart the services.</p> <p data-svelte-h="svelte-qbolzt">You can also enable the debug for the Nginx proxy. Edit the file <code>./storage/proxy/etc/nginx-conf/nginx.conf</code> and add <code>error_log</code> to the server configuration:</p> <div class="code-block svelte-11qxx87"> <div class="lang svelte-11qxx87">nginx</div> <button class="copy-button copy-button-gray svelte-11qxx87"></button> <div class="code-content"><pre class="language-nginx"><!-- HTML_TAG_START --><code class="language-nginx"><span class="token directive"><span class="token keyword">server</span></span>
<span class="token punctuation">&#123;</span>
    <span class="token directive"><span class="token keyword">listen</span> <span class="token number">443</span> ssl http2</span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">listen</span> [::]:443 ssl http2</span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">server_name</span> index.torrust-demo.com</span><span class="token punctuation">;</span>

    <span class="token directive"><span class="token keyword">error_log</span> /var/log/nginx/error.log debug</span><span class="token punctuation">;</span>

    ...
<span class="token punctuation">&#125;</span></code><!-- HTML_TAG_END --></pre></div></div> <p data-svelte-h="svelte-pqdj5w">If your server does not have too much disk space you could run out of disk space.</p> <p data-svelte-h="svelte-40sbj9">Docker stores the logs in a separate directory, if you want to truncate the logs you can find them first with:</p> <div class="code-block svelte-11qxx87"> <div class="lang svelte-11qxx87">bash</div> <button class="copy-button copy-button-gray svelte-11qxx87"></button> <div class="code-content"><pre class="language-bash"><!-- HTML_TAG_START --><code class="language-bash"><span class="token function">sudo</span> <span class="token builtin class-name">:</span> <span class="token operator">></span> <span class="token variable"><span class="token variable">$(</span><span class="token function">docker</span> inspect <span class="token parameter variable">--format</span><span class="token operator">=</span><span class="token string">'&#123;&#123;.LogPath&#125;&#125;'</span> tracker<span class="token variable">)</span></span>
-bash: /var/lib/docker/containers/397484cca9572d98524e4f81095bb27f90c349306c39bc517afe5bcb3a6d7f5e/397484cca9572d98524e4f81095bb27f90c349306c39bc517afe5bcb3a6d7f5e-json.log: Permission denied</code><!-- HTML_TAG_END --></pre></div></div> <p data-svelte-h="svelte-1xly7ax">And then truncate the file with:</p> <div class="code-block svelte-11qxx87"> <div class="lang svelte-11qxx87">bash</div> <button class="copy-button copy-button-gray svelte-11qxx87"></button> <div class="code-content"><pre class="language-bash"><!-- HTML_TAG_START --><code class="language-bash"><span class="token function">sudo</span> truncate <span class="token parameter variable">-s</span> <span class="token number">0</span> /var/lib/docker/containers/397484cca9572d98524e4f81095bb27f90c349306c39bc517afe5bcb3a6d7f5e/397484cca9572d98524e4f81095bb27f90c349306c39bc517afe5bcb3a6d7f5e-json.log</code><!-- HTML_TAG_END --></pre></div></div> <p data-svelte-h="svelte-1c5ztdz">The docker compose configuration sets a limit on the number of log files and their size.</p> <p data-svelte-h="svelte-x4ieeu">Finally, if you need some URL to test the HTTP tracker you can use these ones:</p> <ul data-svelte-h="svelte-1pyl43x"><li>Announce request: <a href="https://tracker.torrust-demo.com/announce?info_hash=%44%3C%76%02%B4%FD%E8%3D%11%54%D6%D9%DA%48%80%84%18%B1%81%B6&amp;peer_addr=2.137.87.41&amp;downloaded=0&amp;uploaded=0&amp;peer_id=-qB00000000000000001&amp;port=17548&amp;left=0&amp;event=completed&amp;compact=0" rel="nofollow">https://tracker.torrust-demo.com/announce?info_hash=%44%3C%76%02%B4%FD%E8%3D%11%54%D6%D9%DA%48%80%84%18%B1%81%B6&amp;peer_addr=2.137.87.41&amp;downloaded=0&amp;uploaded=0&amp;peer_id=-qB00000000000000001&amp;port=17548&amp;left=0&amp;event=completed&amp;compact=0</a></li> <li>Scrape request: <a href="https://tracker.torrust-demo.com/scrape?info_hash=%44%3C%76%02%B4%FD%E8%3D%11%54%D6%D9%DA%48%80%84%18%B1%81%B6" rel="nofollow">https://tracker.torrust-demo.com/scrape?info_hash=%44%3C%76%02%B4%FD%E8%3D%11%54%D6%D9%DA%48%80%84%18%B1%81%B6</a></li></ul> <p data-svelte-h="svelte-lmmkiu">The infohash used is <code>443C7602B4FDE83D1154D6D9DA48808418B181B6</code>.</p> <h2 id="maintenance" data-svelte-h="svelte-mogi0a"><a class="heading-link" title="Permalink" aria-hidden="true" href="#maintenance"><span>#</span></a>Maintenance</h2> <h3 id="backups" data-svelte-h="svelte-d0a5l2"><a class="heading-link" title="Permalink" aria-hidden="true" href="#backups"><span>#</span></a>Backups</h3> <p data-svelte-h="svelte-1te7x1f">All the data used by the application is in the <code>storage</code> folder.</p> <p data-svelte-h="svelte-t1o99j">We are using SQLite so the only thing we need to do is to backup the database files.</p> <ul data-svelte-h="svelte-zxwgiw"><li>Index database: <code>index/lib/database/sqlite3.db</code></li> <li>Tracker database: <code>tracker/lib/database/sqlite3.db</code></li></ul> <p data-svelte-h="svelte-olrpu9">We enabled backups for the droplet when we created it. Droplet backups are generated
once per week. You should setup a better backup policy or use a MySQL service that provides backup.
An easy way to increase the number of backups would be to mount a volume and periodically backup the files
you want to backup, for example the database files or the configuration files.</p> <p data-svelte-h="svelte-1nkmtva">Alternatively, you can use <a href="https://docs.digitalocean.com/developer-center/droplets-and-volumes-backups-with-snapshooter/" rel="nofollow">SnapShooter to backup droplets and volumes</a>.</p> <p data-svelte-h="svelte-7p1mu4">How to setup a proper backup policy is out of the scope of this tutorial.</p> <h3 id="monitoring" data-svelte-h="svelte-17fd9jj"><a class="heading-link" title="Permalink" aria-hidden="true" href="#monitoring"><span>#</span></a>Monitoring</h3> <p data-svelte-h="svelte-153j7wi">It’s important to know the state of your services. Digital Ocean allow you to set:</p> <ul data-svelte-h="svelte-olqmpi"><li>Resource alerts</li> <li>Uptime checks</li></ul> <p data-svelte-h="svelte-1q6dx3g">We have set up both.</p> <p data-svelte-h="svelte-mj1xlf">With the “resource alerts” you can be notified when the droplet is having trouble with the resources (memory, CPU, disk or bandwidth).</p> <img srcset="/images/posts/deploying-torrust-to-production/digital-ocean-monitoring-resource-alerts.png, /images/posts/deploying-torrust-to-production/digital-ocean-monitoring-resource-alerts.png, /images/posts/deploying-torrust-to-production/digital-ocean-monitoring-resource-alerts.png" src="/images/posts/deploying-torrust-to-production/digital-ocean-monitoring-resource-alerts.png" alt="Create" loading="lazy" decoding="async" class="svelte-1ykl0dj"> <p data-svelte-h="svelte-1v0fopu">And “uptime checks” can be used to monitor the state of the services.</p> <img srcset="/images/posts/deploying-torrust-to-production/digital-ocean-monitoring-uptime.png, /images/posts/deploying-torrust-to-production/digital-ocean-monitoring-uptime.png, /images/posts/deploying-torrust-to-production/digital-ocean-monitoring-uptime.png" src="/images/posts/deploying-torrust-to-production/digital-ocean-monitoring-uptime.png" alt="Create" loading="lazy" decoding="async" class="svelte-1ykl0dj"> <p data-svelte-h="svelte-8z1d4n">We used the health check endpoints for some services like APIs and the HTTP tracker.</p> <h2 id="cost" data-svelte-h="svelte-86dcoy"><a class="heading-link" title="Permalink" aria-hidden="true" href="#cost"><span>#</span></a>Cost</h2> <ul data-svelte-h="svelte-1kybchl"><li>Basic droplet (1GB/1CPU, 25GB SSD Disk, 1000GB transfer): <strong>$6</strong> per month.</li> <li>Weekly droplet backup: <strong>$1.20</strong> per month.</li> <li>Reserved IP: <strong>$5.00</strong> per month.</li> <li>Domain: depends on your provider.</li></ul> <p data-svelte-h="svelte-1vxchds">Total cost: <strong>$12.2</strong> per month.</p> <p data-svelte-h="svelte-1ir26c8">See <a href="https://www.digitalocean.com/pricing" rel="nofollow">Digital Ocean pricing</a> for more information.</p> <h2 id="other-considerations" data-svelte-h="svelte-12m3v1c"><a class="heading-link" title="Permalink" aria-hidden="true" href="#other-considerations"><span>#</span></a>Other Considerations</h2> <h3 id="adding-the-tracker-to-public-lists" data-svelte-h="svelte-1rf8ibq"><a class="heading-link" title="Permalink" aria-hidden="true" href="#adding-the-tracker-to-public-lists"><span>#</span></a>Adding The Tracker To Public Lists</h3> <p data-svelte-h="svelte-8tcue5">If you are interested in, you can add your tracker to some tracker lists, for example: <a href="https://newtrackon.com" rel="nofollow">https://newtrackon.com</a>.</p> <h3 id="sending-emails" data-svelte-h="svelte-15ilxqw"><a class="heading-link" title="Permalink" aria-hidden="true" href="#sending-emails"><span>#</span></a>Sending Emails</h3> <p data-svelte-h="svelte-31tyot">We have not enabled email verification. If you enable it you will need to configure the SMTP server in the Index configuration:</p> <div class="code-block svelte-11qxx87"> <div class="lang svelte-11qxx87">toml</div> <button class="copy-button copy-button-gray svelte-11qxx87"></button> <div class="code-content"><pre class="language-toml"><!-- HTML_TAG_START --><code class="language-toml"><span class="token punctuation">[</span><span class="token table class-name">mail</span><span class="token punctuation">]</span>
<span class="token key property">email_verification_enabled</span> <span class="token punctuation">=</span> <span class="token boolean">false</span>
<span class="token key property">from</span> <span class="token punctuation">=</span> <span class="token string">"example@email.com"</span>
<span class="token key property">reply_to</span> <span class="token punctuation">=</span> <span class="token string">"noreply@email.com"</span>
<span class="token key property">username</span> <span class="token punctuation">=</span> <span class="token string">""</span>
<span class="token key property">password</span> <span class="token punctuation">=</span> <span class="token string">""</span>
<span class="token key property">server</span> <span class="token punctuation">=</span> <span class="token string">"mailcatcher"</span>
<span class="token key property">port</span> <span class="token punctuation">=</span> <span class="token number">1025</span></code><!-- HTML_TAG_END --></pre></div></div> <h3 id="docker-image-tags" data-svelte-h="svelte-d1hppf"><a class="heading-link" title="Permalink" aria-hidden="true" href="#docker-image-tags"><span>#</span></a>Docker Image Tags</h3> <p data-svelte-h="svelte-mkbqhg">We have used the <code>develop</code> tag for the Docker images. We will update this guide to use version <code>v3.0</code> once it’s released.</p> <h2 id="links" data-svelte-h="svelte-32dd6s"><a class="heading-link" title="Permalink" aria-hidden="true" href="#links"><span>#</span></a>Links</h2> <ul data-svelte-h="svelte-15qc73f"><li><a href="https://www.digitalocean.com/community/tutorials/how-to-secure-a-containerized-node-js-application-with-nginx-let-s-encrypt-and-docker-compose" rel="nofollow">How To Secure a Containerized Node.js Application with Nginx, Let’s Encrypt, and Docker Compose</a></li> <li><a href="https://www.digitalocean.com/community/tutorials/initial-server-setup-with-ubuntu-22-04" rel="nofollow">Initial Server Setup with Ubuntu 22.04</a></li> <li><a href="https://www.digitalocean.com/community/tutorials/how-to-set-up-ssh-keys-on-ubuntu-22-04" rel="nofollow">How to Set Up SSH Keys on Ubuntu 22.04</a></li> <li><a href="https://www.digitalocean.com/community/tutorials/how-to-install-and-use-docker-on-ubuntu-22-04" rel="nofollow">How To Install and Use Docker on Ubuntu 22.04</a></li> <li><a href="https://www.digitalocean.com/community/tutorials/how-to-install-and-use-docker-compose-on-ubuntu-22-04" rel="nofollow">How To Install and Use Docker Compose on Ubuntu 22.04</a></li> <li><a href="https://www.digitalocean.com/community/tutorials/how-to-set-up-a-firewall-with-ufw-on-ubuntu-22-04" rel="nofollow">How To Set Up a Firewall with UFW on Ubuntu 22.04</a></li> <li><a href="https://www.digitalocean.com/community/tutorials/how-to-install-git-on-ubuntu-22-04" rel="nofollow">How To Install Git on Ubuntu 22.04</a></li> <li><a href="https://www.digitalocean.com/community/tutorials/how-to-set-up-a-firewall-with-ufw-on-ubuntu-22-04" rel="nofollow">How To Set Up a Firewall with UFW on Ubuntu 22.04</a></li> <li><a href="https://www.bittorrent.org/beps/bep_0034.html" rel="nofollow">BEP 34 DNS Tracker Preferences</a></li> <li><a href="https://letsencrypt.org/" rel="nofollow">https://letsencrypt.org/</a></li> <li><a href="https://certbot.eff.org/" rel="nofollow">https://certbot.eff.org/</a></li> <li><a href="https://github.com/torrust/torrust-tracker/issues/11" rel="nofollow">UDP Tracker with Nginx proxy</a></li> <li><a href="https://docs.digitalocean.com/products/images/backups/details/features/" rel="nofollow">Digital Ocean - Backups Features</a>.</li> <li><a href="https://docs.digitalocean.com/developer-center/droplets-and-volumes-backups-with-snapshooter/" rel="nofollow">Droplets and Volumes Backups with SnapShooter</a></li> <li><a href="https://www.digitalocean.com/pricing" rel="nofollow">Digital Ocean pricing</a></li></ul> <h2 id="conclusion" data-svelte-h="svelte-br5ox0"><a class="heading-link" title="Permalink" aria-hidden="true" href="#conclusion"><span>#</span></a>Conclusion</h2> <p data-svelte-h="svelte-gy8emo">With containerization, having a production ready Index and Tracker with Torrust is very easy. Containerization allows you to install the application in many different hosting providers with no effort.</p> <p data-svelte-h="svelte-30klad">It also allows you to keep your production environment up to date, because it’s also possible to easily update the docker images.</p> <p data-svelte-h="svelte-km643h">And finally, you can also scale up your production environment as long as the demand increases. For example, just increasing the droplet size.</p> <p data-svelte-h="svelte-1e29q46">We hope you find this guide useful. Let us know what you think about it!</p> <ul data-svelte-h="svelte-hqjduw"><li>Do you think the process is to complex?</li> <li>Do you think the process could be improved or simplified?</li> <li>Is there something missing you want to know about?</li></ul> <p data-svelte-h="svelte-gxsd2p">If you see something wrong or you want to contribute by:</p> <ul data-svelte-h="svelte-1pxkwtk"><li>Adding new sections.</li> <li>Fixing typos.</li> <li>Making it clearer.</li> <li>Adding links.</li> <li>Or whatever you think that could be interesting to have,</li></ul> <p data-svelte-h="svelte-1cyks1i">please open an <a href="https://github.com/torrust/torrust-website/issues" rel="nofollow">issue</a> or a <a href="https://github.com/torrust/torrust-website/pulls" rel="nofollow">PR</a>.</p> <p data-svelte-h="svelte-jnq0pp">If you have any questions or issues please open an issue in the corresponding repository:</p> <ul data-svelte-h="svelte-316cp7"><li>Torrust Tracker: <a href="https://github.com/torrust/torrust-tracker/issues" rel="nofollow">https://github.com/torrust/torrust-tracker/issues</a></li> <li>Torrust Index: <a href="https://github.com/torrust/torrust-index-backend/issues" rel="nofollow">https://github.com/torrust/torrust-index-backend/issues</a></li> <li>Torrust Website: <a href="https://github.com/torrust/torrust-index-frontend/issues" rel="nofollow">https://github.com/torrust/torrust-index-frontend/issues</a></li> <li>Torrust Compose: <a href="https://github.com/torrust/torrust-compose" rel="nofollow">https://github.com/torrust/torrust-compose</a></li> <li>Containerizing Rust Applications Examples: <a href="https://github.com/torrust/containerizing-rust-apps-examples" rel="nofollow">https://github.com/torrust/containerizing-rust-apps-examples</a></li></ul> <p data-svelte-h="svelte-nld7t3">We very welcome any contributions to the projects or <a href="https://github.com/torrust/torrust-website/issues" rel="nofollow">this article</a>.</p></div></div>
          ]]></content:encoded>
          <media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://v2.torrust.com//images/posts/deploying-torrust-to-production/deploy-torrust-to-a-digital-ocean-droplet.png"/>
          <media:content xmlns:media="http://search.yahoo.com/mrss/" medium="image" url="https://v2.torrust.com//images/posts/deploying-torrust-to-production/deploy-torrust-to-a-digital-ocean-droplet.png"/>          
        </item>
      
        <item>
          <guid>https://v2.torrust.com/live-demo-beta-v3</guid>
          <title>Announcing the Beta v3.0.0 Live Demo</title>
          <description>We will release a new major version v3.0.0. We want the community to test it before the final release while it's still in Beta. You can contribute to make Torrust better.</description>
          <link>https://v2.torrust.com/live-demo-beta-v3</link>
          <pubDate>15/12/2023 12:08:04</pubDate>
          <category>Announcement</category><category>Demo</category>
          <content:encoded><![CDATA[
            <div style="margin: 50px 0; font-style: italic;">
              If anything looks wrong, 
              <strong>
                <a href="https://v2.torrust.com/live-demo-beta-v3">
                  read on the site!
                </a>
              </strong>
            </div>

             <div class="flex svelte-19d8qsr"> <div class=" svelte-13ebny9" style="position: relative;"><div class="svelte-13ebny9"><h2 id="table-of-contents" data-svelte-h="svelte-outevg"><a class="heading-link" title="Permalink" aria-hidden="true" href="#table-of-contents"><span>#</span></a>Table of contents</h2> <ul data-svelte-h="svelte-o4wcxk"><li><a href="#hello-torrent-enthusiasts">Hello, Torrent Enthusiasts!</a></li> <li><a href="#experience-the-beta-demo-today">Experience the Beta Demo Today</a></li> <li><a href="#your-feedback-makes-us-better">Your Feedback Makes Us Better</a></li> <li><a href="#join-the-conversation">Join the Conversation</a></li> <li><a href="#important-notice-demo-availability">Important Notice: Demo Availability</a></li> <li><a href="#a-heartfelt-thank-you-to-our-contributors">A Heartfelt Thank You to Our Contributors</a></li> <li><a href="#join-us-in-this-exciting-journey">Join Us in This Exciting Journey</a></li></ul></div></div> <div class="svelte-4jsat1"><h2 id="hello-torrent-enthusiasts" data-svelte-h="svelte-rwov94"><a class="heading-link" title="Permalink" aria-hidden="true" href="#hello-torrent-enthusiasts"><span>#</span></a><strong>Hello, Torrent Enthusiasts!</strong></h2> <p data-svelte-h="svelte-6xxpl4">We’re thrilled to announce the beta demo of Bittorrent Torrust Index v3.0.0 is now live! This is a significant milestone for us, and we’re eager to share what we’ve been working on with our vibrant community.</p> <div class="callout-block info svelte-sxx0n0"><div class="icon-wrapper svelte-sxx0n0"><svg width="100%" height="100%" stroke-width="1.5" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 11.5V16.5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path d="M12 7.51L12.01 7.49889" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path d="M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path></svg></div> <p data-svelte-h="svelte-aowssa">Live demo: <a href="http://index.torrust-demo.com" rel="nofollow">http://index.torrust-demo.com</a></p></div> <h2 id="experience-the-beta-demo-today" data-svelte-h="svelte-19bz0w0"><a class="heading-link" title="Permalink" aria-hidden="true" href="#experience-the-beta-demo-today"><span>#</span></a>Experience the Beta Demo Today</h2> <p data-svelte-h="svelte-1a4oy3w">Our beta demo is your sneak peek into the future of torrent indexing. We invite you to dive in, explore its features, and experience the enhancements firsthand. Remember, this is a beta version, so you’re getting an early glimpse before the final release!</p> <p data-svelte-h="svelte-nxw1jv">You can test it at: <strong><a href="http://index.torrust-demo.com" rel="nofollow">http://index.torrust-demo.com</a></strong></p> <h2 id="your-feedback-makes-us-better" data-svelte-h="svelte-1mkcvv2"><a class="heading-link" title="Permalink" aria-hidden="true" href="#your-feedback-makes-us-better"><span>#</span></a>Your Feedback Makes Us Better</h2> <p data-svelte-h="svelte-1c0y8q4">We believe in the power of community-driven development. That’s why we’re calling on you, our users, to actively participate in testing the beta.</p> <p data-svelte-h="svelte-ktuu5f">Encountered a bug? Noticed something off? We want to hear about it. Please contribute by opening issues on our GitHub repository. Your insights are invaluable in refining and perfecting the platform.</p> <h2 id="join-the-conversation" data-svelte-h="svelte-1tji4rp"><a class="heading-link" title="Permalink" aria-hidden="true" href="#join-the-conversation"><span>#</span></a>Join the Conversation</h2> <p data-svelte-h="svelte-plipxz">Got ideas? Suggestions for improvement? Join the <a href="https://github.com/torrust/torrust-index-gui/discussions" rel="nofollow">discussion</a> on our GitHub repo’s discussion section. Your thoughts and proposals are a key part of our collaborative development process. Let’s brainstorm together to make Torrust even better.</p> <h2 id="important-notice-demo-availability" data-svelte-h="svelte-1b7v9jv"><a class="heading-link" title="Permalink" aria-hidden="true" href="#important-notice-demo-availability"><span>#</span></a>Important Notice: Demo Availability</h2> <div class="callout-block info svelte-sxx0n0"><div class="icon-wrapper svelte-sxx0n0"><svg width="100%" height="100%" stroke-width="1.5" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 11.5V16.5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path d="M12 7.51L12.01 7.49889" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path d="M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path></svg></div> <p data-svelte-h="svelte-168ochg">Please be aware that the demo is subject to downtime or resets. As a beta version, it’s part of our testing process. Any data you add may be lost during these periods. We appreciate your understanding and patience as we fine-tune the platform.</p></div> <h2 id="a-heartfelt-thank-you-to-our-contributors" data-svelte-h="svelte-mak5d"><a class="heading-link" title="Permalink" aria-hidden="true" href="#a-heartfelt-thank-you-to-our-contributors"><span>#</span></a>A Heartfelt Thank You to Our Contributors</h2> <p data-svelte-h="svelte-1fk4nd3">This release wouldn’t have been possible without the dedication and hard work of our contributors. A big shout-out to everyone who has contributed their time, skills, and passion to this release. Your contributions are the backbone of this project, and we’re immensely grateful for your support.</p> <h2 id="join-us-in-this-exciting-journey" data-svelte-h="svelte-1rcv7xf"><a class="heading-link" title="Permalink" aria-hidden="true" href="#join-us-in-this-exciting-journey"><span>#</span></a>Join Us in This Exciting Journey</h2> <p data-svelte-h="svelte-1skoy0k">We’re just getting started, and there’s much more to come. Stay tuned for more updates, and thank you for being a part of this journey. We very welcome any contributions to the projects.</p></div></div>
          ]]></content:encoded>
          <media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://v2.torrust.com//images/posts/rust-crab-happy.jpg"/>
          <media:content xmlns:media="http://search.yahoo.com/mrss/" medium="image" url="https://v2.torrust.com//images/posts/rust-crab-happy.jpg"/>          
        </item>
      
        <item>
          <guid>https://v2.torrust.com/containerizing-rust-applications-best-practices</guid>
          <title>Containerizing Rust Applications</title>
          <description>Torrust services (Tracker and Index) support docker, we want to ensure that contributors understand our containerfile and we also want to share good practices for containerizing Rust applications.</description>
          <link>https://v2.torrust.com/containerizing-rust-applications-best-practices</link>
          <pubDate>09/11/2023 12:08:04</pubDate>
          <category>Documentation</category><category>Docker</category><category>Containers</category><category>Rust</category>
          <content:encoded><![CDATA[
            <div style="margin: 50px 0; font-style: italic;">
              If anything looks wrong, 
              <strong>
                <a href="https://v2.torrust.com/containerizing-rust-applications-best-practices">
                  read on the site!
                </a>
              </strong>
            </div>

             <div class="flex svelte-19d8qsr"> <div class=" svelte-13ebny9" style="position: relative;"><div class="svelte-13ebny9"><h2 id="table-of-contents" data-svelte-h="svelte-1m3njcc"><a class="heading-link" title="Permalink" aria-hidden="true" href="#table-of-contents"><span>#</span></a>Table of Contents</h2> <ul data-svelte-h="svelte-4wp562"><li><a href="#introduction">Introduction</a></li> <li><a href="#requirements">Requirements</a></li> <li><a href="#we-use-docker-oci-containers">We Use Docker (OCI) Containers</a></li> <li><a href="#basic-dockerized-rust-application">Basic Dockerized Rust Application</a></li> <li><a href="#use-multi-stage-builds-to-minimize-the-image-size">Use Multi-Stage Builds to Minimize the Image Size</a></li> <li><a href="#image-variants">Image Variants</a></li> <li><a href="#introduction-to-docker-layers-cache">Introduction to Docker Layers Cache</a></li> <li><a href="#caching-cargo-dependencies">Caching Cargo Dependencies</a><ul><li><a href="#demonstration-of-caching-cargo-dependencies-using-a-custom-solution">Demonstration of Caching Cargo Dependencies Using a Custom Solution</a></li> <li><a href="#caching-cargo-dependencies-with-cargo-chef">Caching Cargo Dependencies With Cargo Chef</a></li></ul></li> <li><a href="#installing-rust-binaries-with-cargo-binstall">Installing Rust Binaries With Cargo Binstall</a></li> <li><a href="#archiving-and-reusing-builds-with-cargo-nextest">Archiving And Reusing Builds With Cargo Nextest</a></li> <li><a href="#running-container-without-sudo">Running Container Without Sudo</a><ul><li><a href="#use-the-docker-run---user-argument">Use The <code>docker run --user</code> Argument</a></li> <li><a href="#create-the-user-at-runtime">Create The User At Runtime</a></li></ul></li> <li><a href="#decomposing-the-torrust-tracker-containerfile">Decomposing the Torrust Tracker Containerfile</a></li> <li><a href="#other-good-practices">Other Good Practices</a></li> <li><a href="#other-considerations">Other Considerations</a></li> <li><a href="#links">Links</a></li> <li><a href="#conclusion">Conclusion</a></li></ul></div></div> <div class="svelte-4jsat1"><h2 id="introduction" data-svelte-h="svelte-1ahwhrx"><a class="heading-link" title="Permalink" aria-hidden="true" href="#introduction"><span>#</span></a>Introduction</h2> <p data-svelte-h="svelte-1bew33">BitTorrent, an age-old protocol, is a powerful way to share data over the internet.
In our journey to building robust BitTorrent projects, we’ve chosen the Rust
programming language for its memory safety and concurrency features. To streamline
the development and distribution of our projects, we’ve also employed Docker and
Podman.</p> <p data-svelte-h="svelte-n4c01r">In this post, we’ll dive deep into the best practices we’ve adopted for
dockerizing our Rust applications.</p> <p data-svelte-h="svelte-2fok2a">Our <a href="https://docs.docker.com/engine/reference/builder/" rel="nofollow">Containerfiles</a>, <em>commonly called a <code>&quot;Dockerfile&quot;</code></em>, are stored in the roots of our two main rust repositories, for reference:</p> <ul data-svelte-h="svelte-pc1ly4"><li>Torrust-Tracker <a href="https://github.com/torrust/torrust-tracker/blob/develop/Containerfile" rel="nofollow">Containerfile</a>.</li> <li>Torrust-Index <a href="https://github.com/torrust/torrust-index/blob/develop/Containerfile" rel="nofollow">Containerfile</a>.</li></ul> <h3 id="example" data-svelte-h="svelte-ywa4f"><a class="heading-link" title="Permalink" aria-hidden="true" href="#example"><span>#</span></a>Example</h3> <p data-svelte-h="svelte-bjlfzg">All of the examples included in this blog post are publicly available in our ”<a href="https://github.com/torrust/containerizing-rust-apps-examples" rel="nofollow">Containerizing Rust Apps Examples</a>”
GitHub Repository.</p> <blockquote data-svelte-h="svelte-3fqojs"><p><strong><em>Please Note:</em></strong> The actual <code>Containerfile</code> for the <strong>Tracker</strong> and <strong>Index</strong> services builds images for
both <code>debug</code> and <code>release</code> modes. For learning purposes we are using a simplified
version here which only builds the <code>release</code> mode:</p></blockquote> <div class="code-block svelte-11qxx87"> <div class="lang svelte-11qxx87">dockerfile</div> <button class="copy-button copy-button-gray svelte-11qxx87"></button> <div class="code-content"><pre class="language-dockerfile"><!-- HTML_TAG_START --><code class="language-dockerfile"><span class="token comment"># Extracted example of our Containerfile.</span>

<span class="token comment">## Base Builder Image</span>
<span class="token instruction"><span class="token keyword">FROM</span> rust:bookworm <span class="token keyword">as</span> chef</span>
<span class="token instruction"><span class="token keyword">WORKDIR</span> /tmp</span>
<span class="token instruction"><span class="token keyword">RUN</span> curl -L --proto <span class="token string">'=https'</span> --tlsv1.2 -sSf https://raw.githubusercontent.com/cargo-bins/cargo-binstall/main/install-from-binstall-release.sh | bash</span>
<span class="token instruction"><span class="token keyword">RUN</span> cargo binstall --no-confirm cargo-chef cargo-nextest</span>

<span class="token comment">## Tester Image</span>
<span class="token instruction"><span class="token keyword">FROM</span> rust:slim-bookworm <span class="token keyword">as</span> tester</span>
<span class="token instruction"><span class="token keyword">WORKDIR</span> /tmp</span>
<span class="token instruction"><span class="token keyword">RUN</span> apt-get update; apt-get install -y curl; apt-get autoclean</span>
<span class="token instruction"><span class="token keyword">RUN</span> curl -L --proto <span class="token string">'=https'</span> --tlsv1.2 -sSf https://raw.githubusercontent.com/cargo-bins/cargo-binstall/main/install-from-binstall-release.sh | bash</span>
<span class="token instruction"><span class="token keyword">RUN</span> cargo binstall --no-confirm cargo-nextest</span>

<span class="token comment">## Su Exe Compile</span>
<span class="token instruction"><span class="token keyword">FROM</span> docker.io/library/gcc:bookworm <span class="token keyword">as</span> gcc</span>
<span class="token instruction"><span class="token keyword">COPY</span> ./contrib/dev-tools/su-exec/ /usr/local/src/su-exec/</span>
<span class="token instruction"><span class="token keyword">RUN</span> cc -Wall -Werror -g /usr/local/src/su-exec/su-exec.c -o /usr/local/bin/su-exec; chmod +x /usr/local/bin/su-exec</span>

<span class="token comment">## Chef Prepare (look at project and see wat we need)</span>
<span class="token instruction"><span class="token keyword">FROM</span> chef <span class="token keyword">AS</span> recipe</span>
<span class="token instruction"><span class="token keyword">WORKDIR</span> /build/src</span>
<span class="token instruction"><span class="token keyword">COPY</span> . /build/src</span>
<span class="token instruction"><span class="token keyword">RUN</span> cargo chef prepare --recipe-path /build/recipe.json</span>

<span class="token comment">## Cook (release)</span>
<span class="token instruction"><span class="token keyword">FROM</span> chef <span class="token keyword">AS</span> dependencies</span>
<span class="token instruction"><span class="token keyword">WORKDIR</span> /build/src</span>
<span class="token instruction"><span class="token keyword">COPY</span> <span class="token options"><span class="token property">--from</span><span class="token punctuation">=</span><span class="token string">recipe</span></span> /build/recipe.json /build/recipe.json</span>
<span class="token instruction"><span class="token keyword">RUN</span> cargo chef cook --tests --benches --examples --workspace --all-targets --all-features --recipe-path /build/recipe.json --release</span>
<span class="token instruction"><span class="token keyword">RUN</span> cargo nextest archive --tests --benches --examples --workspace --all-targets --all-features --archive-file /build/temp.tar.zst --release  ; rm -f /build/temp.tar.zst</span>

<span class="token comment">## Build Archive (release)</span>
<span class="token instruction"><span class="token keyword">FROM</span> dependencies <span class="token keyword">AS</span> build</span>
<span class="token instruction"><span class="token keyword">WORKDIR</span> /build/src</span>
<span class="token instruction"><span class="token keyword">COPY</span> . /build/src</span>
<span class="token instruction"><span class="token keyword">RUN</span> cargo nextest archive --tests --benches --examples --workspace --all-targets --all-features --archive-file /build/full-example.tar.zst --release</span>

<span class="token comment"># Extract and Test (release)</span>
<span class="token instruction"><span class="token keyword">FROM</span> tester <span class="token keyword">as</span> test</span>
<span class="token instruction"><span class="token keyword">WORKDIR</span> /test</span>
<span class="token instruction"><span class="token keyword">COPY</span> . /test/src</span>
<span class="token instruction"><span class="token keyword">COPY</span> <span class="token options"><span class="token property">--from</span><span class="token punctuation">=</span><span class="token string">build</span></span> <span class="token operator"></span>
  /build/full-example.tar.zst <span class="token operator"></span>
  /test/full-example.tar.zst</span>
<span class="token instruction"><span class="token keyword">RUN</span> cargo nextest run --workspace-remap /test/src/ --extract-to /test/src/ --no-run --archive-file /test/full-example.tar.zst</span>
<span class="token instruction"><span class="token keyword">RUN</span> cargo nextest run --workspace-remap /test/src/ --target-dir-remap /test/src/target/ --cargo-metadata /test/src/target/nextest/cargo-metadata.json --binaries-metadata /test/src/target/nextest/binaries-metadata.json</span>

<span class="token instruction"><span class="token keyword">RUN</span> mkdir -p /app/bin/; cp -l /test/src/target/release/full-example /app/bin/full-example</span>
<span class="token instruction"><span class="token keyword">RUN</span> chown -R root:root /app; chmod -R u=rw,go=r,a+X /app; chmod -R a+x /app/bin</span>

<span class="token comment">## Runtime</span>
<span class="token instruction"><span class="token keyword">FROM</span> gcr.io/distroless/cc-debian12:debug <span class="token keyword">as</span> runtime</span>
<span class="token instruction"><span class="token keyword">RUN</span> [<span class="token string">"/busybox/cp"</span>, <span class="token string">"-sp"</span>, <span class="token string">"/busybox/sh"</span>,<span class="token string">"/busybox/cat"</span>,<span class="token string">"/busybox/ls"</span>,<span class="token string">"/busybox/env"</span>, <span class="token string">"/bin/"</span>]</span>
<span class="token instruction"><span class="token keyword">COPY</span> <span class="token options"><span class="token property">--from</span><span class="token punctuation">=</span><span class="token string">gcc</span> <span class="token property">--chmod</span><span class="token punctuation">=</span><span class="token string">0555</span></span> /usr/local/bin/su-exec /bin/su-exec</span>
<span class="token instruction"><span class="token keyword">ARG</span> USER_ID=1000</span>
<span class="token instruction"><span class="token keyword">COPY</span> <span class="token options"><span class="token property">--chmod</span><span class="token punctuation">=</span><span class="token string">0555</span></span> ./share/container/entry_script_sh /usr/local/bin/entry.sh</span>
<span class="token instruction"><span class="token keyword">ENTRYPOINT</span> [<span class="token string">"/usr/local/bin/entry.sh"</span>]</span>

<span class="token comment">## Release Runtime</span>
<span class="token instruction"><span class="token keyword">FROM</span> runtime <span class="token keyword">as</span> release</span>
<span class="token instruction"><span class="token keyword">COPY</span> <span class="token options"><span class="token property">--from</span><span class="token punctuation">=</span><span class="token string">test</span></span> /app/ /usr/</span>
<span class="token instruction"><span class="token keyword">CMD</span> [<span class="token string">"/usr/bin/full-example"</span>]</span></code><!-- HTML_TAG_END --></pre></div></div> <p data-svelte-h="svelte-h87xgr">The real version in production contains some duplicate stages to build the <code>debug</code>
mode. Those stages are almost identical to the ones in this example and are therefore omitted. Only some flags and names change.</p> <p data-svelte-h="svelte-1jzeibq">Don’t be scared of the example, next we will go through all the lines and explain what
they do, but before doing that, we will explain some basic concepts and the patterns
applied one by one.</p> <h2 id="requirements" data-svelte-h="svelte-d9t7ph"><a class="heading-link" title="Permalink" aria-hidden="true" href="#requirements"><span>#</span></a>Requirements</h2> <p data-svelte-h="svelte-geafvi">In order to run some of the examples in this article you will need to install:</p> <ul data-svelte-h="svelte-c5a7l"><li><a href="https://docs.docker.com/get-docker/" rel="nofollow">Docker version 24.0.6, build ed223bc</a></li></ul> <h2 id="we-use-docker-oci-containers" data-svelte-h="svelte-cyt294"><a class="heading-link" title="Permalink" aria-hidden="true" href="#we-use-docker-oci-containers"><span>#</span></a>We Use Docker (OCI) Containers</h2> <p data-svelte-h="svelte-ayeng7">The standardized <a href="https://opencontainers.org/" rel="nofollow">Open Container Initiative (OCI)</a> allows Torrust the possibility of reliable and cross-platform distribution and deployment of our Software.</p> <p data-svelte-h="svelte-a0u1en">This allows for administrators who may be interested in our software to quickly and easily test-out our software and see if it suits their needs. It also allows administrators to more easily deploy our software, as most of the web-hosting systems have great support for OCI Containers.</p> <p data-svelte-h="svelte-15sjdzn">In addition, our End-to-End testing infrastructure is made easier by using a <a href="https://docs.docker.com/compose/" rel="nofollow">docker-compose</a> configuration, that is taking advantage of our docker containers.</p> <h2 id="basic-dockerized-rust-application" data-svelte-h="svelte-vhcbi5"><a class="heading-link" title="Permalink" aria-hidden="true" href="#basic-dockerized-rust-application"><span>#</span></a>Basic Dockerized Rust Application</h2> <p data-svelte-h="svelte-a641je">The simplest Dockerfile for a Rust application is as follows:</p> <div class="code-block svelte-11qxx87"> <div class="lang svelte-11qxx87">dockerfile</div> <button class="copy-button copy-button-gray svelte-11qxx87"></button> <div class="code-content"><pre class="language-dockerfile"><!-- HTML_TAG_START --><code class="language-dockerfile"><span class="token comment"># We start from full base defacto Debian image</span>
<span class="token instruction"><span class="token keyword">FROM</span> rust:latest</span>
<span class="token instruction"><span class="token keyword">WORKDIR</span> /app</span>
<span class="token instruction"><span class="token keyword">RUN</span> cargo init</span>
<span class="token instruction"><span class="token keyword">RUN</span> cargo build --release</span>
<span class="token instruction"><span class="token keyword">CMD</span> [<span class="token string">"./target/release/app"</span>]</span></code><!-- HTML_TAG_END --></pre></div></div> <p data-svelte-h="svelte-1shwlxj">And you can build the image and run it with:</p> <div class="code-block svelte-11qxx87"> <div class="lang svelte-11qxx87">console</div> <button class="copy-button copy-button-gray svelte-11qxx87"></button> <div class="code-content"><pre class="language-console"><!-- HTML_TAG_START --><code class="language-console">docker build -t docker-rust-app-basic .
docker run --rm -it docker-rust-app-basic

Hello, world!</code><!-- HTML_TAG_END --></pre></div></div> <p data-svelte-h="svelte-1148wxx">That creates a docker image which is <strong>1.39 GB</strong>!.</p> <div class="code-block svelte-11qxx87"> <div class="lang svelte-11qxx87">console</div> <button class="copy-button copy-button-gray svelte-11qxx87"></button> <div class="code-content"><pre class="language-console"><!-- HTML_TAG_START --><code class="language-console">$ docker image ls | grep docker-rust-app-basic
docker-rust-app-basic                            latest          7294f20bb52c   2 minutes ago   1.39GB</code><!-- HTML_TAG_END --></pre></div></div> <p data-svelte-h="svelte-msyssk">We are going to see how to improve
that and other things like common patters, good practices and other considerations.</p> <h2 id="use-multi-stage-builds-to-minimize-the-image-size" data-svelte-h="svelte-1rb4gy9"><a class="heading-link" title="Permalink" aria-hidden="true" href="#use-multi-stage-builds-to-minimize-the-image-size"><span>#</span></a>Use Multi-Stage Builds to Minimize the Image Size</h2> <p data-svelte-h="svelte-1wu17ac">A common pattern to build smaller docker images is to use multi-stage Dockerfiles.</p> <p data-svelte-h="svelte-1q5coka">You can compile your application with all of the Rust tooling and then use the
final binary in a slim operating system. This image does not contain the common
packages contained in the default tag and only contains the minimal packages
needed to run your compiled Rust application.</p> <div class="code-block svelte-11qxx87"> <div class="lang svelte-11qxx87">dockerfile</div> <button class="copy-button copy-button-gray svelte-11qxx87"></button> <div class="code-content"><pre class="language-dockerfile"><!-- HTML_TAG_START --><code class="language-dockerfile"><span class="token comment"># This is the first stage. This image is used to compile the Rust application.</span>
<span class="token instruction"><span class="token keyword">FROM</span> rust:bookworm <span class="token keyword">as</span> builder</span>
<span class="token instruction"><span class="token keyword">WORKDIR</span> /app</span>
<span class="token instruction"><span class="token keyword">RUN</span> cargo init</span>
<span class="token comment"># Install the package in the current directory</span>
<span class="token instruction"><span class="token keyword">RUN</span> cargo install --path .</span>
<span class="token instruction"><span class="token keyword">CMD</span> [<span class="token string">"./target/release/app"</span>]</span>

<span class="token comment"># This is the production stage.</span>
<span class="token comment"># The slim image does not contain the common packages contained in the default tag and only contains the minimal packages needed to run rust.</span>
<span class="token instruction"><span class="token keyword">FROM</span> debian:bookworm-slim</span>
<span class="token instruction"><span class="token keyword">COPY</span> <span class="token options"><span class="token property">--from</span><span class="token punctuation">=</span><span class="token string">builder</span></span> /usr/local/cargo/bin/app /usr/local/bin/app</span>
<span class="token instruction"><span class="token keyword">CMD</span> [<span class="token string">"app"</span>]</span></code><!-- HTML_TAG_END --></pre></div></div> <p data-svelte-h="svelte-1e77e1j">The example is very easy and you can build and run the image with:</p> <div class="code-block svelte-11qxx87"> <div class="lang svelte-11qxx87">console</div> <button class="copy-button copy-button-gray svelte-11qxx87"></button> <div class="code-content"><pre class="language-console"><!-- HTML_TAG_START --><code class="language-console">docker build -t docker-rust-app-multi-stage .
docker run --rm -it docker-rust-app-multi-stage
Hello, world!
$ docker image ls | grep docker-rust-app-multi-stage
docker-rust-app-multi-stage                             latest          bc3ae797b55e   11 seconds ago   84.7MB</code><!-- HTML_TAG_END --></pre></div></div> <p data-svelte-h="svelte-j0pust">As you can see this new image is only 84.7MB. That’s a huge improvement!</p> <h2 id="image-variants" data-svelte-h="svelte-1d98m8q"><a class="heading-link" title="Permalink" aria-hidden="true" href="#image-variants"><span>#</span></a>Image Variants</h2> <p data-svelte-h="svelte-oq7eo4">As you can see in our <code>Containerfile</code>, the images we are using are the following:</p> <h3 id="rustbookworm" data-svelte-h="svelte-wzlgx5"><a class="heading-link" title="Permalink" aria-hidden="true" href="#rustbookworm"><span>#</span></a>rust:bookworm</h3> <pre class="language-dockerfile"><!-- HTML_TAG_START --><code class="language-dockerfile"><span class="token instruction"><span class="token keyword">FROM</span> rust:bookworm</span></code><!-- HTML_TAG_END --></pre> <p data-svelte-h="svelte-44km0g">At the time of writing this article the latest release is <a href="https://www.debian.org/releases/bookworm/" rel="nofollow">Debian 12.2</a>.
It is also (currently) known as stable or by its codename “Bookworm”. You will
see that we use that one because it is the latest one.</p> <h3 id="rustslim-bookworm" data-svelte-h="svelte-1yonnqd"><a class="heading-link" title="Permalink" aria-hidden="true" href="#rustslim-bookworm"><span>#</span></a>rust:slim-bookworm</h3> <pre class="language-dockerfile"><!-- HTML_TAG_START --><code class="language-dockerfile"><span class="token instruction"><span class="token keyword">FROM</span> rust:slim-bookworm</span></code><!-- HTML_TAG_END --></pre> <p data-svelte-h="svelte-3abwef">Images with the <code>slim</code> suffix do not contain the common packages contained in the
default tag and only contain the minimal packages needed to run rust. We are using
it for the “tester” stage.</p> <h3 id="gccbookworm" data-svelte-h="svelte-dufdni"><a class="heading-link" title="Permalink" aria-hidden="true" href="#gccbookworm"><span>#</span></a>gcc:bookworm</h3> <pre class="language-dockerfile"><!-- HTML_TAG_START --><code class="language-dockerfile"><span class="token instruction"><span class="token keyword">FROM</span> docker.io/library/gcc:bookworm</span></code><!-- HTML_TAG_END --></pre> <p data-svelte-h="svelte-tmyft9">The GCC image is used to compile an small C program which is a simple tool that
just executes a program with different privileges. When we start the container
we run it with a USER ID passed by an environment variable and not with <code>root</code>
privileges.</p> <h3 id="cc-debian12debug" data-svelte-h="svelte-184w9i9"><a class="heading-link" title="Permalink" aria-hidden="true" href="#cc-debian12debug"><span>#</span></a>cc-debian12:debug</h3> <pre class="language-dockerfile"><!-- HTML_TAG_START --><code class="language-dockerfile"><span class="token instruction"><span class="token keyword">FROM</span> gcr.io/gcr.io/distroless/cc-debian12:debug</span></code><!-- HTML_TAG_END --></pre> <p data-svelte-h="svelte-1fhk2ic">And finally a “Distroless” container image is used for runtime. <a href="https://github.com/GoogleContainerTools/distroless#why-should-i-use-distroless-images" rel="nofollow">Why should you use distroless images?</a>.</p> <ul data-svelte-h="svelte-18873bu"><li>They are small.</li> <li>They only have what you need to run your app.</li> <li>They reduce the risk of vulnerabilities.</li></ul> <div class="callout-block info svelte-sxx0n0"><div class="icon-wrapper svelte-sxx0n0"><svg width="100%" height="100%" stroke-width="1.5" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 11.5V16.5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path d="M12 7.51L12.01 7.49889" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path d="M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path></svg></div> <p data-svelte-h="svelte-1fdq7sg">We use the <code>:debug</code> variant of the distroless cc, as it includes the busybox binary,
giving us a shell that is needed to run the entry-script. We will explain this later.</p></div> <h2 id="introduction-to-docker-layers-cache" data-svelte-h="svelte-uva52c"><a class="heading-link" title="Permalink" aria-hidden="true" href="#introduction-to-docker-layers-cache"><span>#</span></a>Introduction To Docker Layers Cache</h2> <p data-svelte-h="svelte-hk85vl">Caching is a pivotal aspect of optimizing Docker builds, especially with Rust projects. Proper caching ensures faster builds, as unchanged dependencies don’t have to be recompiled. By leveraging Docker’s layer caching mechanism, we can effectively cache Rust dependencies and speed up our Docker builds.</p> <p data-svelte-h="svelte-1xtjzwc">Docker uses a layered filesystem to store images. Each layer is a set of changes to the filesystem. When you create a new container, you add a new writable layer on top of the underlying layers. This layer is often called the “container layer”. All changes made to the running container, such as writing new files, modifying existing files, and deleting files, are written to this thin writable container layer.</p> <h2 id="caching-cargo-dependencies" data-svelte-h="svelte-1ypa8uz"><a class="heading-link" title="Permalink" aria-hidden="true" href="#caching-cargo-dependencies"><span>#</span></a>Caching cargo dependencies</h2> <p data-svelte-h="svelte-11u1mbr">A common pattern used in all languages is to separate the dependencies installation from the application build. This is done to take advantage of the Docker layer caching mechanism. The dependencies installation is done in a separate layer, and the application build is done in a separate layer. This way, if the application code changes, the dependencies installation layer is not rebuilt, and only the application build layer is rebuilt.</p> <p data-svelte-h="svelte-uz9oxy">This improves build times because dependencies installation is usually a time-consuming process and it is something you normally do not change often. The application build, on the other hand, is something you change often, and it is usually a quick process.</p> <p data-svelte-h="svelte-8zab98">Docker build is executed in the order that you define instructions so you put things that change less frequently at the beginning of the Dockerfile and things that change more frequently at the end of the Dockerfile.</p> <p data-svelte-h="svelte-1sajbeb">There are two levels of dependencies:</p> <ul data-svelte-h="svelte-75d099"><li>System dependencies. For instance <code>SQLite</code>, <code>curl</code> and other libraries your application depends on.</li> <li>Rust dependencies. These are the Rust packages that you want to install using cargo. Rust packages are called <code>crates</code> and you can find them on <a href="https://crates.io/" rel="nofollow">https://crates.io/</a></li></ul> <h3 id="demonstration-of-caching-cargo-dependencies-using-a-custom-solution" data-svelte-h="svelte-1xct4pc"><a class="heading-link" title="Permalink" aria-hidden="true" href="#demonstration-of-caching-cargo-dependencies-using-a-custom-solution"><span>#</span></a>Demonstration of Caching Cargo Dependencies Using a Custom Solution</h3> <p data-svelte-h="svelte-2cwd33">First we demonstrate how cargo dependencies caching works but showing a custom solution:</p> <p data-svelte-h="svelte-1l59dpd">We first create an <strong>empty application configuration</strong> which uses the same dependencies.
We build the application, downloading and building all the dependencies and creating a docker cache layer.</p> <p data-svelte-h="svelte-xzh6g5">Then we build the application. With these layers yo do not need to re-build the dependencies
when you change the application code.</p> <div class="code-block svelte-11qxx87"> <div class="lang svelte-11qxx87">dockerfile</div> <button class="copy-button copy-button-gray svelte-11qxx87"></button> <div class="code-content"><pre class="language-dockerfile"><!-- HTML_TAG_START --><code class="language-dockerfile"><span class="token instruction"><span class="token keyword">FROM</span> rust:latest <span class="token keyword">as</span> builder</span>

<span class="token instruction"><span class="token keyword">WORKDIR</span> /app</span>

<span class="token comment"># Copy over the manifest files</span>
<span class="token instruction"><span class="token keyword">COPY</span> Cargo.toml Cargo.lock /app/</span>

<span class="token comment"># Create a dummy main.rs to build dependencies</span>
<span class="token instruction"><span class="token keyword">RUN</span> mkdir src &amp;&amp; echo <span class="token string">"fn main() &#123; println!("if you see this, the build broke"); &#125;"</span> > src/main.rs</span>

<span class="token comment"># This build step will cache the dependencies as they're not changed</span>
<span class="token instruction"><span class="token keyword">RUN</span> cargo build --release</span>

<span class="token comment"># Now, remove the dummy main.rs and copy your source code</span>
<span class="token instruction"><span class="token keyword">COPY</span> . /app</span>

<span class="token comment"># You'll need to update the last modified of the main.rs file to inform cargo to rebuild it</span>
<span class="token instruction"><span class="token keyword">RUN</span> touch -a -m ./src/main.rs</span>

<span class="token comment"># Build the application for release. Since dependencies are cached, this will only build your code</span>
<span class="token instruction"><span class="token keyword">RUN</span> cargo build --release</span>

<span class="token instruction"><span class="token keyword">CMD</span> [<span class="token string">"./target/release/custom-dependencies-cache"</span>]</span></code><!-- HTML_TAG_END --></pre></div></div> <p data-svelte-h="svelte-1al3v1i">Instead of this custom solution, we use and recommend <a href="https://github.com/LukeMathWalker/cargo-chef" rel="nofollow">cargo chef</a> which is a cargo-subcommand that specializes in speeding up Rust Docker builds using Docker layer caching.</p> <h3 id="caching-cargo-dependencies-with-cargo-chef" data-svelte-h="svelte-u2le63"><a class="heading-link" title="Permalink" aria-hidden="true" href="#caching-cargo-dependencies-with-cargo-chef"><span>#</span></a>Caching Cargo Dependencies With Cargo Chef</h3> <p data-svelte-h="svelte-k3wwdj">In this example, we show how to use <a href="https://github.com/LukeMathWalker/cargo-chef" rel="nofollow">cargo chef</a>, that we prefer to use.</p> <div class="code-block svelte-11qxx87"> <div class="lang svelte-11qxx87">dockerfile</div> <button class="copy-button copy-button-gray svelte-11qxx87"></button> <div class="code-content"><pre class="language-dockerfile"><!-- HTML_TAG_START --><code class="language-dockerfile"><span class="token instruction"><span class="token keyword">FROM</span> rust:latest <span class="token keyword">as</span> chef</span>

<span class="token instruction"><span class="token keyword">WORKDIR</span> /app</span>

<span class="token comment"># Install cargo-chef</span>
<span class="token instruction"><span class="token keyword">RUN</span> cargo install cargo-chef --locked</span>

<span class="token comment"># Examines your project and builds a recipe that captures the set of information required to build your dependencies</span>
<span class="token instruction"><span class="token keyword">FROM</span> chef <span class="token keyword">AS</span> planner</span>

<span class="token instruction"><span class="token keyword">COPY</span> . .</span>

<span class="token instruction"><span class="token keyword">RUN</span> cargo chef prepare --recipe-path recipe.json</span>

<span class="token instruction"><span class="token keyword">FROM</span> chef <span class="token keyword">AS</span> builder</span>

<span class="token instruction"><span class="token keyword">COPY</span> <span class="token options"><span class="token property">--from</span><span class="token punctuation">=</span><span class="token string">planner</span></span> /app/recipe.json recipe.json</span>

<span class="token comment"># Build dependencies - this is the caching Docker layer!</span>
<span class="token instruction"><span class="token keyword">RUN</span> cargo chef cook --release --recipe-path recipe.json</span>

<span class="token instruction"><span class="token keyword">COPY</span> . .</span>

<span class="token comment"># Build the application for release. Since dependencies are cached, this will only build your code</span>
<span class="token instruction"><span class="token keyword">RUN</span> cargo build --release</span>

<span class="token instruction"><span class="token keyword">CMD</span> [<span class="token string">"./target/release/dependencies-cache-with-cargo-chef"</span>]</span></code><!-- HTML_TAG_END --></pre></div></div> <p data-svelte-h="svelte-kdyrix">While it does more or less the same as the custom solution. It caches dependencies in a separate layer and has some other <a href="https://github.com/LukeMathWalker/cargo-chef#benefits-of-cargo-chef" rel="nofollow">benefits</a>.</p> <h2 id="installing-rust-binaries-with-cargo-binstall" data-svelte-h="svelte-pxmn10"><a class="heading-link" title="Permalink" aria-hidden="true" href="#installing-rust-binaries-with-cargo-binstall"><span>#</span></a>Installing Rust Binaries With Cargo Binstall</h2> <p data-svelte-h="svelte-6yum3m"><code>cargo binstall</code> is a cargo subcommand that allows installing Rust binaries as an alternative to building from source (via cargo install) or manually downloading packages.</p> <p data-svelte-h="svelte-gk98nu">Cargo Binstall repo: <a href="https://github.com/cargo-bins/cargo-binstall" rel="nofollow">https://github.com/cargo-bins/cargo-binstall</a>.</p> <p data-svelte-h="svelte-1n8zo3n">We are using it to install <code>cargo chef</code> and <code>cargo nextest</code> packages easily.</p> <div class="code-block svelte-11qxx87"> <div class="lang svelte-11qxx87">dockerfile</div> <button class="copy-button copy-button-gray svelte-11qxx87"></button> <div class="code-content"><pre class="language-dockerfile"><!-- HTML_TAG_START --><code class="language-dockerfile">
<span class="token instruction"><span class="token keyword">FROM</span> rust:latest</span>
<span class="token instruction"><span class="token keyword">WORKDIR</span> /app</span>
<span class="token comment"># Install &#96;cargo binstall&#96;</span>
<span class="token instruction"><span class="token keyword">RUN</span> curl -L --proto <span class="token string">'=https'</span> --tlsv1.2 -sSf https://raw.githubusercontent.com/cargo-bins/cargo-binstall/main/install-from-binstall-release.sh | bash</span>
<span class="token comment"># Install Rust binaries with &#96;cargo binstall&#96;</span>
<span class="token instruction"><span class="token keyword">RUN</span> cargo binstall --no-confirm cargo-chef cargo-nextest</span>
<span class="token instruction"><span class="token keyword">RUN</span> cargo chef --version &amp;&amp; cargo nextest --version</span>
<span class="token instruction"><span class="token keyword">RUN</span> cargo init</span>
<span class="token instruction"><span class="token keyword">RUN</span> cargo build --release</span>
<span class="token instruction"><span class="token keyword">CMD</span> [<span class="token string">"./target/release/app"</span>]</span>
</code><!-- HTML_TAG_END --></pre></div></div> <h2 id="archiving-and-reusing-builds-with-cargo-nextest" data-svelte-h="svelte-1qtt8xq"><a class="heading-link" title="Permalink" aria-hidden="true" href="#archiving-and-reusing-builds-with-cargo-nextest"><span>#</span></a>Archiving And Reusing Builds With Cargo Nextest</h2> <p data-svelte-h="svelte-cx78zz"><a href="https://nexte.st/" rel="nofollow">cargo-nextest</a> is a Rust test runner.</p> <p data-svelte-h="svelte-po63xx">It has a subcommand <code>cargo nextest archive</code> that can archive builds artifacts.
This is useful to separate the “build” phase from the “run” phase.</p> <p data-svelte-h="svelte-16yp2dv">In the <a href="https://nexte.st/book/reusing-builds.html" rel="nofollow">official documentation</a> they
describe some use cases like:</p> <ul data-svelte-h="svelte-15gh482"><li><strong>Cross-compilation</strong>. The build machine has a different architecture, or runs a different operating system, from the target machine.</li> <li><strong>Test partitioning</strong>. Build once on the build machine, then partition test execution across multiple target machines.</li> <li><strong>Saving execution time</strong> on more valuable machines. For example, build tests on a regular machine, then run them on a machine with a GPU attached to it.</li></ul> <p data-svelte-h="svelte-fa7gqx">We are using it for two reasons:</p> <ul data-svelte-h="svelte-1hjbvmo"><li><strong>Test partitioning</strong>. We build the application in a docker stage and then run
the tests in another stage. This way we can separate the build and test phases.</li> <li><strong>Passing the binary to the next stage</strong>. After building the application we archive
the build artifacts and then we extract them in the next stage to run the tests.
Finally we copy the binary to the final “runtime” stage.</li></ul> <div class="code-block svelte-11qxx87"> <div class="lang svelte-11qxx87">dockerfile</div> <button class="copy-button copy-button-gray svelte-11qxx87"></button> <div class="code-content"><pre class="language-dockerfile"><!-- HTML_TAG_START --><code class="language-dockerfile"><span class="token comment">## First stage to install the nextest tool</span>
<span class="token instruction"><span class="token keyword">FROM</span> rust:latest <span class="token keyword">as</span> nextest</span>
<span class="token instruction"><span class="token keyword">RUN</span> cargo install cargo-nextest --locked</span>

<span class="token comment">## Second stage to build the application and package it with nextest</span>
<span class="token instruction"><span class="token keyword">FROM</span> nextest <span class="token keyword">AS</span> builder</span>
<span class="token instruction"><span class="token keyword">WORKDIR</span> /build/src</span>
<span class="token instruction"><span class="token keyword">COPY</span> . /build/src</span>
<span class="token instruction"><span class="token keyword">RUN</span> cargo build</span>
<span class="token comment"># We archive the build artifacts to reuse them in the next stage</span>
<span class="token comment"># NOTICE: the application must contains at least one integration test in order</span>
<span class="token comment"># include the binary in the archive.</span>
<span class="token comment"># See: https://github.com/nextest-rs/nextest/issues/423</span>
<span class="token instruction"><span class="token keyword">RUN</span> cargo nextest archive --tests --benches --examples --workspace --all-targets --all-features --archive-file /build/archiving-and-reusing-builds.tar.zst</span>
<span class="token instruction"><span class="token keyword">CMD</span> [<span class="token string">"/build/src/target/debug/archiving-and-reusing-builds"</span>]</span>

<span class="token comment">## Third stage to test the application</span>
<span class="token instruction"><span class="token keyword">FROM</span> nextest <span class="token keyword">AS</span> tester</span>
<span class="token instruction"><span class="token keyword">WORKDIR</span> /test</span>
<span class="token instruction"><span class="token keyword">COPY</span> . /test/src/</span>
<span class="token instruction"><span class="token keyword">COPY</span> <span class="token options"><span class="token property">--from</span><span class="token punctuation">=</span><span class="token string">builder</span></span> <span class="token operator"></span>
    /build/archiving-and-reusing-builds.tar.zst <span class="token operator"></span>
    /test/archiving-and-reusing-builds.tar.zst</span>
<span class="token comment"># We extract the build artifacts from the archive</span>
<span class="token instruction"><span class="token keyword">RUN</span> cargo nextest run --workspace-remap /test/src/ --extract-to /test/src/ --no-run --archive-file /test/archiving-and-reusing-builds.tar.zst</span>
<span class="token comment"># We run the tests. We override the default target-dir to use the application binary,</span>
<span class="token comment"># otherwise it would be created in a temporary directory and we wouldn't be able to</span>
<span class="token comment"># copy it in the next stage.</span>
<span class="token instruction"><span class="token keyword">RUN</span> cargo nextest run --workspace-remap /test/src/ --target-dir-remap /test/src/target/ --cargo-metadata /test/src/target/nextest/cargo-metadata.json --binaries-metadata /test/src/target/nextest/binaries-metadata.json</span>
<span class="token instruction"><span class="token keyword">RUN</span> mkdir -p /app/bin/; cp -l /test/src/target/debug/archiving-and-reusing-builds /app/bin/archiving-and-reusing-builds</span>
<span class="token instruction"><span class="token keyword">CMD</span> [<span class="token string">"/app/bin/archiving-and-reusing-builds"</span>]</span>

<span class="token comment">## Fourth stage to run the application in production</span>
<span class="token instruction"><span class="token keyword">FROM</span> nextest <span class="token keyword">AS</span> runtime</span>
<span class="token instruction"><span class="token keyword">WORKDIR</span> /app</span>
<span class="token comment"># We take the application binary from the tester stage to ensure the binary we</span>
<span class="token comment"># use has passed the tests.</span>
<span class="token instruction"><span class="token keyword">COPY</span> <span class="token options"><span class="token property">--from</span><span class="token punctuation">=</span><span class="token string">tester</span></span> /app/bin/archiving-and-reusing-builds /app/</span>
<span class="token instruction"><span class="token keyword">CMD</span> [<span class="token string">"/app/archiving-and-reusing-builds"</span>]</span></code><!-- HTML_TAG_END --></pre></div></div> <div class="callout-block info svelte-sxx0n0"><div class="icon-wrapper svelte-sxx0n0"><svg width="100%" height="100%" stroke-width="1.5" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 11.5V16.5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path d="M12 7.51L12.01 7.49889" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path d="M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path></svg></div> <p data-svelte-h="svelte-1nkbu6n"><strong>NOTICE</strong>: The application must contain at least one integration test in order
include the binary in the archive. See this <a href="https://github.com/nextest-rs/nextest/issues/423" rel="nofollow">issue</a>
for more info.</p></div> <h2 id="running-container-without-sudo" data-svelte-h="svelte-v5pqya"><a class="heading-link" title="Permalink" aria-hidden="true" href="#running-container-without-sudo"><span>#</span></a>Running Container Without Sudo</h2> <p data-svelte-h="svelte-1pa1gb9">By default docker is installed and runs containers as <code>root</code>. If you build this image:</p> <div class="code-block svelte-11qxx87"> <div class="lang svelte-11qxx87">dockerfile</div> <button class="copy-button copy-button-gray svelte-11qxx87"></button> <div class="code-content"><pre class="language-dockerfile"><!-- HTML_TAG_START --><code class="language-dockerfile"><span class="token instruction"><span class="token keyword">FROM</span> rust:latest</span>
<span class="token instruction"><span class="token keyword">WORKDIR</span> /app</span>
<span class="token instruction"><span class="token keyword">RUN</span> cargo init</span>
<span class="token instruction"><span class="token keyword">RUN</span> cargo build --release</span>
<span class="token instruction"><span class="token keyword">CMD</span> [<span class="token string">"./target/release/app"</span>]</span></code><!-- HTML_TAG_END --></pre></div></div> <p data-svelte-h="svelte-1lg13w3">And you run it with the following command:</p> <div class="code-block svelte-11qxx87"> <div class="lang svelte-11qxx87">console</div> <button class="copy-button copy-button-gray svelte-11qxx87"></button> <div class="code-content"><pre class="language-console"><!-- HTML_TAG_START --><code class="language-console">docker build -t docker-rust-app-running-with-root .
docker run --rm -it docker-rust-app-running-with-root whoami</code><!-- HTML_TAG_END --></pre></div></div> <p data-svelte-h="svelte-1xp5ccj">You will see it is executed as <code>root</code>.</p> <p data-svelte-h="svelte-19l2oa0">You should not execute containers as <code>root</code> because of:</p> <ol data-svelte-h="svelte-56q2gj"><li><p><strong>The Principle of Least Privilege</strong>: This is a security concept that encourages the minimal user permission level necessary to perform a task. Running containers as root goes against this principle because if a process inside the container can run with root privileges, it can execute any command inside the container, which could be dangerous if the container gets compromised.</p></li> <li><p><strong>Host System Vulnerability</strong>: Containers are designed to be isolated from the host system. However, there are ways that a container could potentially interact with the host, particularly if there are misconfigurations or vulnerabilities in the container runtime or the host’s kernel. A container running as root might be able to exploit such vulnerabilities to gain control over the host system.</p></li> <li><p><strong>Immutable Infrastructure</strong>: Containers are often used as part of an immutable infrastructure, where container images are pre-built and should not change. Running as root makes it easier to make changes to the running container, which can lead to “configuration drift” and unexpected behavior.</p></li> <li><p><strong>Accidental Damage</strong>: Even if an attacker does not compromise the container, running as root increases the risk of accidental damage by the container’s own applications or administrators. For example, a poorly crafted command could delete critical files or disrupt important processes.</p></li></ol> <p data-svelte-h="svelte-16n7gvb">There are some ways to avoid running the container as <code>root</code>. We will see all of them.</p> <h3 id="use-the-user-instruction" data-svelte-h="svelte-1kd4y7f"><a class="heading-link" title="Permalink" aria-hidden="true" href="#use-the-user-instruction"><span>#</span></a>Use the <code>USER</code> instruction</h3> <div class="code-block svelte-11qxx87"> <div class="lang svelte-11qxx87">dockerfile</div> <button class="copy-button copy-button-gray svelte-11qxx87"></button> <div class="code-content"><pre class="language-dockerfile"><!-- HTML_TAG_START --><code class="language-dockerfile"><span class="token instruction"><span class="token keyword">FROM</span> rust:latest</span>

<span class="token instruction"><span class="token keyword">WORKDIR</span> /app</span>

<span class="token instruction"><span class="token keyword">RUN</span> cargo init</span>
<span class="token instruction"><span class="token keyword">RUN</span> cargo build --release</span>

<span class="token instruction"><span class="token keyword">USER</span> www-data</span>

<span class="token instruction"><span class="token keyword">CMD</span> [<span class="token string">"./target/release/app"</span>]</span></code><!-- HTML_TAG_END --></pre></div></div> <p data-svelte-h="svelte-ifo8u1">You can add the <code>USER</code> instruction before the last command. In that example we
know that the base image already contains the user <code>www-data</code>.</p> <div class="code-block svelte-11qxx87"> <div class="lang svelte-11qxx87">console</div> <button class="copy-button copy-button-gray svelte-11qxx87"></button> <div class="code-content"><pre class="language-console"><!-- HTML_TAG_START --><code class="language-console">docker run --rm -it docker-rust-app-running-with-root cat /etc/passwd | grep www-data
www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin</code><!-- HTML_TAG_END --></pre></div></div> <p data-svelte-h="svelte-163jsvx">But you can also create a specific user for your application:</p> <div class="code-block svelte-11qxx87"> <div class="lang svelte-11qxx87">dockerfile</div> <button class="copy-button copy-button-gray svelte-11qxx87"></button> <div class="code-content"><pre class="language-dockerfile"><!-- HTML_TAG_START --><code class="language-dockerfile"><span class="token instruction"><span class="token keyword">FROM</span> rust:latest</span>

<span class="token instruction"><span class="token keyword">WORKDIR</span> /app</span>

<span class="token instruction"><span class="token keyword">RUN</span> cargo init</span>
<span class="token instruction"><span class="token keyword">RUN</span> cargo build --release</span>

<span class="token instruction"><span class="token keyword">RUN</span> groupadd -r appuser</span>
<span class="token instruction"><span class="token keyword">RUN</span> useradd -r -u 1001 -g appuser appuser</span>

<span class="token instruction"><span class="token keyword">USER</span> appuser</span>

<span class="token instruction"><span class="token keyword">CMD</span> [<span class="token string">"./target/release/app"</span>]</span></code><!-- HTML_TAG_END --></pre></div></div> <p data-svelte-h="svelte-1urcnog">Using the <code>USER</code> instruction is considered a good practice because by default the container
will not run as root. In that example, docker will run the container as the user with the ID <code>1001</code>.</p> <div class="callout-block info svelte-sxx0n0"><div class="icon-wrapper svelte-sxx0n0"><svg width="100%" height="100%" stroke-width="1.5" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 11.5V16.5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path d="M12 7.51L12.01 7.49889" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path d="M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path></svg></div> <p data-svelte-h="svelte-ivivrm">The Linux Standard Base Core Specification defines three different ranges for
user IDs, the value from 0 to 99, 100 to 999, and 1000 and above. The first two
ranges are reserved for system users. All the regular users start from 1000.
It’s also important to note that the user ID 0 is reserved for the root user and
Linux kernel uses the user id and group id to handle the permissions. The host
machine and the docker container might have the same user ID but different usernames.</p></div> <p data-svelte-h="svelte-1ne3nlk">If you run that container, <code>appuser</code> will have the same permissions as the user <code>1001</code>
in the host system, whatever it is the name of that user in the host machine.</p> <h3 id="use-the-docker-run---user-argument" data-svelte-h="svelte-7ojjtb"><a class="heading-link" title="Permalink" aria-hidden="true" href="#use-the-docker-run---user-argument"><span>#</span></a>Use The <code>docker run --user</code> Argument</h3> <p data-svelte-h="svelte-1gvovnw">You can also overwrite the user running the container with the argument <code>--user</code>:</p> <div class="code-block svelte-11qxx87"> <div class="lang svelte-11qxx87">console</div> <button class="copy-button copy-button-gray svelte-11qxx87"></button> <div class="code-content"><pre class="language-console"><!-- HTML_TAG_START --><code class="language-console">docker run --user www-data --rm -it docker-rust-app-running-with-root whoami
www-data</code><!-- HTML_TAG_END --></pre></div></div> <p data-svelte-h="svelte-1eslp6d">In this example, even though the image is executed as root by default, it will be
executed as the <code>www-data</code> user.</p> <p data-svelte-h="svelte-3tgesj">Notice you can even use a non-existing user in both the host and the docker image.</p> <div class="code-block svelte-11qxx87"> <div class="lang svelte-11qxx87">console</div> <button class="copy-button copy-button-gray svelte-11qxx87"></button> <div class="code-content"><pre class="language-console"><!-- HTML_TAG_START --><code class="language-console">$ docker run --user 1001 --rm -it docker-rust-app-running-with-root bash
I have no name!@895b0f6a3dbb:/app$</code><!-- HTML_TAG_END --></pre></div></div> <p data-svelte-h="svelte-1pa66tj">All these solutions work but they all have a drawback: you need to know the user
ID at build time (when you build the docker image). You usually want to run the
container in different environments and sometimes you want to use a different
user ID for each environment. For example:</p> <ul data-svelte-h="svelte-16bqamd"><li><strong>For development</strong>: If you are using Ubuntu, your user ID is probably <code>1000</code>. When
you run the container locally you want to run it using that ID, so that you don’t
have any problems with permissions.</li> <li><strong>For CI</strong>: The servers you are using for continuous integration (for instance, GitHub runners)
might use an specif user. You could use some cache folders and maybe you need to
use the same user ID as the CI server.</li> <li><strong>For production</strong>: You could create a specific user for your application and use that
user ID.</li></ul> <p data-svelte-h="svelte-187e9h7">With the proposed solutions you would need to rebuild the docker image so that the
user ID inside the container is the same as the host user ID.</p> <h3 id="create-the-user-at-runtime" data-svelte-h="svelte-273n8g"><a class="heading-link" title="Permalink" aria-hidden="true" href="#create-the-user-at-runtime"><span>#</span></a>Create The User At Runtime</h3> <p data-svelte-h="svelte-q9n163">There is al alternative to the previous solutions that makes it possible to <strong>run the
container with different user IDs without rebuilding the image</strong>.</p> <div class="code-block svelte-11qxx87"> <div class="lang svelte-11qxx87">dockerfile</div> <button class="copy-button copy-button-gray svelte-11qxx87"></button> <div class="code-content"><pre class="language-dockerfile"><!-- HTML_TAG_START --><code class="language-dockerfile">
<span class="token comment">## Compile su-exec</span>
<span class="token instruction"><span class="token keyword">FROM</span> docker.io/library/gcc:bookworm <span class="token keyword">as</span> gcc</span>
<span class="token instruction"><span class="token keyword">COPY</span> ./contrib/dev-tools/su-exec/ /usr/local/src/su-exec/</span>
<span class="token instruction"><span class="token keyword">RUN</span> cc -Wall -Werror -g /usr/local/src/su-exec/su-exec.c -o /usr/local/bin/su-exec; chmod +x /usr/local/bin/su-exec</span>

<span class="token comment">## Application</span>
<span class="token instruction"><span class="token keyword">FROM</span> rust:bookworm <span class="token keyword">as</span> builder</span>
<span class="token instruction"><span class="token keyword">WORKDIR</span> /app</span>
<span class="token instruction"><span class="token keyword">RUN</span> cargo init</span>
<span class="token instruction"><span class="token keyword">RUN</span> cargo build --release</span>
<span class="token instruction"><span class="token keyword">CMD</span> [<span class="token string">"./target/release/app"</span>]</span>

<span class="token comment">## Runtime</span>
<span class="token instruction"><span class="token keyword">FROM</span> gcr.io/distroless/cc-debian12:debug <span class="token keyword">as</span> runtime</span>
<span class="token instruction"><span class="token keyword">RUN</span> [<span class="token string">"/busybox/cp"</span>, <span class="token string">"-sp"</span>, <span class="token string">"/busybox/sh"</span>,<span class="token string">"/busybox/cat"</span>,<span class="token string">"/busybox/ls"</span>,<span class="token string">"/busybox/env"</span>, <span class="token string">"/bin/"</span>]</span>

<span class="token instruction"><span class="token keyword">COPY</span> <span class="token options"><span class="token property">--from</span><span class="token punctuation">=</span><span class="token string">builder</span></span> /app/target/release/app /usr/local/bin/app</span>
<span class="token instruction"><span class="token keyword">COPY</span> <span class="token options"><span class="token property">--from</span><span class="token punctuation">=</span><span class="token string">gcc</span> <span class="token property">--chmod</span><span class="token punctuation">=</span><span class="token string">0555</span></span> /usr/local/bin/su-exec /bin/su-exec</span>
<span class="token instruction"><span class="token keyword">COPY</span> <span class="token options"><span class="token property">--chmod</span><span class="token punctuation">=</span><span class="token string">0555</span></span> ./share/container/entry_script_sh /usr/local/bin/entry.sh</span>

<span class="token instruction"><span class="token keyword">ENTRYPOINT</span> [<span class="token string">"/usr/local/bin/entry.sh"</span>]</span>
<span class="token instruction"><span class="token keyword">CMD</span> [<span class="token string">"/usr/local/bin/app"</span>]</span>
</code><!-- HTML_TAG_END --></pre></div></div> <p data-svelte-h="svelte-1eodbad">This is the approach we use in Torrust. You run the docker as <code>root</code> but we always
use an entrypoint. That entrypoint creates a new user with an ID provided as an
environment variable.</p> <p data-svelte-h="svelte-1v8jphd">The <code>entry.sh</code> script is always called when you run the container because it is
defined as an <code>ENTRYPOINT</code>. This “middleware” script creates the user if it does
not exist, and then runs the application using the <a href="https://github.com/ncopa/su-exec" rel="nofollow">su-exec</a>
program to change the user ID it is executed with.</p> <p data-svelte-h="svelte-1wsqwjd"><strong>For those who are interested here is our: <a href="https://github.com/torrust/torrust-tracker/blob/develop/share/container/entry_script_sh" rel="nofollow">entry script</a>.</strong></p> <p data-svelte-h="svelte-x7o0dz">As you can read on the su-exec documentation:</p> <div class="callout-block info svelte-sxx0n0"><div class="icon-wrapper svelte-sxx0n0"><svg width="100%" height="100%" stroke-width="1.5" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 11.5V16.5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path d="M12 7.51L12.01 7.49889" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path d="M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path></svg></div> <p data-svelte-h="svelte-1qseehr">“su-exec” is a simple tool that will simply execute a program with different privileges.
The program will be executed directly and not run as a child, like su and sudo does,
which avoids TTY and signal issues (see below).</p> <p data-svelte-h="svelte-r9pi87">Notice that su-exec depends on being run by the root user, non-root users do not
have permission to change uid/gid.</p></div> <p data-svelte-h="svelte-1shdd3c">The advantage of this approach is that you don’t have to worry about the user ID
when you build the docker image. You can run the container as root and then use
the entrypoint to create the user and run the application with that user.</p> <p data-svelte-h="svelte-9qnch7">The entrypoint also ensures that the application is executed with the correct
permissions. You cannot run the application as root unless you explicitly set
the environment variable <code>USER_ID</code> to <code>0</code>.</p> <p data-svelte-h="svelte-4o8v7">If you want to contribute to Torrust we think that we could simplify the Containerfile
if the “su-exec” command were available in Rust. Because we could reuse one of the
Rust docker images we are using for other docker stages.</p> <h2 id="decomposing-the-torrust-tracker-containerfile" data-svelte-h="svelte-1qu4fyq"><a class="heading-link" title="Permalink" aria-hidden="true" href="#decomposing-the-torrust-tracker-containerfile"><span>#</span></a>Decomposing the Torrust Tracker Containerfile</h2> <p data-svelte-h="svelte-1flhjok">Finally we can explain line by line what the <a href="https://github.com/torrust/torrust-tracker/blob/develop/Containerfile" rel="nofollow">Torrust Tracker Containerfile</a> does.</p> <p data-svelte-h="svelte-1lylxvu">Rust apps can be built in <code>debug</code> or <code>release</code> mode. The <code>Containerfile</code> builds both
modes and then it runs the tests for both modes. We have removed the <code>debug</code> mode
to keep the example short. But it is almost the same code. For the <code>release</code> mode
the flag <code>--release</code> is added to some commands.</p> <p data-svelte-h="svelte-14mcm6e">We can abstract away the stages:</p> <div class="code-block svelte-11qxx87"> <div class="lang svelte-11qxx87">dockerfile</div> <button class="copy-button copy-button-gray svelte-11qxx87"></button> <div class="code-content"><pre class="language-dockerfile"><!-- HTML_TAG_START --><code class="language-dockerfile"><span class="token comment">## Base Builder Image</span>
<span class="token instruction"><span class="token keyword">FROM</span> rust:bookworm <span class="token keyword">as</span> chef</span>
<span class="token comment"># Install tools needed to build the application: cargo-chef cargo-nextest</span>

<span class="token comment">## Tester Image</span>
<span class="token instruction"><span class="token keyword">FROM</span> rust:slim-bookworm <span class="token keyword">as</span> tester</span>
<span class="token comment"># Install tools needed to test the application: cargo-nextest</span>

<span class="token comment">## Su Exe Compile</span>
<span class="token instruction"><span class="token keyword">FROM</span> docker.io/library/gcc:bookworm <span class="token keyword">as</span> gcc</span>
<span class="token comment"># Compile the su-exec program which is used at runtime to change the user running the container.</span>

<span class="token comment">## Chef Prepare (look at project and see wat we need)</span>
<span class="token instruction"><span class="token keyword">FROM</span> chef <span class="token keyword">AS</span> recipe</span>
<span class="token comment"># Prepare the info needed to build and cache cargo dependencies</span>

<span class="token comment">## Cook (release)</span>
<span class="token instruction"><span class="token keyword">FROM</span> chef <span class="token keyword">AS</span> dependencies</span>
<span class="token comment"># Re-hydrate the minimum project skeleton identified by &#96;cargo chef prepare&#96; and build it to cache dependencies</span>

<span class="token comment">## Build Archive (release)</span>
<span class="token instruction"><span class="token keyword">FROM</span> dependencies <span class="token keyword">AS</span> build</span>
<span class="token comment"># build and archive the application</span>

<span class="token comment"># Extract and Test (release)</span>
<span class="token instruction"><span class="token keyword">FROM</span> tester <span class="token keyword">as</span> test</span>
<span class="token comment"># Extract the application from the archived artifacts and run the tests.</span>
<span class="token comment"># And copy the binary to an specified location so it can be used in the &#96;release&#96;</span>
<span class="token comment"># stage.</span>

<span class="token comment">## Runtime</span>
<span class="token instruction"><span class="token keyword">FROM</span> gcr.io/distroless/cc-debian12:debug <span class="token keyword">as</span> runtime</span>
<span class="token comment"># Minimal image to run the app in production.</span>
<span class="token comment"># Includes the entrypoint to setup and run the application with a different user Id.</span>

<span class="token comment">## Release Runtime</span>
<span class="token instruction"><span class="token keyword">FROM</span> runtime <span class="token keyword">as</span> release</span>
<span class="token comment"># Runtime for release mode. It copies the binary from the &#96;test&#96; stage and runs it</span>
<span class="token comment"># via the entrypoint added in the &#96;runtime&#96; stage.</span></code><!-- HTML_TAG_END --></pre></div></div> <p data-svelte-h="svelte-4l2mid">Let’s see each stage individually.</p> <p data-svelte-h="svelte-wr5nrh">First, we have a base builder image where we install basic tools to build the application.</p> <div class="code-block svelte-11qxx87"> <div class="lang svelte-11qxx87">dockerfile</div> <button class="copy-button copy-button-gray svelte-11qxx87"></button> <div class="code-content"><pre class="language-dockerfile"><!-- HTML_TAG_START --><code class="language-dockerfile"><span class="token comment">## Base Builder Image</span>
<span class="token instruction"><span class="token keyword">FROM</span> rust:bookworm <span class="token keyword">as</span> chef</span>
<span class="token instruction"><span class="token keyword">WORKDIR</span> /tmp</span>
<span class="token instruction"><span class="token keyword">RUN</span> curl -L --proto <span class="token string">'=https'</span> --tlsv1.2 -sSf https://raw.githubusercontent.com/cargo-bins/cargo-binstall/main/install-from-binstall-release.sh | bash</span>
<span class="token instruction"><span class="token keyword">RUN</span> cargo binstall --no-confirm cargo-chef cargo-nextest</span></code><!-- HTML_TAG_END --></pre></div></div> <p data-svelte-h="svelte-pglm9y">There is nothing really strange here. We use the latest Debian “bookworm” at the time
of writing this article. And we also use <code>binstall</code> to install the binaries, since
both of these binaries are written in Rust.</p> <p data-svelte-h="svelte-hitqor">The next stage is the base Tester Image. It only installs <code>cargo-nextest</code> to run the tests.
We also use the Debian “bookworm” but the <code>slim</code> variant, since we don’t need too much
to only run the tests.</p> <div class="code-block svelte-11qxx87"> <div class="lang svelte-11qxx87">dockerfile</div> <button class="copy-button copy-button-gray svelte-11qxx87"></button> <div class="code-content"><pre class="language-dockerfile"><!-- HTML_TAG_START --><code class="language-dockerfile"><span class="token comment">## Base Tester Image</span>
<span class="token instruction"><span class="token keyword">FROM</span> rust:slim-bookworm <span class="token keyword">as</span> tester</span>
<span class="token instruction"><span class="token keyword">WORKDIR</span> /tmp</span>
<span class="token instruction"><span class="token keyword">RUN</span> apt-get update; apt-get install -y curl; apt-get autoclean</span>
<span class="token instruction"><span class="token keyword">RUN</span> curl -L --proto <span class="token string">'=https'</span> --tlsv1.2 -sSf https://raw.githubusercontent.com/cargo-bins/cargo-binstall/main/install-from-binstall-release.sh | bash</span>
<span class="token instruction"><span class="token keyword">RUN</span> cargo binstall --no-confirm cargo-nextest</span></code><!-- HTML_TAG_END --></pre></div></div> <p data-svelte-h="svelte-ce2qns">The following is another stage used just to compile the small program <a href="https://github.com/ncopa/su-exec" rel="nofollow">su-exec</a> that we use to change the user ID when we run the container. The program is written
in C code, so we only need a C compiler.</p> <div class="code-block svelte-11qxx87"> <div class="lang svelte-11qxx87">dockerfile</div> <button class="copy-button copy-button-gray svelte-11qxx87"></button> <div class="code-content"><pre class="language-dockerfile"><!-- HTML_TAG_START --><code class="language-dockerfile"><span class="token comment">## Su Exe Compile</span>
<span class="token instruction"><span class="token keyword">FROM</span> docker.io/library/gcc:bookworm <span class="token keyword">as</span> gcc</span>
<span class="token instruction"><span class="token keyword">COPY</span> ./contrib/dev-tools/su-exec/ /usr/local/src/su-exec/</span>
<span class="token instruction"><span class="token keyword">RUN</span> cc -Wall -Werror -g /usr/local/src/su-exec/su-exec.c -o /usr/local/bin/su-exec; chmod +x /usr/local/bin/su-exec</span></code><!-- HTML_TAG_END --></pre></div></div> <p data-svelte-h="svelte-1qimsxt">From this point, we start building the application. First, we build the dependencies
and we cache them into an independent stage.</p> <p data-svelte-h="svelte-q7ly23">The first stage is only to “build the recipe” which is the name that <code>cargo chef</code>
gives to the process of collecting all the information needed to build the application
dependencies.</p> <div class="code-block svelte-11qxx87"> <div class="lang svelte-11qxx87">dockerfile</div> <button class="copy-button copy-button-gray svelte-11qxx87"></button> <div class="code-content"><pre class="language-dockerfile"><!-- HTML_TAG_START --><code class="language-dockerfile"><span class="token comment">## Chef Prepare (look at project and see wat we need)</span>
<span class="token instruction"><span class="token keyword">FROM</span> chef <span class="token keyword">AS</span> recipe</span>
<span class="token instruction"><span class="token keyword">WORKDIR</span> /build/src</span>
<span class="token instruction"><span class="token keyword">COPY</span> . /build/src</span>
<span class="token instruction"><span class="token keyword">RUN</span> cargo chef prepare --recipe-path /build/recipe.json</span></code><!-- HTML_TAG_END --></pre></div></div> <p data-svelte-h="svelte-11c4qtl">Then, cargo dependencies are built using using the recipe created in the previous stage.
<code>cargo nextest</code> has a subcommand to generate and archive the artifact of the build.
We are using it to package and pass the application from one stage to another.</p> <p data-svelte-h="svelte-i61gzi">Dependencies are archived but they are not used independently. That line just tests
that the dependencies could be archived.</p> <div class="code-block svelte-11qxx87"> <div class="lang svelte-11qxx87">dockerfile</div> <button class="copy-button copy-button-gray svelte-11qxx87"></button> <div class="code-content"><pre class="language-dockerfile"><!-- HTML_TAG_START --><code class="language-dockerfile"><span class="token comment">## Cook (release)</span>
<span class="token instruction"><span class="token keyword">FROM</span> chef <span class="token keyword">AS</span> dependencies</span>
<span class="token instruction"><span class="token keyword">WORKDIR</span> /build/src</span>
<span class="token instruction"><span class="token keyword">COPY</span> <span class="token options"><span class="token property">--from</span><span class="token punctuation">=</span><span class="token string">recipe</span></span> /build/recipe.json /build/recipe.json</span>
<span class="token instruction"><span class="token keyword">RUN</span> cargo chef cook --tests --benches --examples --workspace --all-targets --all-features --recipe-path /build/recipe.json --release</span>
<span class="token instruction"><span class="token keyword">RUN</span> cargo nextest archive --tests --benches --examples --workspace --all-targets --all-features --archive-file /build/temp.tar.zst --release  ; rm -f /build/temp.tar.zst</span></code><!-- HTML_TAG_END --></pre></div></div> <p data-svelte-h="svelte-fhpivi">In the following stage we build the application. The <code>cargo nextest archive</code> command builds
and archives the application.</p> <div class="code-block svelte-11qxx87"> <div class="lang svelte-11qxx87">dockerfile</div> <button class="copy-button copy-button-gray svelte-11qxx87"></button> <div class="code-content"><pre class="language-dockerfile"><!-- HTML_TAG_START --><code class="language-dockerfile"><span class="token comment">## Build Archive (release)</span>
<span class="token instruction"><span class="token keyword">FROM</span> dependencies <span class="token keyword">AS</span> build</span>
<span class="token instruction"><span class="token keyword">WORKDIR</span> /build/src</span>
<span class="token instruction"><span class="token keyword">COPY</span> . /build/src</span>
<span class="token instruction"><span class="token keyword">RUN</span> cargo nextest archive --tests --benches --examples --workspace --all-targets --all-features --archive-file /build/full-example.tar.zst --release</span></code><!-- HTML_TAG_END --></pre></div></div> <p data-svelte-h="svelte-blek30">Now, that we have successfully built the application, we can run the tests. We
extract the application from the archived artifacts and run the tests.</p> <div class="code-block svelte-11qxx87"> <div class="lang svelte-11qxx87">dockerfile</div> <button class="copy-button copy-button-gray svelte-11qxx87"></button> <div class="code-content"><pre class="language-dockerfile"><!-- HTML_TAG_START --><code class="language-dockerfile"><span class="token comment">## Extract and Test (release)</span>
<span class="token instruction"><span class="token keyword">FROM</span> tester <span class="token keyword">as</span> test</span>
<span class="token instruction"><span class="token keyword">WORKDIR</span> /test</span>
<span class="token instruction"><span class="token keyword">COPY</span> . /test/src</span>
<span class="token instruction"><span class="token keyword">COPY</span> <span class="token options"><span class="token property">--from</span><span class="token punctuation">=</span><span class="token string">build</span></span> <span class="token operator"></span>
  /build/full-example.tar.zst <span class="token operator"></span>
  /test/full-example.tar.zst</span>
<span class="token comment"># It compiles without running the tests to make sure there are no problems with</span>
<span class="token comment"># the archive.</span>
<span class="token instruction"><span class="token keyword">RUN</span> cargo nextest run --workspace-remap /test/src/ --extract-to /test/src/ --no-run --archive-file /test/full-example.tar.zst</span>
<span class="token comment"># We actually run the tests</span>
<span class="token instruction"><span class="token keyword">RUN</span> cargo nextest run --workspace-remap /test/src/ --target-dir-remap /test/src/target/ --cargo-metadata /test/src/target/nextest/cargo-metadata.json --binaries-metadata /test/src/target/nextest/binaries-metadata.json</span>
<span class="token comment"># We copy the application binary to a specified location so we can get it from</span>
<span class="token comment"># there in the final runtime stage.</span>
<span class="token instruction"><span class="token keyword">RUN</span> mkdir -p /app/bin/; cp -l /test/src/target/release/full-example /app/bin/full-example</span>
<span class="token comment"># Since we use su-exec. We need to run the container as root.</span>
<span class="token instruction"><span class="token keyword">RUN</span> chown -R root:root /app; chmod -R u=rw,go=r,a+X /app; chmod -R a+x /app/bin</span></code><!-- HTML_TAG_END --></pre></div></div> <p data-svelte-h="svelte-1a43lxq">Once the application has been built and tested we prepare the runtime. We start
from a minimum “distroless” image variant. We add an entrypoint to setup the application
and also to make sure we don’t use the <code>root</code> user to run it. The entrypoint just
runs the application provided as an argument, in our case, our application in <code>debug</code> or
<code>release</code> mode, depending of which one you want to run.</p> <div class="code-block svelte-11qxx87"> <div class="lang svelte-11qxx87">dockerfile</div> <button class="copy-button copy-button-gray svelte-11qxx87"></button> <div class="code-content"><pre class="language-dockerfile"><!-- HTML_TAG_START --><code class="language-dockerfile"><span class="token comment">## Runtime</span>
<span class="token instruction"><span class="token keyword">FROM</span> gcr.io/"distroless/cc-debian12:debug <span class="token keyword">as</span> runtime</span>
<span class="token instruction"><span class="token keyword">RUN</span> [<span class="token string">"/busybox/cp"</span>, <span class="token string">"-sp"</span>, <span class="token string">"/busybox/sh"</span>,<span class="token string">"/busybox/cat"</span>,<span class="token string">"/busybox/ls"</span>,<span class="token string">"/busybox/env"</span>, <span class="token string">"/bin/"</span>]</span>
<span class="token instruction"><span class="token keyword">COPY</span> <span class="token options"><span class="token property">--from</span><span class="token punctuation">=</span><span class="token string">gcc</span> <span class="token property">--chmod</span><span class="token punctuation">=</span><span class="token string">0555</span></span> /usr/local/bin/su-exec /bin/su-exec</span>
<span class="token instruction"><span class="token keyword">ARG</span> USER_ID=1000</span>
<span class="token instruction"><span class="token keyword">COPY</span> <span class="token options"><span class="token property">--chmod</span><span class="token punctuation">=</span><span class="token string">0555</span></span> ./share/container/entry_script_sh /usr/local/bin/entry.sh</span>
<span class="token instruction"><span class="token keyword">ENTRYPOINT</span> [<span class="token string">"/usr/local/bin/entry.sh"</span>]</span></code><!-- HTML_TAG_END --></pre></div></div> <p data-svelte-h="svelte-1ae8cp4">Finally, we add the <code>CMD</code> instruction so we can execute the application. The
entrypoint script only runs the application you pass as the first argument. This
stage is not merge into the previous because in the final version there are two
final runtimes: <code>debug</code> and <code>release</code>.</p> <div class="code-block svelte-11qxx87"> <div class="lang svelte-11qxx87">dockerfile</div> <button class="copy-button copy-button-gray svelte-11qxx87"></button> <div class="code-content"><pre class="language-dockerfile"><!-- HTML_TAG_START --><code class="language-dockerfile"><span class="token comment">## Release Runtime</span>
<span class="token instruction"><span class="token keyword">FROM</span> runtime <span class="token keyword">as</span> release</span>
<span class="token instruction"><span class="token keyword">COPY</span> <span class="token options"><span class="token property">--from</span><span class="token punctuation">=</span><span class="token string">test</span></span> /app/ /usr/</span>
<span class="token instruction"><span class="token keyword">CMD</span> [<span class="token string">"/usr/bin/full-example"</span>]</span></code><!-- HTML_TAG_END --></pre></div></div> <h2 id="other-good-practices" data-svelte-h="svelte-12ziiyq"><a class="heading-link" title="Permalink" aria-hidden="true" href="#other-good-practices"><span>#</span></a>Other Good Practices</h2> <ul data-svelte-h="svelte-pbuqhm"><li><strong>Minimalism</strong>: We strive to keep our Dockerfiles lean by only including essential components.</li> <li><strong>Explicit versions</strong>: At least with the minor version number, so you do not get unexpected broken compatibility but you can apply security and bug patches.</li> <li><strong>Regular Updates</strong>: Periodically updating the base image and dependencies to benefit from security patches and updates.</li> <li><strong>Health Checks</strong>: Implementing Docker health checks to monitor the state and health of our containerized application.</li></ul> <h2 id="other-considerations" data-svelte-h="svelte-12m3v1c"><a class="heading-link" title="Permalink" aria-hidden="true" href="#other-considerations"><span>#</span></a>Other Considerations</h2> <ul data-svelte-h="svelte-1bvek77"><li>Since we are using <code>su-exec</code> we need to run the containers as root. We have not
checked if this configuration works when you setup docker in <a href="https://docs.docker.com/engine/security/rootless/" rel="nofollow">Rootless mode</a>.</li> <li>Also, although we mostly mention docker in this article, the <code>Containerfile</code> works
with other tools to manage containers like <a href="https://podman.io/" rel="nofollow">Podman</a>.</li></ul> <h2 id="links" data-svelte-h="svelte-32dd6s"><a class="heading-link" title="Permalink" aria-hidden="true" href="#links"><span>#</span></a>Links</h2> <p data-svelte-h="svelte-4pkash">Simple tutorials:</p> <ul data-svelte-h="svelte-5j93uy"><li><a href="https://tms-dev-blog.com/lean-docker-image-for-rust-backend/" rel="nofollow">Docker image for Rust backend: learn how to</a></li> <li><a href="https://collabnix.com/getting-started-with-rust-and-docker/" rel="nofollow">Getting Started with Rust and Docker</a> by <a href="https://collabnix.com/author/ajeetraina/" rel="nofollow">Ajeet Raina</a>.</li> <li><a href="https://tutorialedge.net/rust/rust-docker-tutorial/" rel="nofollow">Rust Docker Tutorial</a>.</li> <li><a href="https://docs.docker.com/language/rust/build-images/" rel="nofollow">Build your Rust image</a></li></ul> <p data-svelte-h="svelte-bk14i0">Comprehensive articles like this:</p> <ul data-svelte-h="svelte-19n6tki"><li><a href="https://dev.to/rogertorres/first-steps-with-docker-rust-30oi" rel="nofollow">First steps with Docker + Rust</a> by <a href="https://dev.to/rogertorres" rel="nofollow">Roger Torres</a>.</li></ul> <p data-svelte-h="svelte-rz7o02">Demos:</p> <ul data-svelte-h="svelte-w3dy1g"><li><a href="https://github.com/hseeberger/hello-rs" rel="nofollow">Simple dockerized Rust/Axum based HTTP server for demo purposes</a> by <a href="https://github.com/hseeberger" rel="nofollow">Heiko Seeberger</a>.</li></ul> <p data-svelte-h="svelte-dl4iv3">Development using Docker:</p> <ul data-svelte-h="svelte-zmfpgi"><li><a href="https://www.youtube.com/watch?v=kh1GMRFkzT4&amp;t=2s" rel="nofollow">Rust Development with Docker</a>.</li> <li><a href="https://docs.docker.com/language/rust/develop/" rel="nofollow">Develop your Rust application</a></li></ul> <p data-svelte-h="svelte-uc1ydm">Deployments using docker:</p> <ul data-svelte-h="svelte-jf89i3"><li><a href="https://medium.com/@anirudhmurali/how-i-deployed-a-rust-web-app-using-the-rocket-framework-with-docker-424da99b1d8a" rel="nofollow">How I deployed a Rust web-app using the Rocket framework with Docker</a></li> <li><a href="https://www.koyeb.com/tutorials/deploy-a-rust-web-app-with-rocket" rel="nofollow">Deploy a Rust Web App With Rocket</a>.</li></ul> <p data-svelte-h="svelte-17ghd7g">Minimum sized container images:</p> <ul data-svelte-h="svelte-6p9xs0"><li><a href="https://github.com/johnthagen/min-sized-rust#containers" rel="nofollow">min-sized-rust</a> by <a href="https://github.com/johnthagen" rel="nofollow">johnthagen</a>.</li></ul> <p data-svelte-h="svelte-ym3too">Caching dependencies:</p> <ul data-svelte-h="svelte-1r5cmoj"><li><a href="https://blog.logrocket.com/packaging-a-rust-web-service-using-docker/" rel="nofollow">Packaging a Rust web service using Docker</a>.</li> <li><a href="https://dev.to/mgattozzi/plumbing-the-deps-of-the-crate-caching-rust-docker-builds-2e48" rel="nofollow">Plumbing the Deps of the Crate: Caching Rust Docker Builds</a>.</li> <li><a href="https://stackoverflow.com/questions/58473606/cache-rust-dependencies-with-docker-build" rel="nofollow">Cache Rust dependencies with Docker build</a>.</li></ul> <p data-svelte-h="svelte-c87p6b">Don’t run containers as root:</p> <ul data-svelte-h="svelte-1tvfsrk"><li><a href="https://docs.docker.com/engine/install/linux-postinstall/#manage-docker-as-a-non-root-user" rel="nofollow">Manage Docker as a non-root user</a>.</li> <li><a href="https://docs.docker.com/engine/security/rootless/" rel="nofollow">Run the Docker daemon as a non-root user (Rootless mode)</a>.</li> <li><a href="https://docs.docker.com/engine/security/#docker-daemon-attack-surface" rel="nofollow">Docker daemon attack surface</a>.</li> <li><a href="https://www.howtogeek.com/devops/why-processes-in-docker-containers-shouldnt-run-as-root/" rel="nofollow">Why Processes In Docker Containers Shouldn’t Run as Root</a>.</li> <li><a href="https://www.clickittech.com/devops/docker-security-best-practices/" rel="nofollow">The Ultimate Docker Security Best Practices for Your Node.js Application</a>.</li> <li><a href="https://stackoverflow.com/questions/68155641/should-i-run-things-inside-a-docker-container-as-non-root-for-safety" rel="nofollow">Should I run things inside a docker container as non root for safety?</a>.</li> <li><a href="https://betterprogramming.pub/running-a-container-with-a-non-root-user-e35830d1f42a" rel="nofollow">Docker Tips: Running a Container With a Non Root User</a> by <a href="https://lucjuggery.medium.com/" rel="nofollow">Luc Juggery</a>.</li> <li><a href="https://github.com/containers/podman/blob/main/docs/tutorials/rootless_tutorial.md" rel="nofollow">Basic Setup and Use of Podman in a Rootless environment</a>.</li> <li><a href="https://medium.com/@mccode/understanding-how-uid-and-gid-work-in-docker-containers-c37a01d01cf" rel="nofollow">Understanding how uid and gid work in Docker containers</a>.</li></ul> <h2 id="conclusion" data-svelte-h="svelte-br5ox0"><a class="heading-link" title="Permalink" aria-hidden="true" href="#conclusion"><span>#</span></a>Conclusion</h2> <p data-svelte-h="svelte-1e29q46">We hope you find this guide useful. Let us know what you think about it!</p> <p data-svelte-h="svelte-1dx3a01">We want this article to be a collective effort to document good practices about
Rust and Containers, so we would like to have reviews, comments, new sections, etcetera.</p> <p data-svelte-h="svelte-gxsd2p">If you see something wrong or you want to contribute by:</p> <ul data-svelte-h="svelte-x1w50s"><li>Adding new sections.</li> <li>Fixing typos.</li> <li>Making it clearer.</li> <li>Adding links.</li> <li>Or whatever you think it could be interesting to have,</li></ul> <p data-svelte-h="svelte-1cyks1i">please open an <a href="https://github.com/torrust/torrust-website/issues" rel="nofollow">issue</a> or a <a href="https://github.com/torrust/torrust-website/pulls" rel="nofollow">PR</a>.</p> <p data-svelte-h="svelte-1e9qm2v">If you have any questions or issues please open an issue on the corresponding repository:</p> <ul data-svelte-h="svelte-172itm0"><li>Torrust Tracker: <a href="https://github.com/torrust/torrust-tracker/issues" rel="nofollow">https://github.com/torrust/torrust-tracker/issues</a></li> <li>Torrust Index: <a href="https://github.com/torrust/torrust-index-backend/issues" rel="nofollow">https://github.com/torrust/torrust-index-backend/issues</a></li> <li>Torrust Website: <a href="https://github.com/torrust/torrust-index-frontend/issues" rel="nofollow">https://github.com/torrust/torrust-index-frontend/issues</a></li> <li>Containerizing Rust Applications Examples: <a href="https://github.com/torrust/containerizing-rust-apps-examples" rel="nofollow">https://github.com/torrust/containerizing-rust-apps-examples</a></li></ul> <p data-svelte-h="svelte-nld7t3">We very welcome any contributions to the projects or <a href="https://github.com/torrust/torrust-website/issues" rel="nofollow">this article</a>.</p></div></div>
          ]]></content:encoded>
          <media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://v2.torrust.com//images/posts/rust-crab-carrying-a-shipping-container.jpeg"/>
          <media:content xmlns:media="http://search.yahoo.com/mrss/" medium="image" url="https://v2.torrust.com//images/posts/rust-crab-carrying-a-shipping-container.jpeg"/>          
        </item>
      
        <item>
          <guid>https://v2.torrust.com/what-is-a-bittorrent-tracker</guid>
          <title>What is a BitTorrent tracker and types of trackers</title>
          <description>Basic explanation of what a BitTorrent tracker is and the two types of trackers, public and private.</description>
          <link>https://v2.torrust.com/what-is-a-bittorrent-tracker</link>
          <pubDate>05/10/2023 13:42:25</pubDate>
          <category>Torrent</category><category>Tracker</category><category>BitTorrent</category>
          <content:encoded><![CDATA[
            <div style="margin: 50px 0; font-style: italic;">
              If anything looks wrong, 
              <strong>
                <a href="https://v2.torrust.com/what-is-a-bittorrent-tracker">
                  read on the site!
                </a>
              </strong>
            </div>

            <p data-svelte-h="svelte-10idxpu">Photo by Alex Andrews: <a href="https://www.pexels.com/photo/shallow-focus-photography-of-black-and-silver-compasses-on-top-of-map-1203808/" rel="nofollow">https://www.pexels.com/photo/shallow-focus-photography-of-black-and-silver-compasses-on-top-of-map-1203808/</a>.</p>  <div class="flex svelte-19d8qsr"> <div class=" svelte-13ebny9" style="position: relative;"><div class="svelte-13ebny9"><h2 id="table-of-contents" data-svelte-h="svelte-1m3njcc"><a class="heading-link" title="Permalink" aria-hidden="true" href="#table-of-contents"><span>#</span></a>Table of Contents</h2> <ul data-svelte-h="svelte-1ur0ixx"><li><a href="#introduction">Introduction</a></li> <li><a href="#what-is-a-bittorrent-tracker">What is a BitTorrent Tracker</a></li> <li><a href="#public-trackers">Public trackers</a></li> <li><a href="#private-trackers">Private trackers</a></li> <li><a href="#bittorrent-index-vs-bittorrent-tracker">BitTorrent Index vs BitTorrent Tracker</a></li></ul></div></div> <div class="svelte-4jsat1"><h2 id="introduction" data-svelte-h="svelte-1ahwhrx"><a class="heading-link" title="Permalink" aria-hidden="true" href="#introduction"><span>#</span></a>Introduction</h2> <p data-svelte-h="svelte-biflki">Usually, when we think about Torrents, we think about a program used to download files from a group of people through the internet. But some of those users don’t know what a tracker is.</p> <p data-svelte-h="svelte-1q1ns8y">In this article, I will explain a BitTorrent tracker and the two types of trackers (public and private).</p> <h2 id="what-is-a-bittorrent-tracker" data-svelte-h="svelte-d3fptx"><a class="heading-link" title="Permalink" aria-hidden="true" href="#what-is-a-bittorrent-tracker"><span>#</span></a>What is a BitTorrent Tracker</h2> <p data-svelte-h="svelte-10pp3pb">A BitTorrent tracker is a server (actually an app running on a server) that helps peers who use the BitTorrent protocol share their files.</p> <p data-svelte-h="svelte-v9c68f">It is responsible for keeping track of what peer machines (BitTorrent clients and their IPs) have what files and whether they are available or not, so when you add a .torrent file to your torrent client, the tracker lets you know where to start getting parts of that file.</p> <p data-svelte-h="svelte-1xy4hrv">It also helps with the communication between peers and data transmission, making the entire process more efficient.</p> <p data-svelte-h="svelte-sx3ffg">When downloading files, the client will go back to the tracker every once in a while to send statistics and improve the download speed, as it gets newly updated info about other peers sharing the files.</p> <h2 id="public-trackers" data-svelte-h="svelte-dmcq3r"><a class="heading-link" title="Permalink" aria-hidden="true" href="#public-trackers"><span>#</span></a>Public trackers</h2> <p data-svelte-h="svelte-7157k3">Public trackers are open to everybody. They don’t require registration, even though some will allow it and provide benefits to those users. They usually contain torrent files about different themes (music, films, games, etc.).</p> <p data-svelte-h="svelte-o6o11j">They are the most straightforward way to get torrents, which may be a good starting point for beginners.</p> <p data-svelte-h="svelte-hoa9e2">There are also some cons when using public trackers.</p> <p data-svelte-h="svelte-1bhcqgj">Malware can be found in torrent files and websites, which many people use. It is the perfect target for people with malicious intentions. You should always check for .exe, .bat or other executable files, and remember to read the comments of the torrent file you want to download.</p> <p data-svelte-h="svelte-bowkeq">You can also wait a few days if the torrent is new and let other people test the file and see if they comment about the torrent containing any malware.</p> <p data-svelte-h="svelte-1risze5">Another downside regarding security is that if you don’t use methods to avoid tracking, like a VPN, anyone can get access to your IP.</p> <p data-svelte-h="svelte-15lj26z">Also, public trackers may attract more attention from authorities. Hence, using public trackers to download illegal stuff has a greater chance of getting you into trouble.</p> <h2 id="private-trackers" data-svelte-h="svelte-17rz5zd"><a class="heading-link" title="Permalink" aria-hidden="true" href="#private-trackers"><span>#</span></a>Private trackers</h2> <p data-svelte-h="svelte-1rscnzn">Private trackers require registration. Some of them are also hidden, and their access depends on private invitations or a process defined by the tracker. It may include an interview or other means.</p> <p data-svelte-h="svelte-5w0ux5">Private trackers usually contain better-quality torrents and hard-to-find ones.</p> <p data-svelte-h="svelte-djasth">They might ask you to have a good ratio, so when using them, you need to make sure you share files and download them, which can be cumbersome at times.</p> <p data-svelte-h="svelte-3lw2c5">It is still recommended that you use a VPN to increase privacy and security; people can still access your IP if not hidden, and authorities can still lurk around private torrents.</p> <p data-svelte-h="svelte-pdqcpw">Also, always be aware of malware on private trackers.</p> <p data-svelte-h="svelte-13lt0t9">I also recommend using common sense regarding sharing private information in the interview process, which some private trackers require.</p> <h2 id="bittorrent-index-vs-bittorrent-tracker" data-svelte-h="svelte-e9n6iu"><a class="heading-link" title="Permalink" aria-hidden="true" href="#bittorrent-index-vs-bittorrent-tracker"><span>#</span></a>BitTorrent Index vs BitTorrent Tracker</h2> <p data-svelte-h="svelte-cg0hge">It is essential to differentiate between a BitTorrent tracker and an index, as some people use the terms index and tracker indistinctively when, actually, there are two different things.</p> <p data-svelte-h="svelte-ir9b25">A BitTorrent index is a website that serves as a directory of classified torrent files where users can search for and download them.</p> <p data-svelte-h="svelte-1r15vzx">When you download a torrent file from a BitTorrent index site, it usually contains a list of URLs for trackers where your client can request torrent pieces.</p> <p data-svelte-h="svelte-gh6p3z">Often, the index site has an associated tracker that is included in the list of tracker URLs in the torrent file.</p> <p data-svelte-h="svelte-19dfrv">A tracker, as previously described above, takes care of efficient data transmission between the peers in the swarm when sharing files using the BitTorrent protocol.</p> <p data-svelte-h="svelte-b40mrm"><strong>I hope you have found this article useful!</strong></p> <p data-svelte-h="svelte-mcy6nd">If you have any questions or issues regarding this post, please <a href="https://github.com/torrust/torrust-website/issues/new" rel="nofollow">open an issue</a>.</p> <p data-svelte-h="svelte-19k8tej">For any other questions or issues related to Torrust repositories, please open an issue on the corresponding repository:</p> <ul data-svelte-h="svelte-1r8qk6t"><li>Torrust Tracker: <a href="https://github.com/torrust/torrust-tracker/issues" rel="nofollow">https://github.com/torrust/torrust-tracker/issues</a></li> <li>Torrust Index Backend: <a href="https://github.com/torrust/torrust-index-backend/issues" rel="nofollow">https://github.com/torrust/torrust-index-backend/issues</a></li> <li>Torrust Index Frontend: <a href="https://github.com/torrust/torrust-index-frontend/issues" rel="nofollow">https://github.com/torrust/torrust-index-frontend/issues</a></li></ul> <p data-svelte-h="svelte-v20sdj">We very welcome any contributions to the project!</p></div></div>
          ]]></content:encoded>
          <media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://v2.torrust.com//images/posts/tracker.jpg"/>
          <media:content xmlns:media="http://search.yahoo.com/mrss/" medium="image" url="https://v2.torrust.com//images/posts/tracker.jpg"/>          
        </item>
      
        <item>
          <guid>https://v2.torrust.com/introducing-the-new-sample-torrent-migration-tool</guid>
          <title>Introducing the New Sample Torrent Migration Tool</title>
          <description>Looking to migrate to the Torrust Index? Dive into our Torrents Importer Sample to seamlessly transfer your torrents to Torrust.</description>
          <link>https://v2.torrust.com/introducing-the-new-sample-torrent-migration-tool</link>
          <pubDate>04/09/2023 13:24:27</pubDate>
          <category>Migration Tool</category><category>Sample</category>
          <content:encoded><![CDATA[
            <div style="margin: 50px 0; font-style: italic;">
              If anything looks wrong, 
              <strong>
                <a href="https://v2.torrust.com/introducing-the-new-sample-torrent-migration-tool">
                  read on the site!
                </a>
              </strong>
            </div>

            <p data-svelte-h="svelte-1iefhg6">Photo by David Dibert: <a href="https://www.pexels.com/photo/a-flock-of-geese-flying-7177008/" rel="nofollow">https://www.pexels.com/photo/a-flock-of-geese-flying-7177008/</a>.</p> <p data-svelte-h="svelte-ubtbd9">Hello, Torrust community!</p> <p data-svelte-h="svelte-1iez7gt">We’re always looking for ways to enhance your experience with Torrust, and today, we’re excited to unveil our latest addition: <a href="https://github.com/torrust/torrents-importer-sample" rel="nofollow">A sample migration tool written in Rust</a>, specifically designed for those looking to seamlessly import torrents from other sources into our <a href="https://github.com/torrust/torrust-index-backend" rel="nofollow">Torrust Index</a>!</p>  <div class="flex svelte-19d8qsr"> <div class=" svelte-13ebny9" style="position: relative;"><div class="svelte-13ebny9"><h2 id="table-of-contents" data-svelte-h="svelte-outevg"><a class="heading-link" title="Permalink" aria-hidden="true" href="#table-of-contents"><span>#</span></a>Table of contents</h2> <ul data-svelte-h="svelte-1aqjmzy"><li><a href="#why-this-tool">Why this tool?</a></li> <li><a href="#capabilities">Capabilities</a></li> <li><a href="#conclusion">Conclusion</a></li> <li><a href="#links">Links</a></li> <li><a href="#acknowledgments">Acknowledgments</a></li></ul></div></div> <div class="svelte-4jsat1"><h2 id="why-this-tool" data-svelte-h="svelte-1hhz7u8"><a class="heading-link" title="Permalink" aria-hidden="true" href="#why-this-tool"><span>#</span></a>Why this tool?</h2> <p data-svelte-h="svelte-m00pe5">Many in our community have asked us for an efficient method to migrate torrents from their current Index/Trackers to Torrust. Recognizing this need, we took it upon ourselves to develop a solution that would make this process as hassle-free as possible.</p> <p data-svelte-h="svelte-1bwpwz">On the other hand, we have been doing an intensive testing of the Torrust Index Backend. We wanted to test the backend with a large set of real torrents. We found the site <a href="https://academictorrents.com/" rel="nofollow">https://academictorrents.com/</a> which has thousands of torrents and they kindly make them public available.</p> <p data-svelte-h="svelte-ewj05f">We decided to create a tool that would allow us to import torrents from this site into our Torrust Index. This tool is a sample project that we are sharing with the community. We hope that it will be useful for those who want to migrate their torrents to Torrust.</p> <p data-svelte-h="svelte-891gdg">The example repo is <a href="https://github.com/torrust/torrents-importer-sample" rel="nofollow">https://github.com/torrust/torrents-importer-sample</a></p> <h2 id="capabilities" data-svelte-h="svelte-y3ky5f"><a class="heading-link" title="Permalink" aria-hidden="true" href="#capabilities"><span>#</span></a>Capabilities</h2> <p data-svelte-h="svelte-11106r8">The migration tool sample offers a straightforward way to:</p> <ul data-svelte-h="svelte-zfhc8b"><li>Fetch Torrents from XML Lists: The tool takes torrents from a list in an XML file, ensuring you don’t have to manually pick and transfer torrents one by one.</li> <li>Download Torrents from Other Sites: No more downloading and re-uploading! Our tool will directly fetch the torrents for you.</li> <li>Upload to Torrust: With the help of the Torrust Index REST API, the torrents are then uploaded into our software, ready for classification and use.</li></ul> <p data-svelte-h="svelte-1dt3i5t">While our initial test run has been on an index containing academic torrents, the tool is versatile enough to handle a variety of sources. The underlying principles remain the same.</p> <div class="callout-block info svelte-sxx0n0"><div class="icon-wrapper svelte-sxx0n0"><svg width="100%" height="100%" stroke-width="1.5" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 11.5V16.5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path d="M12 7.51L12.01 7.49889" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path d="M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path></svg></div> <p data-svelte-h="svelte-k0wwwx"><strong>Disclaimer</strong>: This sample project is not intended to be a production-ready tool. It is a sample project that we are sharing with the community. We hope that it will be useful for those who want to migrate their torrents to Torrust. For larger datasets it would be convenient to handle errors asynchronously. In the current version the application exists immediately when something goes wrong and you have to handle the problem yourself and restart it.</p></div> <p data-svelte-h="svelte-1oc41sa">You will problably need to rewrite the whole “source” part of the application to adapt it to your needs. The “destination” part should be reusable as it is.</p> <p data-svelte-h="svelte-1uuu4wv">When you run the importer, the output will be something like this:</p> <div class="code-block svelte-11qxx87"> <div class="lang svelte-11qxx87">terminal</div> <button class="copy-button copy-button-gray svelte-11qxx87"></button> <div class="code-content"><pre class="language-s"><!-- HTML_TAG_START --><code class="language-s">$ cargo run
    Finished dev [unoptimized + debuginfo] target(s) in 0.02s
     Running &#96;target/debug/torrents-importer-sample&#96;
API login with username admin ...
Logged as admin with account admin
Reading file ./data/database.xml ...
Processing channel ...
  Title: Mandelbrot Set Collection
  description: Torrents with Mandelbrot Set Images
  Link: https://github.com/torrust/torrents-importer-sample
Processing only 1 torrent ...
Processing torrent #1 ...
  Title: MandelBrot Set 01
  Category: Fractal
  Infohash: 0c90fbf036e28370c1ec773401bc7620146b1d48
  Guid: https://raw.githubusercontent.com/torrust/torrents-importer-sample/main/tests/fixtures/torrents/mandelbrot_set_01.torrent
  Link: https://raw.githubusercontent.com/torrust/torrents-importer-sample/main/tests/fixtures/torrents/mandelbrot_set_01.torrent
  Description:  ...
  Size: 17130410419
Checking if the torrent 0c90fbf036e28370c1ec773401bc7620146b1d48 exist in the Torrust Index ...
Downloading the torrent file from the source server ...
Downloading torrent from https://raw.githubusercontent.com/torrust/torrents-importer-sample/main/tests/fixtures/torrents/0c90fbf036e28370c1ec773401bc7620146b1d48.torrent into ./data/torrents/0c90fbf036e28370c1ec773401bc7620146b1d48.torrent
Torrent successfully downloaded.
Uploading the torrent 0c90fbf036e28370c1ec773401bc7620146b1d48 to the Torrust Index ...
response: 200
Torrent uploaded UploadedTorrent &#123;
    torrent_id: 2529,
    info_hash: &quot;0c90fbf036e28370c1ec773401bc7620146b1d48&quot;,
&#125;
Processed torrents: 1
Uploaded torrents:  1</code><!-- HTML_TAG_END --></pre></div></div> <h2 id="conclusion" data-svelte-h="svelte-br5ox0"><a class="heading-link" title="Permalink" aria-hidden="true" href="#conclusion"><span>#</span></a>Conclusion</h2> <p data-svelte-h="svelte-jshx3u">Being a sample project, we believe that there’s always room for improvement. We invite the Torrust community to use the tool, provide feedback, and even contribute to its enhancement. Together, we can refine it and adapt it to cater to more diverse needs.</p> <p data-svelte-h="svelte-nmkdav">We’re committed to evolving and making Torrust a go-to solution for all torrent aficionados. Our new migration tool is just one step in this journey. Whether you’re a casual user or an enterprise looking to migrate a large number of torrents, our tool aims to make the transition smoother for you.</p> <p data-svelte-h="svelte-pw1bp9">A big shout-out to everyone involved in this project! We encourage everyone to give it a try and share your experiences. Together, let’s make the world of torrents even more connected and accessible.</p> <p data-svelte-h="svelte-3l3aev">Happy torrenting!</p> <h2 id="links" data-svelte-h="svelte-32dd6s"><a class="heading-link" title="Permalink" aria-hidden="true" href="#links"><span>#</span></a>Links</h2> <ul data-svelte-h="svelte-1hy0y5t"><li><a href="https://github.com/torrust/torrust-index-backend" rel="nofollow">The Torrust Index Backend</a>.</li> <li><a href="https://github.com/torrust/torrents-importer-sample" rel="nofollow">The Torrust Torrents Importer Sample</a>.</li></ul> <h2 id="acknowledgments" data-svelte-h="svelte-1e4fcph"><a class="heading-link" title="Permalink" aria-hidden="true" href="#acknowledgments"><span>#</span></a>Acknowledgments</h2> <p data-svelte-h="svelte-1mqt1hd">We would like to acknowledge the team from <a href="https://academictorrents.com/" rel="nofollow">https://academictorrents.com/</a> for their great work and for making their torrents public available.</p> <p data-svelte-h="svelte-mcy6nd">If you have any questions or issues regarding this post, please <a href="https://github.com/torrust/torrust-website/issues/new" rel="nofollow">open an issue</a>.</p> <p data-svelte-h="svelte-19k8tej">For any other questions or issues related to Torrust repositories, please open an issue on the corresponding repository:</p> <ul data-svelte-h="svelte-1r8qk6t"><li>Torrust Tracker: <a href="https://github.com/torrust/torrust-tracker/issues" rel="nofollow">https://github.com/torrust/torrust-tracker/issues</a></li> <li>Torrust Index Backend: <a href="https://github.com/torrust/torrust-index-backend/issues" rel="nofollow">https://github.com/torrust/torrust-index-backend/issues</a></li> <li>Torrust Index Frontend: <a href="https://github.com/torrust/torrust-index-frontend/issues" rel="nofollow">https://github.com/torrust/torrust-index-frontend/issues</a></li></ul> <p data-svelte-h="svelte-v20sdj">We very welcome any contributions to the project!</p></div></div>
          ]]></content:encoded>
          <media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://v2.torrust.com//images/posts/pexels-david-dibert-7177008.jpg"/>
          <media:content xmlns:media="http://search.yahoo.com/mrss/" medium="image" url="https://v2.torrust.com//images/posts/pexels-david-dibert-7177008.jpg"/>          
        </item>
      
        <item>
          <guid>https://v2.torrust.com/the-enigmatic-torrent-source-field</guid>
          <title>The Enigmatic Torrent "Source" Field</title>
          <description>Delving into BitTorrent’s Mysteries. What is the "source" field in the torrent info used for?</description>
          <link>https://v2.torrust.com/the-enigmatic-torrent-source-field</link>
          <pubDate>08/08/2023 13:56:28</pubDate>
          <category>BitTorrent</category><category>Protocol</category>
          <content:encoded><![CDATA[
            <div style="margin: 50px 0; font-style: italic;">
              If anything looks wrong, 
              <strong>
                <a href="https://v2.torrust.com/the-enigmatic-torrent-source-field">
                  read on the site!
                </a>
              </strong>
            </div>

            <p data-svelte-h="svelte-1xkmzaz">The BitTorrent protocol, despite its widespread usage, has often been met with raised eyebrows by the tech community due to its sometimes vague or entirely missing documentation. Today, we’ll dive into one such mystery: the “source” field located within the “info” part of torrent files.</p>  <div class="flex svelte-19d8qsr"> <div class=" svelte-13ebny9" style="position: relative;"><div class="svelte-13ebny9"><h2 id="table-of-contents" data-svelte-h="svelte-outevg"><a class="heading-link" title="Permalink" aria-hidden="true" href="#table-of-contents"><span>#</span></a>Table of contents</h2> <ul data-svelte-h="svelte-1lmmgud"><li><a href="#unraveling-the-source-field">Unraveling the “Source” Field</a></li> <li><a href="#source-field-internals">“Source” field internals</a></li> <li><a href="#bittorrent-documentation-lost-in-the-ether">BitTorrent Documentation: Lost in the Ether?</a></li> <li><a href="#cross-seeding">Cross-seeding</a></li> <li><a href="#what-are-the-reliable-sources-for-bittorrent-documentation">What are the reliable sources for BitTorrent documentation?</a></li> <li><a href="#links">Links</a></li> <li><a href="#acknowledgments">Acknowledgments</a></li> <li><a href="#conclusion">Conclusion</a></li></ul></div></div> <div class="svelte-4jsat1"><div class="callout-block info svelte-sxx0n0"><div class="icon-wrapper svelte-sxx0n0"><svg width="100%" height="100%" stroke-width="1.5" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 11.5V16.5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path d="M12 7.51L12.01 7.49889" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path d="M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path></svg></div> <p data-svelte-h="svelte-flvomu"><strong>Disclaimer</strong>: The contents of this blog post, are based on research, community discussions, and available knowledge as of the date of publication. Due to the absence of official documentation for the “source” field, there might be discrepancies or potential inaccuracies in the information presented. Readers are advised to exercise caution and conduct their own research when relying on this information, especially for critical applications or decisions. If you identify any inaccuracies or have further insights, please open an issue or contact us directly so we can review and update as necessary.</p></div> <h2 id="unraveling-the-source-field" data-svelte-h="svelte-5bos9n"><a class="heading-link" title="Permalink" aria-hidden="true" href="#unraveling-the-source-field"><span>#</span></a>Unraveling the “Source” Field</h2> <p data-svelte-h="svelte-1gcmezn">Some days ago we were testing the <a href="https://github.com/torrust/torrust-index-backend" rel="nofollow">Torrust Index Backend</a>. We were using different torrent files. We realized that we were calculating a wrong info-hash when the torrent contained a “source” field.</p> <p data-svelte-h="svelte-11qisc0">You can see the details of that issue <a href="https://github.com/torrust/torrust-index-backend/issues/242" rel="nofollow">here</a>.</p> <p data-svelte-h="svelte-148fe25">For the uninitiated, the BitTorrent protocol uses <code>.torrent</code> files to contain metadata about the files we wish to share and distribute. Inside this .torrent file is an “info” dictionary that holds details about these files, such as their names, lengths, and piece hashes.</p> <p data-svelte-h="svelte-f1o16d">You can create a torrent file in many different ways. Probably the most common way to create them is by using a BitTorrent client.</p> <p data-svelte-h="svelte-1rzyt5j">For example, if you are using <a href="https://www.qbittorrent.org/" rel="nofollow">qBittorrent</a>, this is the torrent creation form:</p> <img srcset="/images/posts/create-a-torrent-file-with-qbittorrent-and-source-field.png, /images/posts/create-a-torrent-file-with-qbittorrent-and-source-field.png, /images/posts/create-a-torrent-file-with-qbittorrent-and-source-field.png" src="/images/posts/create-a-torrent-file-with-qbittorrent-and-source-field.png" alt="Create" loading="lazy" decoding="async" class="svelte-1ykl0dj"> <p data-svelte-h="svelte-w5jo26">As you can see there is a “source” field in the “Fields” group of inputs.</p> <p data-svelte-h="svelte-ejb8cw">As we did not know exactly the purpose of this field, our first reaction was to look for official documentation about that field in <a href="https://www.bittorrent.org/beps/bep_0000.html" rel="nofollow">BEPs</a>. In the context of BitTorrent, a BEP stands for “BitTorrent Enhancement Proposal.” It’s analogous to Python’s PEP (Python Enhancement Proposal) or Bitcoin’s BIP (Bitcoin Improvement Proposal).</p> <div class="callout-block info svelte-sxx0n0"><div class="icon-wrapper svelte-sxx0n0"><svg width="100%" height="100%" stroke-width="1.5" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 11.5V16.5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path d="M12 7.51L12.01 7.49889" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path d="M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path></svg></div> <p data-svelte-h="svelte-1mwjj64">A BitTorrent Enhancement Proposal (BEP) is a design document providing information to the BitTorrent community, or describing a new feature for BitTorrent or its processes or environment. The BEP should provide a concise technical specification of the feature and a rationale for the feature. It’s a mechanism by which innovations, improvements, and features are proposed, discussed, and integrated into the BitTorrent protocol and its ecosystem.</p></div> <p data-svelte-h="svelte-1wi746">While many fields are well-documented and are integral to the functioning of the protocol, the “source” field remains a relatively understudied element. Here’s what we know:</p> <p data-svelte-h="svelte-ofjc87"><strong>Purpose</strong>: The “source” field isn’t necessarily needed for the basic functioning of BitTorrent. It often appears to be used as a marker or tag to indicate where the torrent was created or originated. This is particularly handy for private torrent sites or groups that wish to ‘mark’ a torrent file to trace its distribution.</p> <p data-svelte-h="svelte-d2srrf"><strong>Format</strong>: Typically, this field contains a string, which may be the name of the website or organization that created or released the torrent. Some tracker use a three-char code representing the tracker.</p> <p data-svelte-h="svelte-1szdqr3"><strong>Implications</strong>: While it may seem benign, the “source” field can have ramifications. Torrents marked with a particular source might be treated differently, either more trustingly or with suspicion, depending on the reputation of the source. Furthermore, for private trackers, a torrent with an unauthorized or modified “source” field might lead to banning of users, as it could indicate redistribution of exclusive content.</p> <h2 id="source-field-internals" data-svelte-h="svelte-1h6sndf"><a class="heading-link" title="Permalink" aria-hidden="true" href="#source-field-internals"><span>#</span></a>“Source” field internals</h2> <p data-svelte-h="svelte-1q8e4vj">Metainfo files (also known as .torrent files) are bencoded dictionaries. The contents of a BitTorrent file are described in the <a href="https://www.bittorrent.org/beps/bep_0003.html" rel="nofollow">BEP 03</a>.</p> <div class="callout-block info svelte-sxx0n0"><div class="icon-wrapper svelte-sxx0n0"><svg width="100%" height="100%" stroke-width="1.5" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 11.5V16.5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path d="M12 7.51L12.01 7.49889" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path d="M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path></svg></div> <p data-svelte-h="svelte-1mj93g">Bencoding (pronounced “Bee-encoding”) is a data serialization method used primarily in the BitTorrent protocol. It’s designed to be simple and efficient to encode and decode. Bencoded data structures include bytes (strings), integers, lists, and dictionaries.</p></div> <p data-svelte-h="svelte-ity4tg">The JSON representation of a torrent file, after decoding the bytes is something like this:</p> <div class="code-block svelte-11qxx87"> <div class="lang svelte-11qxx87">json</div> <button class="copy-button copy-button-gray svelte-11qxx87"></button> <div class="code-content"><pre class="language-json"><!-- HTML_TAG_START --><code class="language-json"><span class="token punctuation">&#123;</span>
	<span class="token property">"announce"</span><span class="token operator">:</span> <span class="token string">"http://localhost"</span><span class="token punctuation">,</span>
	<span class="token property">"comment"</span><span class="token operator">:</span> <span class="token string">"Comments"</span><span class="token punctuation">,</span>
	<span class="token property">"created by"</span><span class="token operator">:</span> <span class="token string">"qBittorrent v4.4.1"</span><span class="token punctuation">,</span>
	<span class="token property">"creation date"</span><span class="token operator">:</span> <span class="token number">1690882922</span><span class="token punctuation">,</span>
	<span class="token property">"info"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
		<span class="token property">"length"</span><span class="token operator">:</span> <span class="token number">172204</span><span class="token punctuation">,</span>
		<span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"mandelbrot_2048x2048.png"</span><span class="token punctuation">,</span>
		<span class="token property">"piece length"</span><span class="token operator">:</span> <span class="token number">16384</span><span class="token punctuation">,</span>
		<span class="token property">"pieces"</span><span class="token operator">:</span> <span class="token string">"&lt;hex>7D 91 71 0D 9D 4D BA 88 9B 54 20 54 D5 26 72 8D 5A 86 3F E1 21 DF 77 C7 F7 BB 6C 77 96 21 66 25 38 C5 D9 CD AB 8B 08 EF 8C 24 9B B2 F5 C4 CD 2A DF 0B C0 0C F0 AD DF 72 90 E5 B6 41 4C 23 6C 47 9B 8E 9F 46 AA 0C 0D 8E D1 97 FF EE 68 8B 5F 34 A3 87 D7 71 C5 A6 F9 8E 2E A6 31 7C BD F0 F9 E2 23 F9 CC 80 AF 54 00 04 F9 85 69 1C 77 89 C1 76 4E D6 AA BF 61 A6 C2 80 99 AB B6 5F 60 2F 40 A8 25 BE 32 A3 3D 9D 07 0C 79 68 98 D4 9D 63 49 AF 20 58 66 26 6F 98 6B 6D 32 34 CD 7D 08 15 5E 1A D0 00 09 57 AB 30 3B 20 60 C1 DC 12 87 D6 F3 E7 45 4F 70 67 09 36 31 55 F2 20 F6 6C A5 15 6F 2C 89 95 69 16 53 81 7D 31 F1 B6 BD 37 42 CC 11 0B B2 FC 2B 49 A5 85 B6 FC 76 74 44 93&lt;/hex>"</span><span class="token punctuation">,</span>
		<span class="token property">"private"</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
		<span class="token property">"source"</span><span class="token operator">:</span> <span class="token string">"Source"</span>
	<span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
	<span class="token property">"url-list"</span><span class="token operator">:</span> <span class="token string">"http://localhost/mandelbrot_2048x2048.png"</span>
<span class="token punctuation">&#125;</span></code><!-- HTML_TAG_END --></pre></div></div> <p data-svelte-h="svelte-dopwc8">As you can see there is one key or field called <code>info</code>. This part of the file is used to generate the info-hash, which is the torrent unique identifier.</p> <div class="callout-block info svelte-sxx0n0"><div class="icon-wrapper svelte-sxx0n0"><svg width="100%" height="100%" stroke-width="1.5" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 11.5V16.5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path d="M12 7.51L12.01 7.49889" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path d="M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path></svg></div> <p data-svelte-h="svelte-9w2cju">According to BEP-03, the info-hash is a 20 byte sha1 hash of the bencoded form of the info value from the metainfo file. BEP 03 does not specifically mention the <code>source</code> field. All current or future fields included in the <code>info</code> dictionary are used to calculate the info-hash.</p></div> <p data-svelte-h="svelte-p76jem"><a href="https://www.bittorrent.org/beps/bep_0003.html" rel="nofollow">BEP-03</a> does not mention the <code>source</code> and <code>private</code> fields.</p> <p data-svelte-h="svelte-3yu2dk">There are two different types of torrent files:</p> <ul data-svelte-h="svelte-17ai75x"><li>The single file case: where the torrent contains a single file.</li> <li>The multi-file case: where the torrent contains a directory.</li></ul> <p data-svelte-h="svelte-1qa7yy4">Here is another example of a torrent containing multiple files:</p> <div class="code-block svelte-11qxx87"> <div class="lang svelte-11qxx87">json</div> <button class="copy-button copy-button-gray svelte-11qxx87"></button> <div class="code-content"><pre class="language-json"><!-- HTML_TAG_START --><code class="language-json"><span class="token punctuation">&#123;</span>
	<span class="token property">"announce"</span><span class="token operator">:</span> <span class="token string">"http://localhost"</span><span class="token punctuation">,</span>
	<span class="token property">"comment"</span><span class="token operator">:</span> <span class="token string">"Comments"</span><span class="token punctuation">,</span>
	<span class="token property">"created by"</span><span class="token operator">:</span> <span class="token string">"qBittorrent v4.4.1"</span><span class="token punctuation">,</span>
	<span class="token property">"creation date"</span><span class="token operator">:</span> <span class="token number">1691069437</span><span class="token punctuation">,</span>
	<span class="token property">"info"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
		<span class="token property">"files"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
			<span class="token punctuation">&#123;</span>
				<span class="token property">"length"</span><span class="token operator">:</span> <span class="token number">37</span><span class="token punctuation">,</span>
				<span class="token property">"path"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"file-425ef9ca-014d-403f-8f15-3ece9e3fad38.txt"</span><span class="token punctuation">]</span>
			<span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
			<span class="token punctuation">&#123;</span>
				<span class="token property">"length"</span><span class="token operator">:</span> <span class="token number">37</span><span class="token punctuation">,</span>
				<span class="token property">"path"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"file-deeafa50-2e25-4f38-bec0-92865ca6bb1d.txt"</span><span class="token punctuation">]</span>
			<span class="token punctuation">&#125;</span>
		<span class="token punctuation">]</span><span class="token punctuation">,</span>
		<span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"dir-839a49f0-cabc-4efb-ad5f-b6fb15f8a467"</span><span class="token punctuation">,</span>
		<span class="token property">"piece length"</span><span class="token operator">:</span> <span class="token number">16384</span><span class="token punctuation">,</span>
		<span class="token property">"pieces"</span><span class="token operator">:</span> <span class="token string">"&lt;hex>8E 47 18 74 52 8E 68 92 DD 86 66 F0 0B DD AD B1 08 DC 69 44&lt;/hex>"</span><span class="token punctuation">,</span>
		<span class="token property">"private"</span><span class="token operator">:</span> <span class="token number">1</span>
	<span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
	<span class="token property">"url-list"</span><span class="token operator">:</span> <span class="token string">"http://localhost/mandelbrot_2048x2048.png"</span>
<span class="token punctuation">&#125;</span></code><!-- HTML_TAG_END --></pre></div></div> <div class="callout-block info svelte-sxx0n0"><div class="icon-wrapper svelte-sxx0n0"><svg width="100%" height="100%" stroke-width="1.5" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 11.5V16.5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path d="M12 7.51L12.01 7.49889" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path d="M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path></svg></div> <p data-svelte-h="svelte-17y5040">The <code>info</code> dictionary can contain a key <code>length</code> or a key <code>files</code>, but not both or neither. If length is present then the download represents a single file, otherwise it represents a set of files which go in a directory structure. In the single file case, length maps to the length of the file in bytes.</p></div> <h2 id="bittorrent-documentation-lost-in-the-ether" data-svelte-h="svelte-1im9jzh"><a class="heading-link" title="Permalink" aria-hidden="true" href="#bittorrent-documentation-lost-in-the-ether"><span>#</span></a>BitTorrent Documentation: Lost in the Ether?</h2> <p data-svelte-h="svelte-1a3194b">This isn’t the first time we’ve encountered a hazy area within BitTorrent’s realm. While the protocol itself is revolutionary, providing a decentralized way to share large amounts of data efficiently, its documentation often leaves much to be desired. Here’s why this is a concern:</p> <p data-svelte-h="svelte-i9dw0t"><strong>Reduced Accessibility</strong>: For new developers or enthusiasts looking to delve into the BitTorrent ecosystem, inadequate documentation can be a significant barrier to entry.</p> <p data-svelte-h="svelte-smsuei"><strong>Inconsistent Implementations</strong>: Vague documentation can lead to varied interpretations and consequently, inconsistent implementations across different BitTorrent clients.</p> <p data-svelte-h="svelte-149xa8u"><strong>Potential for Misuse</strong>: Ambiguous or missing documentation can lead to unintended use or misuse of fields, potentially compromising the integrity of the protocol or the data being shared.</p> <h2 id="cross-seeding" data-svelte-h="svelte-88kq5l"><a class="heading-link" title="Permalink" aria-hidden="true" href="#cross-seeding"><span>#</span></a>Cross-seeding</h2> <p data-svelte-h="svelte-1cr26ms">It’s out of the scope of this post to provide an exhaustive explanation of the cross-seeding concept. If you think it could be an interesting topic for a new blog post let us know. But the “source” field in the “info” part of the torrent files might be related to cross-seeding too.</p> <p data-svelte-h="svelte-1n5ic83"><strong>Cross-seeding</strong> in the BitTorrent context refers to the practice of seeding the same content (files) using two or more different torrent files, typically from different trackers. This is particularly useful when the exact same file or set of files is available on multiple trackers but might have different torrent files associated with them due to differences in metadata, source tags, or directory structures.</p> <p data-svelte-h="svelte-wz3zfh">BitTorrent clients usually do not allow you to add the same content twice, so cross-seeding is a way to get around this limitation. If you want to add a new tracker to a torrent file that you are already seeding, the client usually adds the new tracker to the tracker list in the previous torrent file. This could be a reason to ban you from some private trackers.</p> <p data-svelte-h="svelte-1bjb1zy">Some private trackers change the list of trackers in the torrent files to prevent cross-seeding. They remove other trackers URLs and they also use the source file to generate a different info-hash. This is a way to force you to download the torrent file from their website and track you to know if you are seeding the torrent file from another tracker.</p> <h2 id="what-are-the-reliable-sources-for-bittorrent-documentation" data-svelte-h="svelte-e76lop"><a class="heading-link" title="Permalink" aria-hidden="true" href="#what-are-the-reliable-sources-for-bittorrent-documentation"><span>#</span></a>What are the reliable sources for BitTorrent documentation?</h2> <p data-svelte-h="svelte-yjqey5">Some of the sources we have found reliable and useful are:</p> <ul data-svelte-h="svelte-1g9m6ah"><li><a href="https://www.bittorrent.org/beps/bep_0000.html" rel="nofollow">https://www.bittorrent.org/beps/bep_0000.html</a>: BitTorrent Enhancement Proposals (BEPs) describe proposed changes to the BitTorrent protocol, including new features and extensions to existing features.</li> <li><a href="http://libtorrent.org/" rel="nofollow">http://libtorrent.org/</a>: libtorrent is a feature complete C++ bittorrent library.</li> <li><a href="https://wiki.theory.org/BitTorrentSpecification" rel="nofollow">https://wiki.theory.org/BitTorrentSpecification</a>: This wiki is a comprehensive reference for the BitTorrent protocol.</li></ul> <p data-svelte-h="svelte-5anh79">If you think we are missing any other reliable source, please let us know by <a href="https://github.com/torrust/torrust-website/issues" rel="nofollow">opening an issue</a> or opening a pull request to update this post.</p> <h2 id="links" data-svelte-h="svelte-32dd6s"><a class="heading-link" title="Permalink" aria-hidden="true" href="#links"><span>#</span></a>Links</h2> <ul data-svelte-h="svelte-nemxtw"><li><a href="https://github.com/torrust/torrust-index-backend/issues/242" rel="nofollow">The issue that originated this post</a>.</li> <li><a href="https://github.com/qbittorrent/qBittorrent/discussions/19406" rel="nofollow">Open questions on GitHub qBittorrent project</a>.</li> <li><a href="https://en.wikipedia.org/wiki/Bencode" rel="nofollow">Wikipedia: Bencode</a>.</li> <li><a href="https://stackoverflow.com/questions/28348678/what-exactly-is-the-info-hash-in-a-torrent-file" rel="nofollow">Stackoverflow: What exactly is the info_Hash in a torrent file</a>.</li></ul> <h2 id="acknowledgments" data-svelte-h="svelte-1e4fcph"><a class="heading-link" title="Permalink" aria-hidden="true" href="#acknowledgments"><span>#</span></a>Acknowledgments</h2> <p data-svelte-h="svelte-doxuny">For this port and in other places we are using an online tool to generate JSON objects from torrent files: <a href="https://chocobo1.github.io/bencode_online/" rel="nofollow">https://chocobo1.github.io/bencode_online/</a> by <a href="https://github.com/Chocobo1" rel="nofollow">Mike Tzou</a>.</p> <p data-svelte-h="svelte-eiofbf"><a href="https://github.com/Kimbatt" rel="nofollow">Kimbatt</a> <a href="https://github.com/Kimbatt/torrent-creator/issues/10#issuecomment-1664344502" rel="nofollow">helped us to find some sources of information</a>.</p> <h2 id="conclusion" data-svelte-h="svelte-br5ox0"><a class="heading-link" title="Permalink" aria-hidden="true" href="#conclusion"><span>#</span></a>Conclusion</h2> <p data-svelte-h="svelte-1ekwqiv">While the BitTorrent protocol remains a cornerstone of peer-to-peer data sharing, there’s a palpable need for comprehensive, clear, and easily accessible documentation. The “source” field in the “info” part of the torrent files serves as a poignant reminder of this necessity. As we continue to rely on such protocols for our digital interactions, understanding their nuances becomes not just an intellectual exercise but a practical imperative.</p> <div class="callout-block info svelte-sxx0n0"><div class="icon-wrapper svelte-sxx0n0"><svg width="100%" height="100%" stroke-width="1.5" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 11.5V16.5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path d="M12 7.51L12.01 7.49889" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path d="M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path></svg></div> <p data-svelte-h="svelte-la46nn">We are looking forward to finding the first implementation and the creator of the “Source” field in the “info” part of the torrent files. If you know of any, please let us know by opening an issue.</p></div> <p data-svelte-h="svelte-mcy6nd">If you have any questions or issues regarding this post, please <a href="https://github.com/torrust/torrust-website/issues/new" rel="nofollow">open an issue</a>.</p> <p data-svelte-h="svelte-19k8tej">For any other questions or issues related to Torrust repositories, please open an issue on the corresponding repository:</p> <ul data-svelte-h="svelte-1r8qk6t"><li>Torrust Tracker: <a href="https://github.com/torrust/torrust-tracker/issues" rel="nofollow">https://github.com/torrust/torrust-tracker/issues</a></li> <li>Torrust Index Backend: <a href="https://github.com/torrust/torrust-index-backend/issues" rel="nofollow">https://github.com/torrust/torrust-index-backend/issues</a></li> <li>Torrust Index Frontend: <a href="https://github.com/torrust/torrust-index-frontend/issues" rel="nofollow">https://github.com/torrust/torrust-index-frontend/issues</a></li></ul> <p data-svelte-h="svelte-v20sdj">We very welcome any contributions to the project!</p></div></div>
          ]]></content:encoded>
          <media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://v2.torrust.com//images/posts/deprecated-and-outdated-bittorrent-documentation.png"/>
          <media:content xmlns:media="http://search.yahoo.com/mrss/" medium="image" url="https://v2.torrust.com//images/posts/deprecated-and-outdated-bittorrent-documentation.png"/>          
        </item>
      
        <item>
          <guid>https://v2.torrust.com/how-to-run-a-local-demo</guid>
          <title>How To Run A Local Demo</title>
          <description>You can easily run the Torrust Index demo on your computer easily with Git and Docker.</description>
          <link>https://v2.torrust.com/how-to-run-a-local-demo</link>
          <pubDate>11/07/2023 15:28:28</pubDate>
          <category>Demo</category><category>Tutorial</category><category>Guide</category>
          <content:encoded><![CDATA[
            <div style="margin: 50px 0; font-style: italic;">
              If anything looks wrong, 
              <strong>
                <a href="https://v2.torrust.com/how-to-run-a-local-demo">
                  read on the site!
                </a>
              </strong>
            </div>

             <div class="flex svelte-19d8qsr"> <div class=" svelte-13ebny9" style="position: relative;"><div class="svelte-13ebny9"><h2 id="table-of-contents" data-svelte-h="svelte-1m3njcc"><a class="heading-link" title="Permalink" aria-hidden="true" href="#table-of-contents"><span>#</span></a>Table of Contents</h2> <ul data-svelte-h="svelte-3eplih"><li><a href="#requirements">Requirements</a></li> <li><a href="#running-the-demo">Running the demo</a></li> <li><a href="#application-setup">Application Setup</a></li> <li><a href="#advanced-setup">Advanced Setup</a></li> <li><a href="#conclusion">Conclusion</a></li></ul></div></div> <div class="svelte-4jsat1"><p data-svelte-h="svelte-bew7i4">If you want to try the Torrust Index <strong>demo</strong> on your computer, you can easily run it with Git and Docker. This guide will explain how to setup the demo on your own computer in <strong>a few seconds</strong>.</p> <h2 id="requirements" data-svelte-h="svelte-d9t7ph"><a class="heading-link" title="Permalink" aria-hidden="true" href="#requirements"><span>#</span></a>Requirements</h2> <p data-svelte-h="svelte-rad3cl">You are going to need the following tools:</p> <ul data-svelte-h="svelte-1iphsw0"><li>Git</li> <li>Docker</li></ul> <p data-svelte-h="svelte-zalwqu">At the time of writing, we are using Git version <code>2.39.2</code> and Docker version <code>26.1.3</code>, but it should work with any recent version.</p> <p data-svelte-h="svelte-1u2axvt">By default, the demo uses SQLite3 as database driver, but you can also use MySQL. If you want to use SQLite3, you do not need to install anything else. If you want to take a look at the internal database structure or data, you can install <a href="https://sqlitebrowser.org/" rel="nofollow">DB Browser for SQLite</a>.</p> <div class="callout-block info svelte-sxx0n0"><div class="icon-wrapper svelte-sxx0n0"><svg width="100%" height="100%" stroke-width="1.5" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 11.5V16.5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path d="M12 7.51L12.01 7.49889" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path d="M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path></svg></div> Although we use some small bash scripts, you can run the demo on different operating systems by executing the docker-compose command manually. We have tested it on Linux.</div> <h2 id="running-the-demo" data-svelte-h="svelte-103hfc0"><a class="heading-link" title="Permalink" aria-hidden="true" href="#running-the-demo"><span>#</span></a>Running the demo</h2> <p data-svelte-h="svelte-1ung1ed">We are going to use a temporary directory to run the demo. You can install the demo with the following commands:</p> <div class="code-block svelte-11qxx87"> <div class="lang svelte-11qxx87">terminal</div> <button class="copy-button copy-button-gray svelte-11qxx87"></button> <div class="code-content"><pre class="language-s"><!-- HTML_TAG_START --><code class="language-s">mkdir -p /tmp/torrust \
  &amp;&amp; cd /tmp/torrust \
  &amp;&amp; git clone git@github.com:torrust/torrust-compose.git \
  &amp;&amp; cd torrust-compose/demo \
  &amp;&amp; ./bin/install.sh</code><!-- HTML_TAG_END --></pre></div></div> <p data-svelte-h="svelte-1yy75v2">To start the application:</p> <div class="code-block svelte-11qxx87"> <div class="lang svelte-11qxx87">terminal</div> <button class="copy-button copy-button-gray svelte-11qxx87"></button> <div class="code-content"><pre class="language-s"><!-- HTML_TAG_START --><code class="language-s">./bin/start.sh</code><!-- HTML_TAG_END --></pre></div></div> <p data-svelte-h="svelte-v2dpew">To stop the application:</p> <div class="code-block svelte-11qxx87"> <div class="lang svelte-11qxx87">terminal</div> <button class="copy-button copy-button-gray svelte-11qxx87"></button> <div class="code-content"><pre class="language-s"><!-- HTML_TAG_START --><code class="language-s">./bin/stop.sh</code><!-- HTML_TAG_END --></pre></div></div> <p data-svelte-h="svelte-a20ena">After starting the demo you can check that all container are running with the following command:</p> <div class="code-block svelte-11qxx87"> <div class="lang svelte-11qxx87">output</div> <button class="copy-button copy-button-gray svelte-11qxx87"></button> <div class="code-content"><pre class="language-s"><!-- HTML_TAG_START --><code class="language-s">$ docker ps
CONTAINER ID   IMAGE                       COMMAND                  CREATED         STATUS                            PORTS                                                                                                      NAMES
e380a435eede   torrust/index-gui:develop   &quot;/usr/local/bin/entrypoint.sh&quot;   4 seconds ago   Up 3 seconds (health: starting)   0.0.0.0:3000-&gt;3000/tcp, :::3000-&gt;3000/tcp, 0.0.0.0:24678-&gt;24678/tcp, :::24678-&gt;24678/tcp                   torrust-index-gui-1
db8f7c679b66   torrust/index:develop       &quot;/usr/local/bin/entrypoint.sh&quot;   5 seconds ago   Up 3 seconds (health: starting)   0.0.0.0:3001-&gt;3001/tcp, :::3001-&gt;3001/tcp                                                                  torrust-index-1
820720c37d80   torrust/tracker:develop     &quot;/usr/local/bin/entrypoint.sh&quot;   5 seconds ago   Up 4 seconds (health: starting)   1313/tcp, 0.0.0.0:1212-&gt;1212/tcp, :::1212-&gt;1212/tcp, 7070/tcp, 0.0.0.0:6969-&gt;6969/udp, :::6969-&gt;6969/udp   torrust-tracker-1
a9668e78f3cc   mysql:8.0                   &quot;docker-entrypoint.s…&quot;   5 seconds ago   Up 4 seconds (health: starting)   0.0.0.0:3306-&gt;3306/tcp, :::3306-&gt;3306/tcp, 33060/tcp                                                       torrust-mysql-1
c10ad938b283   dockage/mailcatcher:0.8.2   &quot;entrypoint mailcatcher&quot;   5 seconds ago   Up 4 seconds                      0.0.0.0:1025-&gt;1025/tcp, :::1025-&gt;1025/tcp, 0.0.0.0:1080-&gt;1080/tcp, :::1080-&gt;1080/tcp                       torrust-mailcatcher-1
</code><!-- HTML_TAG_END --></pre></div></div> <div class="callout-block info svelte-sxx0n0"><div class="icon-wrapper svelte-sxx0n0"><svg width="100%" height="100%" stroke-width="1.5" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 11.5V16.5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path d="M12 7.51L12.01 7.49889" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path d="M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path></svg></div> IMPORTANT! We use the latest commit from the develop branches of the Torrust repositories. If you want to use the latest stable version, you can change the tag for the docker images in the `docker-compose.yml` file.</div> <p data-svelte-h="svelte-qp6dwn">Once the demo is running, you go to <a href="http://localhost:3000/" rel="nofollow">http://localhost:3000/</a> to start using it.</p> <h2 id="application-setup" data-svelte-h="svelte-1wcjsvs"><a class="heading-link" title="Permalink" aria-hidden="true" href="#application-setup"><span>#</span></a>Application Setup</h2> <p data-svelte-h="svelte-161iicw">The application has some public pages like the torrent list or torrent details pages. But other pages require authentication. To access those pages you need to create an account. You can do it from the signup page:</p> <p data-svelte-h="svelte-cpmctb"><a href="http://localhost:3000/signup" rel="nofollow">http://localhost:3000/signup</a></p> <div class="callout-block info svelte-sxx0n0"><div class="icon-wrapper svelte-sxx0n0"><svg width="100%" height="100%" stroke-width="1.5" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 11.5V16.5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path d="M12 7.51L12.01 7.49889" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path d="M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path></svg></div> The first user registered will be the <code data-svelte-h="svelte-ik7s6n">admin</code> user. The application only has one admin user.</div> <p data-svelte-h="svelte-1hm9zmc">The application is very easy to use but you can find comprehensive documentation in the following links:</p> <ul data-svelte-h="svelte-46v7wy"><li><a href="https://torrust.github.io/torrust-index-gui-user-guide/" rel="nofollow">Torrust Index GUI User’s Guide</a></li> <li><a href="https://github.com/torrust/torrust-index-gui/blob/develop/docs/index.md" rel="nofollow">Torrust Index GUI</a></li> <li><a href="https://docs.rs/torrust-index%3E" rel="nofollow">Torrust Index</a></li> <li><a href="https://docs.rs/torrust-tracker" rel="nofollow">Torrust Tracker</a></li></ul> <h2 id="advanced-setup" data-svelte-h="svelte-1efp6lo"><a class="heading-link" title="Permalink" aria-hidden="true" href="#advanced-setup"><span>#</span></a>Advanced Setup</h2> <p data-svelte-h="svelte-1y02r6p">You can modify the configuration of the demo to use different ports, database drivers, etcetera. But we are going to use the default configuration in this guide.</p> <p data-svelte-h="svelte-lvns2y">If you want to change the configuration for the Tracker or the Index Backend, you can do it by modifying the <code>config-tracker.local.toml</code> or <code>config-index.local.toml</code> files and stopping (<code>./bin/stop.sh</code>) and starting (<code>./bin/start.sh</code>) the docker containers again.</p> <p data-svelte-h="svelte-kj0r6a">Refer to the documentation of the corresponding application to know more about the configuration options:</p> <ul data-svelte-h="svelte-1m2k50q"><li><a href="https://github.com/torrust/torrust-tracker" rel="nofollow">Torrust Tracker</a></li> <li><a href="https://github.com/torrust/torrust-index" rel="nofollow">Torrust Index</a></li> <li><a href="https://github.com/torrust/torrust-index-gui" rel="nofollow">Torrust Index GUI</a></li></ul> <h2 id="conclusion" data-svelte-h="svelte-br5ox0"><a class="heading-link" title="Permalink" aria-hidden="true" href="#conclusion"><span>#</span></a>Conclusion</h2> <p data-svelte-h="svelte-1gntbj7">That’s it. Enjoy the demo! We will publish a new blog post soon explaining how to use the demo for basics tasks like uploading a torrent, adding categories or tags, etcetera.</p> <p data-svelte-h="svelte-1e9qm2v">If you have any questions or issues please open an issue on the corresponding repository:</p> <ul data-svelte-h="svelte-fxskft"><li><a href="https://github.com/torrust/torrust-tracker/issues" rel="nofollow">Torrust Tracker</a></li> <li><a href="https://github.com/torrust/torrust-index/issues" rel="nofollow">Torrust Index</a></li> <li><a href="https://github.com/torrust/torrust-index-gui/issues" rel="nofollow">Torrust Index GUI</a></li></ul> <p data-svelte-h="svelte-v20sdj">We very welcome any contributions to the project!</p></div></div>
          ]]></content:encoded>
          <media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://v2.torrust.com//images/posts/mandelbrot-set-periods-torrent-screenshot.png"/>
          <media:content xmlns:media="http://search.yahoo.com/mrss/" medium="image" url="https://v2.torrust.com//images/posts/mandelbrot-set-periods-torrent-screenshot.png"/>          
        </item>
      
        <item>
          <guid>https://v2.torrust.com/how-to-setup-the-development-environment</guid>
          <title>How To Setup The Dev Env</title>
          <description>If you want to contribute to the Torrust Index, this article explains how to setup a development environment with the latest versions for all services.</description>
          <link>https://v2.torrust.com/how-to-setup-the-development-environment</link>
          <pubDate>11/07/2023 12:29:04</pubDate>
          <category>Documentation</category><category>Tutorial</category><category>Guide</category><category>Development</category><category>Setup</category>
          <content:encoded><![CDATA[
            <div style="margin: 50px 0; font-style: italic;">
              If anything looks wrong, 
              <strong>
                <a href="https://v2.torrust.com/how-to-setup-the-development-environment">
                  read on the site!
                </a>
              </strong>
            </div>

             <div class="flex svelte-19d8qsr"> <div class=" svelte-13ebny9" style="position: relative;"><div class="svelte-13ebny9"><h2 id="table-of-contents" data-svelte-h="svelte-1m3njcc"><a class="heading-link" title="Permalink" aria-hidden="true" href="#table-of-contents"><span>#</span></a>Table of Contents</h2> <ul data-svelte-h="svelte-997itw"><li><a href="#introduction">Introduction</a></li> <li><a href="#common-dependencies">Common Dependencies</a></li> <li><a href="#set-up-the-torrust-tracker">Set Up the Torrust Tracker</a></li> <li><a href="#set-up-the-torrust-index">Set Up the Torrust Index</a></li> <li><a href="#set-up-the-torrust-index-gui">Set Up the Torrust Index GUI</a></li> <li><a href="#application-setup">Application Setup</a></li> <li><a href="#development-tools">Development tools</a></li> <li><a href="#conclusion">Conclusion</a></li></ul></div></div> <div class="svelte-4jsat1"><h2 id="introduction" data-svelte-h="svelte-1ahwhrx"><a class="heading-link" title="Permalink" aria-hidden="true" href="#introduction"><span>#</span></a>Introduction</h2> <p data-svelte-h="svelte-1xhj6nt">Before explaining how to setup the development environment, it’s important to understand how the Torrust Index works. The Torrust Index is composed of multiple services, each one with its own codebase and repository. The services are:</p> <ul data-svelte-h="svelte-1iedagn"><li>A <a href="https://github.com/torrust/torrust-tracker" rel="nofollow">BitTorrent Tracker</a>, which is responsible for tracking the torrents and providing the peers to the clients.</li> <li>The <a href="https://github.com/torrust/torrust-index" rel="nofollow">Index</a>, which is a REST API that provides the data to the frontend.</li> <li>And the <a href="https://github.com/torrust/torrust-index-gui" rel="nofollow">Index GUI</a>, which is a webapp that displays the data to the user.</li></ul> <img srcset="/images/posts/torrust-architecture.png, /images/posts/torrust-architecture.png, /images/posts/torrust-architecture.png" src="/images/posts/torrust-architecture.png" alt="Torrust Architecture" loading="lazy" decoding="async" class="svelte-1ykl0dj"> <p data-svelte-h="svelte-2z7kcb">You do not need to setup all services to contribute to the Torrust Index, but in this article we will explain how to setup the full development environment, which includes all services. Sometimes you might want to contribute with a full feature that involves multiple services, so it’s useful to have the full development environment setup.</p> <p data-svelte-h="svelte-1aybo28">Setting up the development environment requires to setup the three main services.</p> <p data-svelte-h="svelte-776mhr">First, we need to create the folder (in this example, a temp folder) where we will store the repositories of our services.</p> <div class="code-block svelte-11qxx87"> <div class="lang svelte-11qxx87">terminal</div> <button class="copy-button copy-button-gray svelte-11qxx87"></button> <div class="code-content"><pre class="language-bash"><!-- HTML_TAG_START --><code class="language-bash"><span class="token builtin class-name">cd</span> /tmp/
<span class="token function">mkdir</span> <span class="token parameter variable">-p</span> torrust
<span class="token builtin class-name">cd</span> torrust</code><!-- HTML_TAG_END --></pre></div></div> <div class="callout-block info svelte-sxx0n0"><div class="icon-wrapper svelte-sxx0n0"><svg width="100%" height="100%" stroke-width="1.5" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 11.5V16.5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path d="M12 7.51L12.01 7.49889" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path d="M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path></svg></div> This guide uses bash commands and it has been tested on Ubuntu Ubuntu 23.04. You should not encounter any problem if you are using a different Linux distribution, but there are some reported issues with Windows compilation for the Tracker. The installation scripts are very simple, so you can easily adapt them to your system or run the commands manually.</div> <h2 id="common-dependencies" data-svelte-h="svelte-11zbw7j"><a class="heading-link" title="Permalink" aria-hidden="true" href="#common-dependencies"><span>#</span></a>Common Dependencies</h2> <p data-svelte-h="svelte-1xycqr4">If you are using SQLite3 as database driver for the Tracker or the Backend, you will need to install the following dependency:</p> <div class="code-block svelte-11qxx87"> <div class="lang svelte-11qxx87">terminal</div> <button class="copy-button copy-button-gray svelte-11qxx87"></button> <div class="code-content"><pre class="language-bash"><!-- HTML_TAG_START --><code class="language-bash"><span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> libsqlite3-dev</code><!-- HTML_TAG_END --></pre></div></div> <h2 id="set-up-the-torrust-tracker" data-svelte-h="svelte-hbvu"><a class="heading-link" title="Permalink" aria-hidden="true" href="#set-up-the-torrust-tracker"><span>#</span></a>Set Up the Torrust Tracker</h2> <p data-svelte-h="svelte-emwzfb">This tutorial is tested with this Rust version:</p> <ul data-svelte-h="svelte-1xkqa0c"><li>rustc 1.80.0-nightly (9cdfe285c 2024-05-22)</li></ul> <p data-svelte-h="svelte-vla8v0">Since we are using the openssl crate with the <a href="https://docs.rs/openssl/latest/openssl/#vendored" rel="nofollow">vendored</a> feature, enabled, you will need to install the following dependencies:</p> <div class="code-block svelte-11qxx87"> <div class="lang svelte-11qxx87">terminal</div> <button class="copy-button copy-button-gray svelte-11qxx87"></button> <div class="code-content"><pre class="language-bash"><!-- HTML_TAG_START --><code class="language-bash"><span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> pkg-config libssl-dev <span class="token function">make</span></code><!-- HTML_TAG_END --></pre></div></div> <p data-svelte-h="svelte-1m5k4cs">Now, we will build the tracker and create the storage folders where persistent data like databases will be stored:</p> <div class="code-block svelte-11qxx87"> <div class="lang svelte-11qxx87">terminal</div> <button class="copy-button copy-button-gray svelte-11qxx87"></button> <div class="code-content"><pre class="language-terminal"><!-- HTML_TAG_START --><code class="language-terminal">git clone https://github.com/torrust/torrust-tracker.git \
  &amp;&amp; cd torrust-tracker \
  &amp;&amp; cargo build \
  &amp;&amp; mkdir -p ./storage/tracker/lib/database \
  &amp;&amp; mkdir -p ./storage/tracker/lib/tls \
  &amp;&amp; mkdir -p ./storage/tracker/etc</code><!-- HTML_TAG_END --></pre></div></div> <p data-svelte-h="svelte-10bhhza">You can run the Tracker with the following command:</p> <div class="code-block svelte-11qxx87"> <div class="lang svelte-11qxx87">terminal</div> <button class="copy-button copy-button-gray svelte-11qxx87"></button> <div class="code-content"><pre class="language-bash"><!-- HTML_TAG_START --><code class="language-bash"><span class="token function">cargo</span> run</code><!-- HTML_TAG_END --></pre></div></div> <div class="callout-block info svelte-sxx0n0"><div class="icon-wrapper svelte-sxx0n0"><svg width="100%" height="100%" stroke-width="1.5" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 11.5V16.5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path d="M12 7.51L12.01 7.49889" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path d="M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path></svg></div> NOTICE: You do not need to change the default values for development.</div> <p data-svelte-h="svelte-pmsag2">After running the Tracker with <code>cargo run</code> you should see the following output:</p> <div class="code-block svelte-11qxx87"> <div class="lang svelte-11qxx87">output</div> <button class="copy-button copy-button-gray svelte-11qxx87"></button> <div class="code-content"><pre class="language-s"><!-- HTML_TAG_START --><code class="language-s">Finished &#96;dev&#96; profile [optimized + debuginfo] target(s) in 0.09s
     Running &#96;target/debug/torrust-tracker&#96;
Loading configuration from default configuration file: &#96;./share/default/config/tracker.development.sqlite3.toml&#96; ...
2024-05-27T11:39:21.332802857+01:00 [torrust_tracker::bootstrap::logging][INFO] logging initialized.
2024-05-27T11:39:21.333426924+01:00 [UDP TRACKER][INFO] Starting on: udp://0.0.0.0:6969
2024-05-27T11:39:21.333462384+01:00 [torrust_tracker::bootstrap::jobs][INFO] TLS not enabled
2024-05-27T11:39:21.333491694+01:00 [HTTP TRACKER][INFO] Starting on: http://0.0.0.0:7070
2024-05-27T11:39:21.333599174+01:00 [HTTP TRACKER][INFO] Started on: http://0.0.0.0:7070
2024-05-27T11:39:21.333615604+01:00 [torrust_tracker::bootstrap::jobs][INFO] TLS not enabled
2024-05-27T11:39:21.333814923+01:00 [API][INFO] Starting on http://127.0.0.1:1212
2024-05-27T11:39:21.333839143+01:00 [API][INFO] Started on http://127.0.0.1:1212
2024-05-27T11:39:21.333883712+01:00 [HEALTH CHECK API][INFO] Starting on: http://127.0.0.1:1313
2024-05-27T11:39:21.333948472+01:00 [HEALTH CHECK API][INFO] Started on: http://127.0.0.1:1313</code><!-- HTML_TAG_END --></pre></div></div> <div class="callout-block info svelte-sxx0n0"><div class="icon-wrapper svelte-sxx0n0"><svg width="100%" height="100%" stroke-width="1.5" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 11.5V16.5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path d="M12 7.51L12.01 7.49889" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path d="M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path></svg></div> IMPORTANT: Every time you change the configuration you need to restart the service.</div> <p data-svelte-h="svelte-1bukm64">By default, if you don’t specify any <code>Config.toml</code> file, the application will use this:</p> <div class="code-block svelte-11qxx87"> <div class="lang svelte-11qxx87">output</div> <button class="copy-button copy-button-gray svelte-11qxx87"></button> <div class="code-content"><pre class="language-s"><!-- HTML_TAG_START --><code class="language-s">Loading default configuration file: &#96;./share/default/config/tracker.development.sqlite3.toml&#96; ...</code><!-- HTML_TAG_END --></pre></div></div> <p data-svelte-h="svelte-biz5qm">You can’t change that file because it’s a template included in the repo. If you want to set your custom configuration, you can either:</p> <ol data-svelte-h="svelte-kbkmy"><li>Use a different path for the config file.</li> <li>Inject the configuration with an environment variable.</li></ol> <h2 id="custom-config-file" data-svelte-h="svelte-1fqdo4k"><a class="heading-link" title="Permalink" aria-hidden="true" href="#custom-config-file"><span>#</span></a>Custom config file</h2> <p data-svelte-h="svelte-vn595v">First, copy the template file to the storage folder:</p> <div class="code-block svelte-11qxx87"> <div class="lang svelte-11qxx87">terminal</div> <button class="copy-button copy-button-gray svelte-11qxx87"></button> <div class="code-content"><pre class="language-bash"><!-- HTML_TAG_START --><code class="language-bash"><span class="token function">cp</span> share/default/config/tracker.development.sqlite3.toml storage/tracker/etc/tracker.toml</code><!-- HTML_TAG_END --></pre></div></div> <p data-svelte-h="svelte-1wv0trn">Then, you can change any value and finally run the tracker with:</p> <div class="code-block svelte-11qxx87"> <div class="lang svelte-11qxx87">terminal</div> <button class="copy-button copy-button-gray svelte-11qxx87"></button> <div class="code-content"><pre class="language-bash"><!-- HTML_TAG_START --><code class="language-bash"><span class="token assign-left variable">TORRUST_TRACKER_CONFIG_TOML_PATH</span><span class="token operator">=</span><span class="token string">"./storage/tracker/etc/tracker.toml"</span> <span class="token function">cargo</span> run</code><!-- HTML_TAG_END --></pre></div></div> <p data-svelte-h="svelte-1vsfe6t">That would give you this output:</p> <div class="code-block svelte-11qxx87"> <div class="lang svelte-11qxx87">output</div> <button class="copy-button copy-button-gray svelte-11qxx87"></button> <div class="code-content"><pre class="language-s"><!-- HTML_TAG_START --><code class="language-s">TORRUST_TRACKER_CONFIG_TOML_PATH=&quot;./storage/tracker/etc/tracker.toml&quot; cargo run
    Finished &#96;dev&#96; profile [optimized + debuginfo] target(s) in 0.09s
     Running &#96;target/debug/torrust-tracker&#96;
Loading configuration from file: &#96;./storage/tracker/etc/tracker.toml&#96; ...
2024-05-27T12:52:00.364641064+01:00 [torrust_tracker::bootstrap::logging][INFO] logging initialized.
2024-05-27T12:52:00.365277963+01:00 [UDP TRACKER][INFO] Starting on: udp://0.0.0.0:6969
2024-05-27T12:52:00.365309093+01:00 [torrust_tracker::bootstrap::jobs][INFO] TLS not enabled
2024-05-27T12:52:00.365355473+01:00 [HTTP TRACKER][INFO] Starting on: http://0.0.0.0:7070
2024-05-27T12:52:00.365496743+01:00 [HTTP TRACKER][INFO] Started on: http://0.0.0.0:7070
2024-05-27T12:52:00.365504943+01:00 [torrust_tracker::bootstrap::jobs][INFO] TLS not enabled
2024-05-27T12:52:00.365596502+01:00 [API][INFO] Starting on http://127.0.0.1:1212
2024-05-27T12:52:00.365599702+01:00 [API][INFO] Started on http://127.0.0.1:1212
2024-05-27T12:52:00.365616862+01:00 [HEALTH CHECK API][INFO] Starting on: http://127.0.0.1:1313
2024-05-27T12:52:00.365711472+01:00 [HEALTH CHECK API][INFO] Started on: http://127.0.0.1:1313</code><!-- HTML_TAG_END --></pre></div></div> <h2 id="inject-the-configuration-with-an-environment-variable" data-svelte-h="svelte-r84afx"><a class="heading-link" title="Permalink" aria-hidden="true" href="#inject-the-configuration-with-an-environment-variable"><span>#</span></a>Inject the configuration with an environment variable</h2> <p data-svelte-h="svelte-f9h3g2">You can also inject the configuration with:</p> <div class="code-block svelte-11qxx87"> <div class="lang svelte-11qxx87">terminal</div> <button class="copy-button copy-button-gray svelte-11qxx87"></button> <div class="code-content"><pre class="language-bash"><!-- HTML_TAG_START --><code class="language-bash"><span class="token assign-left variable">TORRUST_TRACKER_CONFIG_TOML</span><span class="token operator">=</span><span class="token variable"><span class="token variable">&#96;</span><span class="token function">cat</span> share/default/config/tracker.development.sqlite3.toml<span class="token variable">&#96;</span></span> <span class="token function">cargo</span> run</code><!-- HTML_TAG_END --></pre></div></div> <div class="callout-block info svelte-sxx0n0"><div class="icon-wrapper svelte-sxx0n0"><svg width="100%" height="100%" stroke-width="1.5" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 11.5V16.5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path d="M12 7.51L12.01 7.49889" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path d="M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path></svg></div> NOTICE: We load the whole file into the env var. This is not useful for development, but it&#39;s a different way to inject the configuration. It&#39;s used when running the tracker with docker.</div> <p data-svelte-h="svelte-jferun">The response should be like this:</p> <div class="code-block svelte-11qxx87"> <div class="lang svelte-11qxx87">json</div> <button class="copy-button copy-button-gray svelte-11qxx87"></button> <div class="code-content"><pre class="language-json"><!-- HTML_TAG_START --><code class="language-json"><span class="token punctuation">&#123;</span>
	<span class="token property">"torrents"</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
	<span class="token property">"seeders"</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
	<span class="token property">"completed"</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
	<span class="token property">"leechers"</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
	<span class="token property">"tcp4_connections_handled"</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
	<span class="token property">"tcp4_announces_handled"</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
	<span class="token property">"tcp4_scrapes_handled"</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
	<span class="token property">"tcp6_connections_handled"</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
	<span class="token property">"tcp6_announces_handled"</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
	<span class="token property">"tcp6_scrapes_handled"</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
	<span class="token property">"udp4_connections_handled"</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
	<span class="token property">"udp4_announces_handled"</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
	<span class="token property">"udp4_scrapes_handled"</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
	<span class="token property">"udp6_connections_handled"</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
	<span class="token property">"udp6_announces_handled"</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
	<span class="token property">"udp6_scrapes_handled"</span><span class="token operator">:</span> <span class="token number">0</span>
<span class="token punctuation">&#125;</span></code><!-- HTML_TAG_END --></pre></div></div> <p data-svelte-h="svelte-1pa1388">For more details about the Torrust Tracker, check the <a href="https://docs.rs/torrust-tracker/" rel="nofollow">Tracker documentation</a>.</p> <h2 id="set-up-the-torrust-index" data-svelte-h="svelte-ezkl0q"><a class="heading-link" title="Permalink" aria-hidden="true" href="#set-up-the-torrust-index"><span>#</span></a>Set Up the Torrust Index</h2> <p data-svelte-h="svelte-wv36gp">This tutorial has been tested with this Rust version:</p> <ul data-svelte-h="svelte-1xkqa0c"><li>rustc 1.80.0-nightly (9cdfe285c 2024-05-22)</li></ul> <p data-svelte-h="svelte-koifhr">To run the tests you will also need to install a command line tool to handle torrent files called <a href="https://github.com/casey/intermodal" rel="nofollow">imdl</a>. You can install it with the following command:</p> <div class="code-block svelte-11qxx87"> <div class="lang svelte-11qxx87">terminal</div> <button class="copy-button copy-button-gray svelte-11qxx87"></button> <div class="code-content"><pre class="language-bash"><!-- HTML_TAG_START --><code class="language-bash"><span class="token function">cargo</span> <span class="token function">install</span> imdl</code><!-- HTML_TAG_END --></pre></div></div> <p data-svelte-h="svelte-1cwintg">You will also need to install a tool for database migrations if you are going to make changes to the database schema. We are using <a href="https://github.com/launchbadge/sqlx" rel="nofollow">SQLx</a>. You can install it with the following command:</p> <div class="code-block svelte-11qxx87"> <div class="lang svelte-11qxx87">terminal</div> <button class="copy-button copy-button-gray svelte-11qxx87"></button> <div class="code-content"><pre class="language-bash"><!-- HTML_TAG_START --><code class="language-bash"><span class="token function">cargo</span> <span class="token function">install</span> sqlx-cli</code><!-- HTML_TAG_END --></pre></div></div> <p data-svelte-h="svelte-qyfhk7">We will now clone the <code>torrust-index</code> repository:</p> <div class="code-block svelte-11qxx87"> <div class="lang svelte-11qxx87">terminal</div> <button class="copy-button copy-button-gray svelte-11qxx87"></button> <div class="code-content"><pre class="language-terminal"><!-- HTML_TAG_START --><code class="language-terminal">  git clone https://github.com/torrust/torrust-index.git \
  &amp;&amp; cd torrust-index \
  &amp;&amp; cargo build \
  &amp;&amp; mkdir -p ./storage/index/lib/database \
  &amp;&amp; mkdir -p ./storage/index/lib/tls</code><!-- HTML_TAG_END --></pre></div></div> <p data-svelte-h="svelte-jh7nwo">You can run the Torrust Index with the following commands:</p> <div class="code-block svelte-11qxx87"> <div class="lang svelte-11qxx87">terminal</div> <button class="copy-button copy-button-gray svelte-11qxx87"></button> <div class="code-content"><pre class="language-bash"><!-- HTML_TAG_START --><code class="language-bash"><span class="token assign-left variable">TORRUST_INDEX_API_CORS_PERMISSIVE</span><span class="token operator">=</span>true <span class="token function">cargo</span> run</code><!-- HTML_TAG_END --></pre></div></div> <p data-svelte-h="svelte-coqvj0">As you can see we are using the environment variable <code>TORRUST_IDX_BACK_CORS_PERMISSIVE</code> to enable a permissive CORS policy. The default port for the Backend is <code>3001</code> and for the web server serving the frontend application is <code>3000</code>. Since they are different ports, we need to tell the backend to allow requests from a different port so that the frontend can make request to the API. To know more about CORS, check the <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS" rel="nofollow">Mozilla CORS documentation</a>.</p> <p data-svelte-h="svelte-vvxm0">After running the Index with <code>TORRUST_INDEX_API_CORS_PERMISSIVE=true cargo run</code> you should see the following output:</p> <div class="code-block svelte-11qxx87"> <div class="lang svelte-11qxx87">output</div> <button class="copy-button copy-button-gray svelte-11qxx87"></button> <div class="code-content"><pre class="language-s"><!-- HTML_TAG_START --><code class="language-s">Loading configuration from default configuration file: &#96;./share/default/config/index.development.sqlite3.toml&#96; ...
2024-05-27T12:56:25.300980998+01:00 [torrust_index::bootstrap::logging][INFO] logging initialized.
2024-05-27T12:56:25.425949219+01:00 [torrust_index::web::api::server][INFO] TLS not enabled
2024-05-27T12:56:25.425976429+01:00 [torrust_index::console::cronjobs::tracker_statistics_importer][INFO] Tracker statistics importer launcher started
2024-05-27T12:56:25.426077258+01:00 [torrust_index::console::cronjobs::tracker_statistics_importer][INFO] Tracker statistics importer cronjob starting ...
2024-05-27T12:56:25.426233288+01:00 [torrust_index::web::api::server][INFO] Starting API server with net config: 0.0.0.0:3001 ...
2024-05-27T12:56:25.426290848+01:00 [torrust_index::console::cronjobs::tracker_statistics_importer][INFO] Tracker statistics importer API server listening on http://127.0.0.1:3002
2024-05-27T12:56:25.426250898+01:00 [torrust_index::console::cronjobs::tracker_statistics_importer][INFO] Running tracker statistics importer every 2000 milliseconds ...
2024-05-27T12:56:25.427603675+01:00 [torrust_index::web::api::server][INFO] API server listening on http://0.0.0.0:3001</code><!-- HTML_TAG_END --></pre></div></div> <p data-svelte-h="svelte-1gkdnwv">You should be able to load the API entrypoint on <a href="http://0.0.0.0:3001/" rel="nofollow">http://0.0.0.0:3001/</a></p> <img srcset="/images/posts/torrust-backend-api-entrypoint-response-screenshot.png, /images/posts/torrust-backend-api-entrypoint-response-screenshot.png, /images/posts/torrust-backend-api-entrypoint-response-screenshot.png" src="/images/posts/torrust-backend-api-entrypoint-response-screenshot.png" alt="Screenshot of Torrust Backend API entrypoint response" loading="lazy" decoding="async" class="svelte-1ykl0dj"> <p data-svelte-h="svelte-1p9zi40">For more details about the Torrust Index Backend, check the <a href="https://docs.rs/torrust-index/" rel="nofollow">Index Backend documentation</a>.</p> <h2 id="set-up-the-torrust-index-gui" data-svelte-h="svelte-g4vxgr"><a class="heading-link" title="Permalink" aria-hidden="true" href="#set-up-the-torrust-index-gui"><span>#</span></a>Set Up the Torrust Index GUI</h2> <p data-svelte-h="svelte-lnsdwq">At the time of writing, the Index GUI requires:</p> <ul data-svelte-h="svelte-1xzovqr"><li>Node: <code>^v20.12.2</code></li></ul> <p data-svelte-h="svelte-brkedy">The frontend is a <a href="https://nuxt.com/" rel="nofollow">Nuxt</a> application.</p> <p data-svelte-h="svelte-1ddgx9w">The last repository we need to clone is the <code>torrust-index-gui</code> repository . Remember to install Node.js and we need to be in the torrust folder to clone the repository.</p> <div class="code-block svelte-11qxx87"> <div class="lang svelte-11qxx87">terminal</div> <button class="copy-button copy-button-gray svelte-11qxx87"></button> <div class="code-content"><pre class="language-terminal"><!-- HTML_TAG_START --><code class="language-terminal">git clone https://github.com/torrust/torrust-index-gui.git \
  &amp;&amp; cd torrust-index-gui \
  &amp;&amp; npm install \
  &amp;&amp; cp .env.local .env \
  &amp;&amp; npm run dev</code><!-- HTML_TAG_END --></pre></div></div> <p data-svelte-h="svelte-ln4r1w">You should see the following output:</p> <img srcset="/images/posts/how-to-setup-the-development-environment/npm-run-dev-output.png, /images/posts/how-to-setup-the-development-environment/npm-run-dev-output.png, /images/posts/how-to-setup-the-development-environment/npm-run-dev-output.png" src="/images/posts/how-to-setup-the-development-environment/npm-run-dev-output.png" alt="Screenshot of Torrust Index GUI running from the terminal" loading="lazy" decoding="async" class="svelte-1ykl0dj"> <p data-svelte-h="svelte-hzic0x">Go to <a href="http://localhost:3000/torrents" rel="nofollow">http://localhost:3000/torrents</a> and you should see the torrent list page page:</p> <img srcset="/images/posts/how-to-setup-the-development-environment/index-gui-after-fresh-install.png, /images/posts/how-to-setup-the-development-environment/index-gui-after-fresh-install.png, /images/posts/how-to-setup-the-development-environment/index-gui-after-fresh-install.png" src="/images/posts/how-to-setup-the-development-environment/index-gui-after-fresh-install.png" alt="Screenshot of torrent list page on the browser" loading="lazy" decoding="async" class="svelte-1ykl0dj"> <p data-svelte-h="svelte-jvt5ml">For more details about the Torrust Index GUI, check the <a href="https://github.com/torrust/torrust-index-gui" rel="nofollow">Index GUI documentation</a>.</p> <h2 id="application-setup" data-svelte-h="svelte-1wcjsvs"><a class="heading-link" title="Permalink" aria-hidden="true" href="#application-setup"><span>#</span></a>Application Setup</h2> <p data-svelte-h="svelte-540nc4">There are some public pages like the torrent list or torrent details pages. But there are some pages that require authentication like the admin pages or the pages for uploading or editing torrents.</p> <p data-svelte-h="svelte-hho5az">To access those pages you need to create an account. You can do it from the signup page:</p> <p data-svelte-h="svelte-cpmctb"><a href="http://localhost:3000/signup" rel="nofollow">http://localhost:3000/signup</a></p> <div class="callout-block info svelte-sxx0n0"><div class="icon-wrapper svelte-sxx0n0"><svg width="100%" height="100%" stroke-width="1.5" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 11.5V16.5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path d="M12 7.51L12.01 7.49889" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path d="M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path></svg></div> The first user created will be the <code data-svelte-h="svelte-ik7s6n">admin</code> user.</div> <h2 id="development-tools" data-svelte-h="svelte-1dtp2xb"><a class="heading-link" title="Permalink" aria-hidden="true" href="#development-tools"><span>#</span></a>Development tools</h2> <p data-svelte-h="svelte-vse8x8">We found some tools very useful to develop the Torrust Tracker and Index. We hope you find them useful too.</p> <ul data-svelte-h="svelte-xyysxk"><li>DB Browser for SQLite: <a href="https://sqlitebrowser.org/" rel="nofollow">https://sqlitebrowser.org/</a></li> <li>BitTorrent client: qBittorrent <a href="https://www.qbittorrent.org/" rel="nofollow">https://www.qbittorrent.org/</a></li> <li>Torrent file editor: imdl <a href="https://github.com/casey/intermodal" rel="nofollow">https://github.com/casey/intermodal</a></li> <li>DaisyUI component library: <a href="https://daisyui.com/components/" rel="nofollow">https://daisyui.com/components/</a></li></ul> <h2 id="conclusion" data-svelte-h="svelte-br5ox0"><a class="heading-link" title="Permalink" aria-hidden="true" href="#conclusion"><span>#</span></a>Conclusion</h2> <p data-svelte-h="svelte-1czzs8f">As you can see, the Torrust Tracker and Index are very easy to set up. We hope you find this guide useful. You might have problems:</p> <ul data-svelte-h="svelte-1o01036"><li>Setting up some of the projects on Windows. <a href="https://github.com/torrust/torrust-tracker/issues/325" rel="nofollow">We are working on it</a>.</li> <li>Or with some missing system dependencies.</li></ul> <p data-svelte-h="svelte-1e9qm2v">If you have any questions or issues please open an issue on the corresponding repository:</p> <ul data-svelte-h="svelte-4xje26"><li>Torrust Tracker: <a href="https://github.com/torrust/torrust-tracker/issues" rel="nofollow">https://github.com/torrust/torrust-tracker/issues</a></li> <li>Torrust Index: <a href="https://github.com/torrust/torrust-index/issues" rel="nofollow">https://github.com/torrust/torrust-index/issues</a></li> <li>Torrust Index GUI: <a href="https://github.com/torrust/torrust-index-gui/issues" rel="nofollow">https://github.com/torrust/torrust-index-gui/issues</a></li></ul> <p data-svelte-h="svelte-v20sdj">We very welcome any contributions to the project!</p></div></div>
          ]]></content:encoded>
          <media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://v2.torrust.com//images/posts/development-environment.png"/>
          <media:content xmlns:media="http://search.yahoo.com/mrss/" medium="image" url="https://v2.torrust.com//images/posts/development-environment.png"/>          
        </item>
      
        <item>
          <guid>https://v2.torrust.com/how-to-contribute-to-this-site</guid>
          <title>How To Contribute To This Site</title>
          <description>How to manage existing blog posts and create new ones on this site.</description>
          <link>https://v2.torrust.com/how-to-contribute-to-this-site</link>
          <pubDate>22/04/2023 21:55:15</pubDate>
          <category>Documentation</category>
          <content:encoded><![CDATA[
            <div style="margin: 50px 0; font-style: italic;">
              If anything looks wrong, 
              <strong>
                <a href="https://v2.torrust.com/how-to-contribute-to-this-site">
                  read on the site!
                </a>
              </strong>
            </div>

             <div class="flex svelte-19d8qsr"> <div class=" svelte-13ebny9" style="position: relative;"><div class="svelte-13ebny9"><h2 id="table-of-contents" data-svelte-h="svelte-1m3njcc"><a class="heading-link" title="Permalink" aria-hidden="true" href="#table-of-contents"><span>#</span></a>Table of Contents</h2> <ul data-svelte-h="svelte-1v4ptj3"><li><a href="#processing">Processing</a></li> <li><a href="#creating-a-new-post">Creating a new post</a></li> <li><a href="#managing-blog-posts">Managing blog posts</a></li> <li><a href="#rss">RSS</a></li></ul></div></div> <div class="svelte-4jsat1"><p data-svelte-h="svelte-1xwgc8f">All blog posts are located inside the <code>src/routes/(blog-article)</code> folder. Each folder inside it represents a blog post, and each folder has a <code>+page.md</code> file, which is the file that contains the post’s content.</p> <p data-svelte-h="svelte-w9sf9o">This way, the URL for each blog post is generated with the folder’s name. For example, the folder <code>src/routes/(blog-article)/how-blog-posts-work</code> will generate the URL <code>https://mysite.com/how-blog-posts-work</code>.</p> <p data-svelte-h="svelte-c4i0f2">All posts are Markdown files, which means you can use the <a href="https://www.markdownguide.org/basic-syntax" rel="nofollow">Markdown syntax</a> in them, and it will work out of the box. However, since this projects uses <a href="https://mdsvex.pngwn.io/" rel="nofollow">MDsveX</a> to parse Markdown, you can also use Svelte components inside them! This means that the components used in other pages can also be used in blog posts.</p> <div class="callout-block info svelte-sxx0n0"><div class="icon-wrapper svelte-sxx0n0"><svg width="100%" height="100%" stroke-width="1.5" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 11.5V16.5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path d="M12 7.51L12.01 7.49889" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path d="M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path></svg></div> This is a Svelte component inside a Markdown file!</div> <h2 id="processing" data-svelte-h="svelte-1z0x6vg"><a class="heading-link" title="Permalink" aria-hidden="true" href="#processing"><span>#</span></a>Processing</h2> <p data-svelte-h="svelte-1kf8rlo">Besides the blog post page itself, the blog posts can be displayed in other places, such as the <code>/blog</code> page, which lists all blog posts, and the <code>&lt;RecentPosts&gt;</code> component, used in the home page.</p> <p data-svelte-h="svelte-1eocxho">To be able to do that, posts are processed in the <code>src/lib/data/blog-posts/index.ts</code> file. That file imports the blog post files and processes them, so we’re able to use some of the post’s metadata to list them. For example, we get the post’s title, cover image, and calculate the reading time based on its content, so that information is displayed in the blog post cards in the <code>/blog</code> page.</p> <p data-svelte-h="svelte-2zodqd">There is also some basic logic to get related posts based on a post’s tags. The logic should be straightforward enough to modify it to your needs.</p> <h2 id="creating-a-new-post" data-svelte-h="svelte-m25oyt"><a class="heading-link" title="Permalink" aria-hidden="true" href="#creating-a-new-post"><span>#</span></a>Creating a new post</h2> <p data-svelte-h="svelte-v0p6s8">To create a new post, create a new folder inside the <code>src/routes/(blog-article)</code> folder, and inside it, create a <code>+page.md</code> file. The folder name will be used as the post’s URL slug, so make sure it’s a valid URL slug.</p> <p data-svelte-h="svelte-1gmm44u">Inside the <code>+page.md</code> file, you must start with the front matter, which is a YAML-like syntax that is used to define metadata for the post. The front matter must be the first thing in the file, and must be separated from the rest of the content by three dashes (<code>---</code>). An example of a front matter is:</p> <div class="code-block svelte-11qxx87"> <div class="lang svelte-11qxx87">markdown</div> <button class="copy-button copy-button-gray svelte-11qxx87"></button> <div class="code-content"><pre class="language-md"><!-- HTML_TAG_START --><code class="language-md"><span class="token front-matter-block"><span class="token punctuation">---</span>
<span class="token front-matter yaml language-yaml">slug: my-new-blog-post
title: My New Blog Post
date: 2023-04-22T20:45:25.350Z
excerpt: A short description of the post
coverImage: /images/posts/cover-image.jpg
tags:
  - Example</span>
<span class="token punctuation">---</span></span></code><!-- HTML_TAG_END --></pre></div></div> <h2 id="managing-blog-posts" data-svelte-h="svelte-1dbrz46"><a class="heading-link" title="Permalink" aria-hidden="true" href="#managing-blog-posts"><span>#</span></a>Managing blog posts</h2> <p data-svelte-h="svelte-1sthwsb">I highly recommend the <a href="https://frontmatter.codes/" rel="nofollow">Front Matter VS Code extension</a> to manage blog posts. It gives you a nice CMS-like UI to manage the front matter of all blog posts, as well as a preview of their content. It is, of course, optional, and you can manage everything directly in the Markdown files if you prefer.</p> <img srcset="/images/posts/frontmatter-preview-dashboard.png, /images/posts/frontmatter-preview-dashboard.png, /images/posts/frontmatter-preview-dashboard.png" src="/images/posts/frontmatter-preview-dashboard.png" alt="Screenshot of the Front Matter VS Code extension, showing the dashboard with all posts" loading="lazy" decoding="async" class="svelte-1ykl0dj full-bleed"> <img srcset="/images/posts/frontmatter-preview-edit.png, /images/posts/frontmatter-preview-edit.png, /images/posts/frontmatter-preview-edit.png" src="/images/posts/frontmatter-preview-edit.png" alt="Screenshot of the Front Matter VS Code extension, showing the post editing UI" loading="lazy" decoding="async" class="svelte-1ykl0dj full-bleed"> <h2 id="rss" data-svelte-h="svelte-i1135l"><a class="heading-link" title="Permalink" aria-hidden="true" href="#rss"><span>#</span></a>RSS</h2> <p data-svelte-h="svelte-m96fk4">This template automatically generates a RSS feed of your blog posts. It is generated in the <code>src/routes/rss.xml/+server.ts</code> file, and it is available at the <code>/rss.xml</code> URL.</p></div></div>
          ]]></content:encoded>
          <media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://v2.torrust.com//images/posts/sample-post.jpg"/>
          <media:content xmlns:media="http://search.yahoo.com/mrss/" medium="image" url="https://v2.torrust.com//images/posts/sample-post.jpg"/>          
        </item>
      
  </channel>
</rss>